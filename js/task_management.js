/*! For license information please see task_management.js.LICENSE.txt */
(()=>{var t={331:()=>{!function(){var t,e=this;function n(t){return void 0!==t}function r(t){t=t.split(".");for(var n,r=e;n=t.shift();){if(null==r[n])return null;r=r[n]}return r}function i(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function o(t){return"array"==i(t)}function s(t){var e=i(t);return"array"==e||"object"==e&&"number"==typeof t.length}function a(t){return"string"==typeof t}function u(t){return"boolean"==typeof t}function l(t){return"number"==typeof t}function h(t){return"function"==i(t)}function c(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var f="closure_uid_"+(1e9*Math.random()>>>0),p=0;function g(t,e,n){return t.call.apply(t.bind,arguments)}function d(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function v(t,e,n){return(v=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?g:d).apply(null,arguments)}function y(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var b,m=Date.now||function(){return+new Date};function w(t,r){var i,o=t.split("."),s=e;o[0]in s||!s.execScript||s.execScript("var "+o[0]);for(;o.length&&(i=o.shift());)!o.length&&n(r)?s[i]=r:s=s[i]?s[i]:s[i]={}}function k(t,e){function n(){}n.prototype=e.prototype,t.B=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Qc=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function S(t){t.prototype.then=t.prototype.then,t.prototype.$goog_Thenable=!0}function E(t){if(!t)return!1;try{return!!t.$goog_Thenable}catch(t){return!1}}function x(t){if(Error.captureStackTrace)Error.captureStackTrace(this,x);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))}function N(t,e){for(var n=t.split("%s"),r="",i=Array.prototype.slice.call(arguments,1);i.length&&1<n.length;)r+=n.shift()+i.shift();return r+n.join("%s")}function O(t){return/^[\s\xa0]*$/.test(t)}k(x,Error),x.prototype.name="CustomError";var I=String.prototype.trim?function(t){return t.trim()}:function(t){return t.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")};function q(t){return D.test(t)?(-1!=t.indexOf("&")&&(t=t.replace(T,"&amp;")),-1!=t.indexOf("<")&&(t=t.replace(P,"&lt;")),-1!=t.indexOf(">")&&(t=t.replace(C,"&gt;")),-1!=t.indexOf('"')&&(t=t.replace(j,"&quot;")),-1!=t.indexOf("'")&&(t=t.replace(R,"&#39;")),-1!=t.indexOf("\0")&&(t=t.replace(A,"&#0;")),t):t}var T=/&/g,P=/</g,C=/>/g,j=/"/g,R=/'/g,A=/\x00/g,D=/[\x00&<>"']/;function B(t,e){for(var n=e.length,r=0;r<n;r++){var i=1==n?e:e.charAt(r);if(t.charAt(0)==i&&t.charAt(t.length-1)==i)return t.substring(1,t.length-1)}return t}var L={"\0":"\\0","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\x0B",'"':'\\"',"\\":"\\\\"},M={"'":"\\'"};function F(t){if((t=String(t)).quote)return t.quote();for(var e=['"'],n=0;n<t.length;n++){var r,i=t.charAt(n),o=i.charCodeAt(0),s=n+1;(r=L[i])||(31<o&&127>o||(i in M?i=M[i]:i in L?i=M[i]=L[i]:(o=i,31<(r=i.charCodeAt(0))&&127>r?o=i:(256>r?(o="\\x",(16>r||256<r)&&(o+="0")):(o="\\u",4096>r&&(o+="0")),o+=r.toString(16).toUpperCase()),i=M[i]=o)),r=i),e[s]=r}return e.push('"'),e.join("")}function _(t,e){return t<e?-1:t>e?1:0}function U(t,e){e.unshift(t),x.call(this,N.apply(null,e)),e.shift()}function K(t,e){throw new U("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1))}k(U,x),U.prototype.name="AssertionError";var $,W=Array.prototype,H=W.indexOf?function(t,e,n){return W.indexOf.call(t,e,n)}:function(t,e,n){if(n=null==n?0:0>n?Math.max(0,t.length+n):n,a(t))return a(e)&&1==e.length?t.indexOf(e,n):-1;for(;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},V=W.forEach?function(t,e,n){W.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i=a(t)?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)},G=W.map?function(t,e,n){return W.map.call(t,e,n)}:function(t,e,n){for(var r=t.length,i=Array(r),o=a(t)?t.split(""):t,s=0;s<r;s++)s in o&&(i[s]=e.call(n,o[s],s,t));return i},J=W.some?function(t,e,n){return W.some.call(t,e,n)}:function(t,e,n){for(var r=t.length,i=a(t)?t.split(""):t,o=0;o<r;o++)if(o in i&&e.call(n,i[o],o,t))return!0;return!1};function Y(t,e){var n=z(t,e,void 0);return 0>n?null:a(t)?t.charAt(n):t[n]}function z(t,e,n){for(var r=t.length,i=a(t)?t.split(""):t,o=0;o<r;o++)if(o in i&&e.call(n,i[o],o,t))return o;return-1}function X(t){if(!o(t))for(var e=t.length-1;0<=e;e--)delete t[e];t.length=0}function Q(t,e){var n,r=H(t,e);return(n=0<=r)&&W.splice.call(t,r,1),n}function Z(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function tt(t,e){if(!s(t)||!s(e)||t.length!=e.length)return!1;for(var n=t.length,r=et,i=0;i<n;i++)if(!r(t[i],e[i]))return!1;return!0}function et(t,e){return t===e}t:{var nt=e.navigator;if(nt){var rt=nt.userAgent;if(rt){$=rt;break t}}$=""}function it(t){return-1!=$.indexOf(t)}function ot(t,e){for(var r=(i=s(e))?e:arguments,i=i?0:1;i<r.length&&n(t=t[r[i]]);i++);return t}var st,at,ut="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function lt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<ut.length;o++)n=ut[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function ht(t){e.setTimeout((function(){throw t}),0)}function ct(t,r){at||function(){if(e.Promise&&e.Promise.resolve){var t=e.Promise.resolve();at=function(){t.then(gt)}}else at=function(){var t=gt;!h(e.setImmediate)||e.Window&&e.Window.prototype.setImmediate==e.setImmediate?(st||(st=function(){var t=e.MessageChannel;if(void 0===t&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&(t=function(){(r=document.createElement("iframe")).style.display="none",r.src="",document.documentElement.appendChild(r);var t=r.contentWindow;(r=t.document).open(),r.write(""),r.close();var e="callImmediate"+Math.random(),n="file:"==t.location.protocol?"*":t.location.protocol+"//"+t.location.host,r=v((function(t){"*"!=n&&t.origin!=n||t.data!=e||this.port1.onmessage()}),this);t.addEventListener("message",r,!1),this.port1={},this.port2={postMessage:function(){t.postMessage(e,n)}}}),void 0!==t&&!it("Trident")&&!it("MSIE")){var r=new t,i={},o=i;return r.port1.onmessage=function(){if(n(i.next)){var t=(i=i.next).Ub;i.Ub=null,t()}},function(t){o.next={Ub:t},o=o.next,r.port2.postMessage(0)}}return"undefined"!=typeof document&&"onreadystatechange"in document.createElement("script")?function(t){var e=document.createElement("script");e.onreadystatechange=function(){e.onreadystatechange=null,e.parentNode.removeChild(e),e=null,t(),t=null},document.documentElement.appendChild(e)}:function(t){e.setTimeout(t,0)}}()),st(t)):e.setImmediate(t)}}(),ft||(at(),ft=!0),pt.push(new dt(t,r))}var ft=!1,pt=[];function gt(){for(;pt.length;){var t=pt;pt=[];for(var e=0;e<t.length;e++){var n=t[e];try{n.a.call(n.b)}catch(t){ht(t)}}}ft=!1}function dt(t,e){this.a=t,this.b=e}function vt(t,e){this.b=yt,this.h=void 0,this.a=this.c=null,this.f=this.g=!1;try{var n=this;t.call(e,(function(t){wt(n,bt,t)}),(function(t){if(!(t instanceof xt))try{if(t instanceof Error)throw t;throw Error("Promise rejected.")}catch(t){}wt(n,mt,t)}))}catch(t){wt(this,mt,t)}}[].push((function(){ft=!1,pt=[]}));var yt=0,bt=2,mt=3;function wt(t,e,n){if(t.b==yt){if(t==n)e=mt,n=new TypeError("Promise cannot resolve to itself");else{if(E(n))return t.b=1,void n.then(t.i,t.j,t);if(c(n))try{var r=n.then;if(h(r))return void function(t,e,n){function r(e){i||(i=!0,t.j(e))}t.b=1;var i=!1;try{n.call(e,(function(e){i||(i=!0,t.i(e))}),r)}catch(t){r(t)}}(t,n,r)}catch(t){e=mt,n=t}}t.h=n,t.b=e,kt(t),e!=mt||n instanceof xt||function(t,e){t.f=!0,ct((function(){t.f&&Et.call(null,e)}))}(t,n)}}function kt(t){t.g||(t.g=!0,ct(t.m,t))}function St(t,e,n,r){if(n==bt)e.cc(r);else{if(e.Ea)for(;t&&t.f;t=t.c)t.f=!1;e.dc(r)}}vt.prototype.then=function(t,e,r){return function(t,e,r,i){var o={Ea:null,cc:null,dc:null};return o.Ea=new vt((function(t,s){o.cc=e?function(n){try{var r=e.call(i,n);t(r)}catch(t){s(t)}}:t,o.dc=r?function(e){try{var o=r.call(i,e);!n(o)&&e instanceof xt?s(e):t(o)}catch(t){s(t)}}:s})),o.Ea.c=t,function(t,e){t.a&&t.a.length||t.b!=bt&&t.b!=mt||kt(t),t.a||(t.a=[]),t.a.push(e)}(t,o),o.Ea}(this,h(t)?t:null,h(e)?e:null,r)},S(vt),vt.prototype.i=function(t){this.b=yt,wt(this,bt,t)},vt.prototype.j=function(t){this.b=yt,wt(this,mt,t)},vt.prototype.m=function(){for(;this.a&&this.a.length;){var t=this.a;this.a=[];for(var e=0;e<t.length;e++)St(this,t[e],this.b,this.h)}this.g=!1};var Et=ht;function xt(t){x.call(this,t)}function Nt(t,e){this.j=[],this.Y=e||null,this.b=this.c=!1,this.g=void 0,this.ja=this.K=this.m=!1,this.i=0,this.f=null,this.G=0}function Ot(t,e,n){t.c=!0,t.g=n,t.b=!e,t.yb()}function It(t){if(t.c){if(!t.ja)throw new Ct;t.ja=!1}}function qt(t,e,n,r){return t.j.push([e,n,r]),t.c&&t.yb(),t}function Tt(t){return J(t.j,(function(t){return h(t[1])}))}function Pt(t){var e=new Nt;return e.callback(t),e}function Ct(){x.call(this)}function jt(t){this.gb=e.setTimeout(v(this.b,this),0),this.a=t}k(xt,x),xt.prototype.name="cancel",(t=Nt.prototype).Xa=function(t,e){this.m=!1,Ot(this,t,e)},t.callback=function(t){It(this),Ot(this,!0,t)},t.o=function(t){It(this),Ot(this,!1,t)},t.H=function(t,e){return qt(this,t,null,e)},t.Sb=function(t,e){return qt(this,null,t,e)},t.Rb=function(t,e){return qt(this,t,t,e)},t.then=function(t,e,n){var r,i,o=new vt((function(t,e){r=t,i=e}));return qt(this,r,(function(t){i(t)})),o.then(t,e,n)},S(Nt),Nt.prototype.ub=function(t){return qt(this,t.callback,t.o,t),this},Nt.prototype.ia=function(t){var e=new Nt;return this.ub(e),t&&(e.f=this,this.G++),e},Nt.prototype.yb=function(){this.i&&this.c&&Tt(this)&&(At(this.i),this.i=0),this.f&&(this.f.G--,delete this.f);for(var t=this.g,e=!1,r=!1;this.j.length&&!this.m;){var i=(s=this.j.shift())[0],o=s[1],s=s[2];if(i=this.b?o:i)try{var a=i.call(s||this.Y,t);n(a)&&(this.b=this.b&&(a==t||a instanceof Error),this.g=t=a),E(t)&&(this.m=r=!0)}catch(n){t=n,this.b=!0,Tt(this)||(e=!0)}}this.g=t,r&&(r=v(this.Xa,this,!0),a=v(this.Xa,this,!1),t instanceof Nt?(qt(t,r,a),t.K=!0):t.then(r,a)),e&&(t=new jt(t),Rt[t.gb]=t,this.i=t.gb)},k(Ct,x),Ct.prototype.message="Deferred has already fired",Ct.prototype.name="AlreadyCalledError",jt.prototype.b=function(){throw delete Rt[this.gb],window.console.error(this.a.stack),this.a};var Rt={};function At(t){var n=Rt[t];n&&(e.clearTimeout(n.gb),delete Rt[t])}var Dt=function t(e){var n=arguments.length;if(1==n&&o(arguments[0]))return t.apply(null,arguments[0]);for(var r={},i=0;i<n;i++)r[arguments[i]]=!0;return r}("area base br col command embed hr img input keygen link meta param source track wbr".split(" "));function Bt(){this.a="",this.b=Mt}function Lt(t){return t instanceof Bt&&t.constructor===Bt&&t.b===Mt?t.a:(K("expected object of type Const, got '"+t+"'"),"type_error:Const")}Bt.prototype.oa=!0,Bt.prototype.ha=function(){return this.a},Bt.prototype.toString=function(){return"Const{"+this.a+"}"};var Mt={};function Ft(t){var e=new Bt;return e.a=t,e}function _t(){this.a="",this.b=Ut}_t.prototype.oa=!0;var Ut={};function Kt(t){var e=new _t;return e.a=t,e}_t.prototype.ha=function(){return this.a},_t.prototype.toString=function(){return"SafeStyle{"+this.a+"}"};var $t=Kt(""),Wt=/^[-.%_!# a-zA-Z0-9]+$/;function Ht(){this.a="",this.b=zt}function Vt(t){return t instanceof Ht&&t.constructor===Ht&&t.b===zt?t.a:(K("expected object of type SafeUrl, got '"+t+"'"),"type_error:SafeUrl")}(t=Ht.prototype).oa=!0,t.ha=function(){return this.a},t.Db=!0,t.ua=function(){return 1},t.toString=function(){return"SafeUrl{"+this.a+"}"};var Gt=/^(?:(?:https?|mailto):|[^&:/?#]*(?:[/?#]|$))/i,Jt=/[()']|%5B|%5D|%25/g,Yt={"'":"%27","(":"%28",")":"%29","%5B":"[","%5D":"]","%25":"%"},zt={};function Xt(t){var e=new Ht;return e.a=t,e}function Qt(){this.a=Zt}(t=Qt.prototype).oa=!0,t.ha=function(){return""},t.Db=!0,t.ua=function(){return 1},t.toString=function(){return"TrustedResourceUrl{}"};var Zt={};function te(){this.a="",this.c=le,this.b=null}function ee(t){return t instanceof te&&t.constructor===te&&t.c===le?t.a:(K("expected object of type SafeHtml, got '"+t+"'"),"type_error:SafeHtml")}function ne(t){if(t instanceof te)return t;var e=null;return t.Db&&(e=t.ua()),he(q(t.oa?t.ha():String(t)),e)}function re(t){return t instanceof te?t:he(ee(t=ne(t)).replace(/  /g," &#160;").replace(/(\r\n|\r|\n)/g,"<br>"),t.ua())}(t=te.prototype).Db=!0,t.ua=function(){return this.b},t.oa=!0,t.ha=function(){return this.a},t.toString=function(){return"SafeHtml{"+this.a+"}"};var ie=/^[a-zA-Z0-9-]+$/,oe={action:!0,cite:!0,data:!0,formaction:!0,href:!0,manifest:!0,poster:!0,src:!0},se={embed:!0,iframe:!0,link:!0,object:!0,script:!0,style:!0,template:!0};function ae(t,e,r){if(!ie.test(t))throw Error("Invalid tag name <"+t+">.");if(t.toLowerCase()in se)throw Error("Tag name <"+t+"> is not allowed for SafeHtml.");var i=null,s="<"+t;if(e)for(var a in e){if(!ie.test(a))throw Error('Invalid attribute name "'+a+'".');var u=e[a];if(null!=u){var l,h=t;if(l=a,u instanceof Bt)u=Lt(u);else if("style"==l.toLowerCase()){if(!c(u))throw Error('The "style" attribute requires goog.html.SafeStyle or map of style properties, '+typeof u+" given: "+u);if(!(u instanceof _t)){h="";var f=void 0;for(f in u){if(!/^[-_a-zA-Z0-9]+$/.test(f))throw Error("Name allows only [-_a-zA-Z0-9], got: "+f);var p=u[f];null!=p&&(p instanceof Bt?p=Lt(p):Wt.test(p)||(K("String value allows only [-.%_!# a-zA-Z0-9], got: "+p),p="zClosurez"),h+=f+":"+p+";")}u=h?Kt(h):$t}h=void 0,u instanceof _t&&u.constructor===_t&&u.b===Ut?h=u.a:(K("expected object of type SafeStyle, got '"+u+"'"),h="type_error:SafeStyle"),u=h}else{if(/^on/i.test(l))throw Error('Attribute "'+l+'" requires goog.string.Const value, "'+u+'" given.');if(l.toLowerCase()in oe)if(u instanceof Qt)u instanceof Qt&&u.constructor===Qt&&u.a===Zt?u="":(K("expected object of type TrustedResourceUrl, got '"+u+"'"),u="type_error:TrustedResourceUrl");else{if(!(u instanceof Ht))throw Error('Attribute "'+l+'" on tag "'+h+'" requires goog.html.SafeUrl or goog.string.Const value, "'+u+'" given.');u=Vt(u)}}u.oa&&(u=u.ha()),s=s+" "+(l=l+'="'+q(String(u))+'"')}}return n(r)?o(r)||(r=[r]):r=[],!0===Dt[t.toLowerCase()]?s+=">":(s+=">"+ee(i=ue(r))+"</"+t+">",i=i.ua()),(t=e&&e.dir)&&(i=/^(ltr|rtl|auto)$/i.test(t)?0:null),he(s,i)}function ue(t){var e=0,n="";return V(arguments,(function t(r){o(r)?V(r,t):(r=ne(r),n+=ee(r),r=r.ua(),0==e?e=r:0!=r&&e!=r&&(e=null))})),he(n,e)}var le={};function he(t,e){var n=new te;return n.a=t,n.b=e,n}var ce=he("",0),fe="StopIteration"in e?e.StopIteration:Error("StopIteration");function pe(){}function ge(t,e){if(this.b={},this.a=[],this.f=this.c=0,1<(i=arguments.length)){if(i%2)throw Error("Uneven number of arguments");for(var n=0;n<i;n+=2)this.set(arguments[n],arguments[n+1])}else if(t){var r;if(t instanceof ge)r=t.na(),n=t.cb();else{var i=[],o=0;for(r in t)i[o++]=r;for(n in r=i,i=[],o=0,t)i[o++]=t[n];n=i}for(i=0;i<r.length;i++)this.set(r[i],n[i])}}function de(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Object.prototype.hasOwnProperty.call(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)r=t.a[e],Object.prototype.hasOwnProperty.call(i,r)||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}pe.prototype.next=function(){throw fe},pe.prototype.tb=function(){return this},(t=ge.prototype).zb=function(){return this.c},t.cb=function(){de(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},t.na=function(){return de(this),this.a.concat()},t.clear=function(){this.b={},this.f=this.c=this.a.length=0},t.get=function(t,e){return Object.prototype.hasOwnProperty.call(this.b,t)?this.b[t]:e},t.set=function(t,e){Object.prototype.hasOwnProperty.call(this.b,t)||(this.c++,this.a.push(t),this.f++),this.b[t]=e},t.forEach=function(t,e){for(var n=this.na(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}},t.clone=function(){return new ge(this)},t.tb=function(t){de(this);var e=0,n=this.a,r=this.b,i=this.f,o=this,s=new pe;return s.next=function(){for(;;){if(i!=o.f)throw Error("The map has changed since the iterator was created");if(e>=n.length)throw fe;var s=n[e++];return t?s:r[s]}},s};var ve=it("Opera")||it("OPR"),ye=it("Trident")||it("MSIE"),be=it("Gecko")&&-1==$.toLowerCase().indexOf("webkit")&&!(it("Trident")||it("MSIE")),me=-1!=$.toLowerCase().indexOf("webkit");me&&it("Mobile"),it("Macintosh"),it("Windows"),it("Linux")||it("CrOS");var we=e.navigator||null;function ke(){var t=e.document;return t?t.documentMode:void 0}we&&(we.appVersion||"").indexOf("X11"),it("Android"),!it("iPhone")||it("iPod")||it("iPad"),it("iPad");var Se,Ee,xe=(Ee="",ve&&e.opera?h(Ee=e.opera.version)?Ee():Ee:(be?Se=/rv\:([^\);]+)(\)|;)/:ye?Se=/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/:me&&(Se=/WebKit\/(\S+)/),Se&&(Ee=(Ee=Se.exec($))?Ee[1]:""),ye&&(Se=ke())>parseFloat(Ee)?String(Se):Ee)),Ne={};function Oe(t){var e;if(!(e=Ne[t])){e=0;for(var n=I(String(xe)).split("."),r=I(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",a=r[o]||"",u=RegExp("(\\d*)(\\D*)","g"),l=RegExp("(\\d*)(\\D*)","g");do{var h=u.exec(s)||["","",""],c=l.exec(a)||["","",""];if(0==h[0].length&&0==c[0].length)break;e=_(0==h[1].length?0:parseInt(h[1],10),0==c[1].length?0:parseInt(c[1],10))||_(0==h[2].length,0==c[2].length)||_(h[2],c[2])}while(0==e)}e=Ne[t]=0<=e}return e}var Ie=e.document,qe=Ie&&ye?ke()||("CSS1Compat"==Ie.compatMode?parseInt(xe,10):5):void 0;function Te(t){var e;return e||(e=Pe(t||arguments.callee.caller,[])),e}function Pe(t,e){var n=[];if(0<=H(e,t))n.push("[...circular reference...]");else if(t&&50>e.length){n.push(Ce(t)+"(");for(var r=t.arguments,i=0;r&&i<r.length;i++){var o;switch(0<i&&n.push(", "),typeof(o=r[i])){case"object":o=o?"object":"null";break;case"string":break;case"number":o=String(o);break;case"boolean":o=o?"true":"false";break;case"function":o=(o=Ce(o))?o:"[fn]";break;default:o=typeof o}40<o.length&&(o=o.substr(0,40)+"..."),n.push(o)}e.push(t),n.push(")\n");try{n.push(Pe(t.caller,e))}catch(t){n.push("[exception trying to get caller]\n")}}else t?n.push("[...long stack...]"):n.push("[end]");return n.join("")}function Ce(t){if(je[t])return je[t];if(t=String(t),!je[t]){var e=/function ([^\(]+)/.exec(t);je[t]=e?e[1]:"[Anonymous]"}return je[t]}var je={};function Re(t,e,n,r,i){this.g=r||m(),this.f=t,this.c=e,this.b=n,delete this.a}function Ae(t){this.g=t,this.a=this.f=this.b=this.c=null}function De(t,e){this.name=t,this.value=e}Re.prototype.a=null,De.prototype.toString=function(){return this.name};var Be=new De("SHOUT",1200),Le=new De("SEVERE",1e3),Me=new De("WARNING",900),Fe=new De("INFO",800),_e=new De("CONFIG",700),Ue=new De("FINE",500),Ke=new De("FINER",400),$e=new De("FINEST",300),We=[new De("OFF",1/0),Be,Le,Me,Fe,_e,Ue,Ke,$e,new De("ALL",0)],He=null;function Ve(t){return t.b?t.b:t.c?Ve(t.c):(K("Root logger has no level set."),null)}Ae.prototype.getName=function(){return this.g},Ae.prototype.log=function(t,n,r){if(t.value>=Ve(this).value)for(h(n)&&(n=n()),t=new Re(t,String(n),this.g),r&&(t.a=r),r="log:"+t.c,e.console&&(e.console.timeStamp?e.console.timeStamp(r):e.console.markTimeline&&e.console.markTimeline(r)),e.msWriteProfilerMark&&e.msWriteProfilerMark(r),r=this;r;){var i=t;if((n=r).a)for(var o=0,s=void 0;s=n.a[o];o++)s(i);r=r.c}};var Ge={},Je=null;function Ye(){Je||(Je=new Ae(""),Ge[""]=Je,Je.b=_e)}function ze(){return Ye(),Je}function Xe(t){var e;if(Ye(),!(e=Ge[t])){e=new Ae(t);var n=t.lastIndexOf("."),r=t.substr(n+1);(n=Xe(t.substr(0,n))).f||(n.f={}),n.f[r]=e,e.c=n,Ge[t]=e}return e}function Qe(t,e,n){t&&t.log(e,n,void 0)}function Ze(t,e){t&&t.log(Le,e,void 0)}function tn(t,e){t&&t.log(Me,e,void 0)}function en(t,e){t&&t.log(Ue,e,void 0)}function nn(t,e){t&&t.log($e,e,void 0)}function rn(t,e){t&&t.log(Ke,e,void 0)}function on(t){x.call(this,t),this.name="ydn.error.ArgumentException"}function sn(t){x.call(this,t),this.name="ydn.error.TypeError"}function an(t){x.call(this,t),this.name="ydn.error.NotSupportedException"}function un(t){x.call(this,t),this.name="ydn.error.NotImplementedException"}function ln(t){x.call(this,t),this.name="ydn.error.InvalidOperationException"}function hn(t){Error.captureStackTrace?Error.captureStackTrace(this,hn):this.stack=Error().stack||"",t&&(this.message=String(t)),this.name="ydn.error.InternalError"}function cn(t,e){Nt.call(this,0,e),this.h=[]}function fn(t,e){for(var n=0;n<t.h.length;n++)t.h[n][0].call(t.h[n][1],e)}function pn(t,e,n,r){t>e&&(e=t=void 0),null===t&&(t=void 0),null===e&&(e=void 0),this.lower=t,this.upper=e,this.lowerOpen=!!n,this.upperOpen=!!r}function gn(t){return kn(t)}function dn(t){return new pn(t,t,!1,!1)}function vn(t,e,n,r){return new pn(t,e,n,r)}function yn(t,e){return new pn(void 0,t,void 0,!!e)}function bn(t,e){return new pn(t,void 0,!!e,void 0)}function mn(t){var e;if(o(t))(e=Z(t)).push("￿");else if(a(t))e=t+"￿";else{if(!l(t))return dn(t);e=t+2220460492503131e-31,t-=2220460492503131e-31}return vn(t,e,!1,!0)}function wn(t){return{lower:(t=t||{}).lower,upper:t.upper,lowerOpen:t.lowerOpen,upperOpen:t.upperOpen}}function kn(t){return null!=t?null!=t.upper&&null!=t.lower?On.bound(t.lower,t.upper,!!t.lowerOpen,!!t.upperOpen):null!=t.upper?On.upperBound(t.upper,t.upperOpen):null!=t.lower?On.lowerBound(t.lower,t.lowerOpen):null:null}function Sn(t){if(t instanceof pn)return"";if(null!=t){if(c(t)){for(var e in t){var n;if((n=t.hasOwnProperty(e))&&(n=!(0<=H(["lower","upper","lowerOpen","upperOpen"],e))),n)return'invalid attribute "'+e+'" in key range object'}return""}return"key range must be an object"}return""}function En(t){if(!t)return"";var e=t.lowerOpen?"(":"[";return null!=t.lower&&(e+=t.lower+", "),null!=t.upper&&(e+=t.upper),e+(t.upperOpen?")":"]")}function xn(t,e,n,r,i){if(n)if(n.lowerOpen||n.upperOpen||null==n.lower||null==n.upper||0!==cr(n.lower,n.upper)){if(null!=n.lower){var o=n.lowerOpen?" > ":" >= ";r.push(t+o+"?"),i.push(li(n.lower,e))}null!=n.upper&&(o=n.upperOpen?" < ":" <= ",r.push(t+o+"?"),i.push(li(n.upper,e)))}else r.push(t+" = ?"),i.push(li(n.lower,e))}function Nn(t,e,r,i){var o,s,a,u;if("starts"==t||"^"==t)return mn(e);if("<"==t||"<="==t)o=e,a="<"==t;else if(">"==t||">="==t)s=e,u=">"==t;else{if("="!=t&&"=="!=t)throw new on("invalid op: "+t);o=s=e}if("<"==r||"<="==r)o=i,a="<"==r;else if(">"==r||">="==r)s=i,u=">"==r;else if(n(r))throw new on("invalid op2: "+r);return vn(s,o,u,a)}k(on,x),k(sn,x),k(an,x),k(un,x),k(ln,x),k(hn,Error),hn.prototype.name="ydn.error.InternalError",k(cn,Nt),(t=cn.prototype).Tb=function(t,e){return this.h.push([t,e]),this},t.callback=function(t){this.h.length=0,cn.B.callback.call(this,t)},t.o=function(t){this.h.length=0,cn.B.o.call(this,t)},t.ub=function(t){return cn.B.ub.call(this,t),t instanceof cn&&t.Tb((function(t){fn(this,t)}),this),this},t.zc=function(){return this},Nt.prototype.done=Nt.prototype.H,Nt.prototype.fail=Nt.prototype.Sb,Nt.prototype.always=Nt.prototype.Rb,cn.prototype.then=cn.prototype.then,pn.prototype.lower=void 0,pn.prototype.upper=void 0,pn.prototype.toJSON=function(){return wn(this)},pn.prototype.ka=function(t){var e=this.lower,n=this.upper,r=this.lowerOpen,i=this.upperOpen;return null!=t.lower&&(null==this.lower||t.lower>=this.lower)&&(e=t.lower,r=t.lowerOpen||this.lowerOpen),null!=t.upper&&(null==this.upper||t.upper<=this.upper)&&(n=t.upper,i=t.upperOpen||this.upperOpen),vn(e,n,r,i)};var On=e.IDBKeyRange||e.webkitIDBKeyRange||pn;function In(t,e){var r,i;for(2==arguments.length&&a(arguments[1])?(r=!0,i=arguments[1].split(".")):i=(r=s(e))?e:arguments,r=r?0:1;r<i.length&&n(t=t[i[r]]);r++);return t}function qn(t,e,n){if(t)if(-1==e.indexOf("."))t[e]=n;else{for(var r,i=(e=e.split(".")).pop();r=e.shift();)c(t[r])||(t[r]={}),t=t[r];t[i]=n}}var Tn={};function Pn(t){var e=[t];t=new Ln;for(var n,r,i=0;void 0!==(r=e.pop());){if(0==i%4&&12<i+4&&(t.write(i),i=0),n=typeof r,r instanceof Array){if(i+=4,0<r.length){for(e.push(Tn),n=r.length;n--;)e.push(r[n]);continue}t.write(i)}else if("number"===n)i+=1,t.write(i),jn(t,r);else if(r instanceof Date)i+=2,t.write(i),jn(t,r.valueOf());else if("string"===n){for(i+=3,t.write(i),i=t,n=0;n<r.length;n++){var o=r.charCodeAt(n);126>=o?i.write(o+1):16510>=o?(o-=127,i.write(128|o>>8,255&o)):i.write(192|o>>10,o>>2|255,(3|o)<<6)}i.write(0)}else{if(r!==Tn)return"";t.write(0)}i=0}for(e=t.a.length;"00"===t.a[--e];);return t.a.length=++e,t.toString()}function Cn(t){for(var e,n,r=[],i=r,o=[],s=new Dn(t);null!=Bn(s);)if(0===s.a)i=o.pop();else{if(null===s.a)break;for(;;){e=s.a/4|0,t=s.a%4;for(var a=0;a<e;a++)n=[],i.push(n),o.push(i),i=n;if(!(0===t&&12<s.a+4))break;Bn(s)}1===t?i.push(Rn(s)):2===t?i.push(new Date(Rn(s))):3===t?i.push(An(s)):0===t&&(i=o.pop())}return r[0]}function jn(t,e){var n,r,i,o=i=r=0;if(0!==(n=e))if(isFinite(n)){if(0>n&&(r=1,n=-n),o=0,22250738585072014e-324<=n){for(i=n;1>i;)o--,i*=2;for(;2<=i;)o++,i/=2;i=o+1023}o=i?Math.floor(4503599627370496*(n/Math.pow(2,o)-1)):Math.floor(n/5e-324)}else i=2047,isNaN(n)?o=0x8000000000000:-1/0===n&&(r=1);n=r,r=i,i=o,n&&(i=0xfffffffffffff-i,r=2047-r),t.write((n?0:128)|r>>4),t.write((15&r)<<4|0|i/281474976710656),n=0|(i%=281474976710656)/4294967296,t.write(n>>8,255&n),n=0|(i%=4294967296)/65536,t.write(n>>8,255&n),n=i%65536,t.write(n>>8,255&n)}function Rn(t){var e=!((i=0|Bn(t))>>7),n=e?-1:1,r=(r=(127&i)<<4)+((i=0|Bn(t))>>4);e&&(r=2047-r);for(var i=[e?15-(15&i):15&i],o=6;o--;)i.push(e?255-(0|Bn(t)):0|Bn(t));for(t=0,o=7;o--;)t=t/256+i[o];return 0==(t/=16)&&0===r?0:(t+1)*Math.pow(2,r-1023)*n}function An(t){for(var e,n,r=[],i=0,o=0,s=0;0!==(e=Bn(t))&&null!=e;)0===i?2>(n=e>>6)&&!isNaN(e)?r.push(String.fromCharCode(e-1)):(i=n,o=e<<10,s++):2===i?(r.push(String.fromCharCode(o+e+127)),i=o=s=0):2===s?(o+=e<<2,s++):(r.push(String.fromCharCode(o|e>>6)),i=o=s=0);return r.join("")}function Dn(t){this.a=null,this.b=t,this.c=this.b.length-1,this.index=-1}function Bn(t){return t.a=t.index<t.c?parseInt(t.b.charAt(++t.index)+t.b.charAt(++t.index),16):null}function Ln(){this.a=[],this.b=void 0}function Mn(t,e,r,i,o){if(!(e instanceof pn))if(a(e)&&n(r))e=Nn(e,r,i,o);else if(null!=e){if(!(e instanceof pn)){if(!c(e))throw new on("Invalid key range: "+e+" of type "+typeof e);e=new pn(e.lower,e.upper,e.lowerOpen,e.upperOpen)}}else e=null;this.a=e,this.ma=t}Ln.prototype.write=function(t){for(var e=0;e<arguments.length;e++)this.b=arguments[e].toString(16),this.a.push(2===this.b.length?this.b:this.b="0"+this.b)},Ln.prototype.toString=function(){return this.a.length?this.a.join(""):""},Mn.prototype.ma="",Mn.prototype.ka=function(t){return this.ma!=t.ma?null:(t=null!=this.a&&null!=t.a?this.a.ka(t.a):this.a||t.a,new Mn(this.ma,t))};var Fn="readonly",_n="readwrite",Un="versionchange",Kn=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.moz_indexedDB||e.msIndexedDB;function $n(){0!=Wn&&(Hn[this[f]||(this[f]=++p)]=this),this.ia=this.ia,this.ja=this.ja}var Wn=0,Hn={};function Vn(t,e,n,r){$n.call(this),this.b=n,this.s=n.getName(),this.O=void 0,this.g=!1,this.w=null,this.f=t,this.Qb=e,this.ta=0,this.N=this.C=!1,this.u=r||4,this.j=this.c=this.a=void 0,this.G=function(){throw new hn},this.Y=function(){throw new hn},this.Pb=function(){}}function Gn(t,e){t.Y(e),Jn(t),t.C=!0}function Jn(t){null!=t.c?t.c=Tr(t.c):t.c=void 0,null!=t.a?t.a=Tr(t.a):t.a=void 0,t.Pb(t.N,t.a,t.c)}function Yn(t){t.N=!0,nn(t.logger,t+": exit"),Jn(t)}function zn(t,e,n){nn(t.logger,t+" restarting"),t.C=!1,t.N=!1,t.openCursor(n,e)}function Xn(t,e,r,i,o,s,l){if(!a(t))throw new TypeError("store name must be a string, but "+t+" found.");if(this.b=t,this.c=e,this.h=l,this.u=!!this.c,n(i)&&!u(i))throw new on("reverse value must be a boolean, but "+typeof i+" found");if(n(o)&&!u(o))throw new on("unique value must be a boolean, but "+typeof o+" found");if(n(s)&&!u(s))throw new on("key_only value must be a boolean, but "+typeof s+" found");if(this.f=n(s)?s:!!a(this.c),t="next",i&&o?t="prevunique":i?t="prev":o&&(t="nextunique"),this.m=t,i=Sn(r))throw new on("Invalid key range: "+i);this.a=kn(r),this.g=nr,this.C=NaN}function Qn(t,e,n){if(3<arguments.length)throw new on("too many argument");Xn.call(this,t,void 0,e,n,void 0,!0)}function Zn(t,e,n,r,i){if(!a(e))throw new on("index name must be string");Xn.call(this,t,e,n,r,i,!0)}function tr(t,e,n){if(3<arguments.length)throw new on("too many argument");Xn.call(this,t,void 0,e,n,void 0,!1)}function er(t,e,n,r,i){if(!a(e))throw new on("index name must be string");Xn.call(this,t,e,n,r,i,!1)}$n.prototype.ia=!1,$n.prototype.Wb=function(){if(!this.ia&&(this.ia=!0,this.fa(),0!=Wn)){var t=this[f]||(this[f]=++p);delete Hn[t]}},$n.prototype.fa=function(){if(this.ja)for(;this.ja.length;)this.ja.shift()()},k(Vn,$n),(t=Vn.prototype).Ob=function(t,e,r,i,s){if(n(e)){t=this.b;var u,l=e;if(o(e)?(u=ki(t,e),l=e.join(", ")):u=wi(t,e),!u)throw new on('require index "'+l+'" not found in store "'+t.getName()+'"');this.O=u.getName()}this.g=a(this.O),this.w=r||null,this.ta=0,this.N=this.C=!1,this.reverse="prev"==i||"prevunique"==i,this.unique="nextunique"==i||"prevunique"==i,this.Z=i,this.Ia=s,this.j=this.c=this.a=void 0},t.Z="",t.w=null,t.unique=!1,t.reverse=!1,t.Ia=!0,t.logger=Xe("ydn.db.core.req.AbstractCursor"),t.W=function(t,e,n){null==t&&(rn(this.logger,this+" finished."),this.C=!0),this.a=t,this.c=e,this.j=n,this.ta++,this.C?(nn(this.logger,this+" DONE."),this.G(),Jn(this)):(nn(this.logger,this+" new cursor position {"+(this.g?this.a+", "+this.c:this.a)+"}"),this.G(this.a))},t.fa=function(){this.f=null},t.toString=function(){return"Cursor:"+this.s+(n(this.O)?":"+this.O:"")+"["+(this.f?"":"~")+this.Qb+"]"},t.open=function(t,e,n,r){this.f=t,this.Qb=e,this.C=this.N=!1,this.a=n,this.c=r,this.openCursor(this.a,this.c)},t.zb=function(){return this.ta},t.Mc=function(){return this.a},t.T=function(){return this.g?this.c:this.a},t.Ca=function(){return this.Ia?this.T():this.j},t.Sa=function(){},t.ra=function(){},k(Xn,(function(){})),Xn.prototype.f=!0,k(Qn,Xn),k(Zn,Xn),k(tr,Xn),k(er,Xn);var nr="init";function rr(t,e,n){cn.call(this,0,n),this.C=t,this.h=[],this.u=[],this.ta=[],this.a=null,this.ya="",this.N=0}function ir(t,e,n){if(t.a=e,t.ya=n,rn(t.logger,t+" BEGIN"),e){for(n=0;n<t.u.length;n++)t.u[n][0].call(t.u[n][1],e);t.u.length=0}}function or(t){rn(t.logger,t+" END"),t.a=null}function sr(t,e,n){var r=t.ta.shift();n=!!n,r?r[0].call(r[1],e,n,(function(e,n){sr(t,e,n)})):n?t.o(e):t.callback(e)}function ar(t,e,n){t.ta.push([e,n])}function ur(t,e,n){t.a?e.call(n,t.a):t.u.push([e,n])}function lr(t){var e="";return t.ya&&(e=t.a?"*":"",e="["+t.ya+e+"]"),t.C+e}function hr(t,e){var n=new rr(t);return sr(n,e),n}(t=Xn.prototype).logger=Xe("ydn.db.Iterator"),t.Dc=function(){return this.b},t.Ac=function(){return this.c},t.gc=function(){return this.a?this.a instanceof On?this.a:On.bound(this.a.lower,this.a.upper,this.a.lowerOpen,this.a.upperOpen):null},t.Ec=function(){return this.f},t.qc=function(){return this.u},t.clone=function(){var t=new Xn(this.b,this.c,this.a,this.da(),this.za(),this.f,this.h);return t.C=this.C,t},t.unique=function(t){return new Xn(this.b,this.c,this.a,this.da(),t,this.f,this.h)},t.toJSON=function(){return{store:this.b,index:this.c,keyRange:this.a?wn(this.a):null,direction:this.m}},t.toString=function(){var t=(t=n(this.h)?":"+this.h.join(","):n(this.c)?":"+this.c:"")+En(this.a);return this.g!=nr&&(t+=this.g+"{"+this.i,this.u&&(t+=", "+this.j),t+="}"),(this.u?"Index":"")+(this.f?"Key":"Value")+"Iterator:"+this.b+t},t.hc=function(t,e){var n=new Xn(this.b,this.c,this.a,this.da(),this.za(),this.f,this.h);return n.i=t,n.j=e,n.g="rest",n},t.reverse=function(){return new Xn(this.b,this.c,this.a,!this.da(),this.za(),this.f,this.h)},t.da=function(){return"prev"===this.m||"prevunique"===this.m},t.za=function(){return"nextunique"===this.m||"prevunique"===this.m},t.pc=function(){return this.g},t.load=function(t){(t=t[0]).Ob(this.b,this.h||this.c,this.a,this.m,this.f),this.g="busy";var e=this;return t.Pb=function(t,n,r){e.i=n,e.j=r,e.g=t?"rest":"done"},t.openCursor(this.i,this.j),t},t.Bc=function(){return this.i},t.Cc=function(){return this.j},t.Jb=function(t,e,n){t=t||nr,"busy"==this.g?tn(this.logger,this+": resetting state to "+t+" ignore during iteration"):(this.i=e,this.j=n,this.g=t)},t.stores=function(){return[this.b]},k(rr,cn),(t=rr.prototype).ya="",t.logger=Xe("ydn.db.Request"),t.lc=function(){return!!this.a},t.abort=function(){if(rn(this.logger,this+" aborting "+this.a),!this.a)throw new kr(this+" No active transaction");if(h(this.a.abort))this.a.abort();else{if(!h(this.a.executeSql))throw new an;this.a.executeSql("ABORT",[],(function(){}),(function(){return!0}))}},t.callback=function(t){rn(this.logger,this+" SUCCESS"),rr.B.callback.call(this,t)},t.o=function(t){rn(this.logger,this+" ERROR"),rr.B.o.call(this,t)},t.state=function(){return this.c?this.b?"rejected":"resolved":"pending"},t.toString=function(){return"Request:"+lr(this)},t.yb=function(){this.i&&this.c&&Tt(this)&&(At(this.i),this.i=0),this.f&&(this.f.G--,delete this.f);for(var t=this.g,e=!1;this.j.length&&!this.m;){var r=(o=this.j.shift())[0],i=o[1],o=o[2];(r=this.b?i:r)&&(n(r=r.call(o||this.Y,t))&&(this.b=this.b&&(r==t||r instanceof Error),this.g=t=r),E(t)&&(this.m=e=!0))}this.g=t,e&&(e=v(this.Xa,this,!0),r=v(this.Xa,this,!1),t instanceof Nt?(qt(t,e,r),t.K=!0):t.then(e,r))},t.toJSON=function(){var t=(this.ya||"").match(/B(\d+)T(\d+)(?:Q(\d+?))?(?:R(\d+))?/)||[];return{method:this.C?this.C.split(":"):[],branchNo:parseFloat(t[1]),transactionNo:parseFloat(t[2]),queueNo:parseFloat(t[3]),requestNo:parseFloat(t[4])}};var cr=Kn&&Kn.cmp?v(Kn.cmp,Kn):function(t,e){var n=Pn(t),r=Pn(e);return n>r?1:n==r?0:-1},fr=[];function pr(t,e,n,r){if("transaction"in t)this.i=t,this.c=this.h=null;else{if(!("objectStore"in t))throw new Wi("storage instance require.");if(this.i=null,this.h=t.db,this.c=t,!this.c.db.objectStoreNames.contains(e))throw new Wi('store "'+e+'" not in transaction.')}this.j=e,this.m=n,this.u=r,this.b=[],this.a=0,this.g=!1}function gr(t,e,r){if(t&&t instanceof Zi?this.Pa=t:t&&t.db&&(this.Pa=null,dr(this,t)),!a(e))throw new on("a store name required.");if(this.c=e,n(r)&&!a(r))throw new on("projection index name must be a string.");this.Qa=r,this.qa=null,this.b=[],this.a=[],this.Ha=!1}function dr(t,e){if(!e.db)throw new on("Invalid IndexedDB Transaction.");t.qa=new pr(e,t.c,t.Qa,v(t.ea,t))}function vr(t){if((i=0<t.a.length)&&!t.Ha&&h(t.Lb)){var e=function(){vr(t)},n=t.b.shift(),r=t.a.shift(),i=0<t.a.length;e=t.Lb(n,r,i?e:null),i&&!e&&vr(t)}}function yr(t,e){if(null!=t&&!("push"in t))throw new Wi('output receiver object must have "push" method.');this.a=t||null,this.i=e,this.g=0,this.b=!1,this.f=t instanceof gr&&!!t.Qa}function br(t){Error.captureStackTrace?Error.captureStackTrace(this,br):this.stack=Error().stack||"",t&&(this.message=String(t)),this.name="ConstraintError"}function mr(t){Error.captureStackTrace?Error.captureStackTrace(this,mr):this.stack=Error().stack||"",t&&(this.message=String(t)),this.name="ydn.db.VersionError"}function wr(t){Error.captureStackTrace?Error.captureStackTrace(this,wr):this.stack=Error().stack||"",t&&(this.message=String(t))}function kr(t){Error.captureStackTrace?Error.captureStackTrace(this,kr):this.stack=Error().stack||"",t&&(this.message=String(t)),this.name="InvalidStateError"}function Sr(t){Error.captureStackTrace?Error.captureStackTrace(this,Sr):this.stack=Error().stack||"",t&&(this.message=String(t)),this.name="InvalidAccessError"}function Er(t){Error.captureStackTrace?Error.captureStackTrace(this,Er):this.stack=Error().stack||"",t&&(this.message=String(t)),this.name="NotFoundError"}function xr(t,e){Error.captureStackTrace?Error.captureStackTrace(this,xr):this.stack=Error().stack||"",e&&(this.message=String(e)),this.message+=" :"+t.message+" ["+t.code+"]",this.name="SQLError"}function Nr(t,e){Error.captureStackTrace?Error.captureStackTrace(this,Nr):this.stack=Error().stack||"",e&&(this.message=String(e)),this.message+=" :"+t.message,this.name="SecurityError"}function Or(t){Error.captureStackTrace?Error.captureStackTrace(this,Or):this.stack=Error().stack||"",t&&(this.message=String(t)),this.name="ydn.db.SqlParseError"}function Ir(t){Error.captureStackTrace?Error.captureStackTrace(this,Ir):this.stack=Error().stack||"",t&&(this.message=String(t)),this.name="ydn.db.TimeoutError"}function qr(t,e,r){var i;if(c(t))i=t.store,e=t.id,null!=t.parent&&(r=new qr(t.parent));else if(n(e))i=t;else if(i=t.lastIndexOf("^|"),e=t,0<i&&(e=t.substr(i),r=new qr(t.substring(0,i))),i=(e=e.split("^:"))[0],!n(e=e[1]))throw Error("Invalid key value: "+t);this.s=i,this.id=e,this.parent=r||null}function Tr(t){if(s(t)){for(var e=[],n=0,r=t.length;n<r;n++)e[n]=t[n];return e}return t}function Pr(t,e){this.a=e}function Cr(t){this.c=t,this.a=null,this.b=0}function jr(t){return!!t.a&&!t.f}function Rr(t,e,n,r,i,o){this.K=t,this.N=e,this.a=this.f=0,this.G=r,this.C=i,this.g=n||Ar,this.j=o||0}pr.prototype.logger=Xe("ydn.db.con.IdbCursorStream"),pr.prototype.g=!1,(t=gr.prototype).logger=Xe("ydn.db.Streamer"),t.Pa=null,t.Lb=null,t.qa=null,t.xc=function(t){this.Lb=t},t.Ha=!1,t.Jc=function(t){if(this.qa){this.Ha=!0;var e=this;!function(t,e){0==t.b.length&&0==t.a?e():t.ea=e}(this.qa,(function(){t(e.b,e.a),e.b=[],e.a=[],e.Ha=!1}))}else t(this.b,this.a),this.b=[],this.a=[]},t.ea=function(t,e){this.b.push(t),this.a.push(e),vr(this)},t.push=function(t,e){if(this.Ha)throw new zi("push not allowed after a collection is started");if(2<=arguments.length)this.ea(t,e);else{if(!this.qa){if(!this.Pa)throw new zi("Database connection is not setup.");var n=this.Pa.Ba();if(!n)throw new zi("Database is not connected.");if("indexeddb"!==n)throw new Vi(n);this.qa=new pr(this.Pa,this.c,this.Qa,v(this.ea,this))}(n=this.qa).b.push(t),function(t){if(!t.g){var e=function(e,n){t.c=null,"complete"!==e&&tn(t.logger,n.name+":"+n.message),nn(t.logger,t+" transaction "+e)},n=function(e){var n=t.b.shift();nn(t.logger,t+" transaction started for "+n),e=e.objectStore(t.j),function(t,e){t.a++,e.onsuccess=function(e){if(e=e.target.result){if(h(t.u)){var n=e.value;t.u(e.primaryKey,null!=t.m?n[t.m]:n)}else tn(t.logger,"sink gone, dropping value for: "+e.primaryKey);e&&0<t.b.length?e.continue(t.b.shift()):(t.a--,0==t.a&&t.ea&&t.ea())}},e.onerror=function(){tn(t.logger,"seeking fail. "+("error"in e?e.error.name+":"+e.error.message:"")),t.a--,0==t.a&&t.ea&&t.ea()}}(t,e.openCursor(n))};if(t.c)nn(t.logger,t+" using existing tx."),n(t.c);else if(t.h)nn(t.logger,t+" creating tx from IDBDatabase."),t.f=t.h.transaction([t.j],Fn),t.f.oncomplete=function(t){e("complete",t)},t.f.onerror=function(t){e("error",t)},t.f.onabort=function(t){e("abort",t)};else{if(!t.i)throw new Gi("no way to create a transaction provided.");nn(t.logger,t+" creating tx from ydn.db.con.IStorage."),t.g=!0,t.i.transaction((function(e){t.g=!1,n(e)}),[t.j],Fn,e)}}}(n)}},t.toString=function(){return"Streamer:"+this.c+(this.Qa||"")},yr.prototype.logger=Xe("ydn.db.algo.AbstractSolver"),yr.prototype.h=function(t,e){this.b=e[0].da();for(var n=0;n<e.length;n++){if(!(e[n]instanceof Xn))throw new sn("item at iterators "+n+" is not an iterator.");if(0<n&&this.b!=e[n].da())throw new sn("iterator at "+n+" must "+(this.b?"be reverse":"not be reverse"))}if(this.a instanceof gr&&dr(this.a,t),this.f&&(n=e[0].h)&&1<n.length&&n[n.length-1]!=this.a.Qa)throw new zi("Output streamer projection field must be same as postfix field in the iterator");var r="{";for(n=0;n<e.length;n++)0<n&&(r+=", "),r+=e.toString();return r+="}",this.b&&(r+=" reverse"),en(this.logger,this+" begin "+r),!1},yr.prototype.c=function(){return[]},k(br,Error),br.prototype.name="ConstraintError",br.prototype.toString=function(){return this.name+": "+this.message},k(mr,Error),mr.prototype.name="ydn.db.VersionError",mr.prototype.toString=function(){return this.name+": "+this.message},k(wr,Error),wr.prototype.name="ydn.db.InternalError",k(kr,Error),k(Sr,Error),k(Er,Error),Er.prototype.name="NotFoundError",Er.prototype.toString=function(){return this.name+": "+this.message},k(xr,Error),xr.prototype.toString=function(){return this.name+": "+this.message},k(Nr,Error),Nr.prototype.toString=function(){return this.name+": "+this.message},k(Or,Error),k(Ir,Error),(t=qr.prototype).toJSON=function(){var t={store:this.s,id:this.id};return this.parent&&(t.parent=this.parent.toJSON()),t},t.valueOf=function(){return(this.parent?this.parent.valueOf()+"^|":"")+this.s+"^:"+this.id},t.toString=function(){return this.valueOf().replace("^|","|").replace("^:",":")},t.Gc=function(){return this.s},t.mc=function(){return this.id},t.Fc=function(){return this.parent},Pr.prototype.logger=Xe("ydn.db.crud.req.RequestExecuto"),Pr.prototype.toString=function(){return"RequestExecutor"},Cr.prototype.logger=Xe("ydn.db.tr.Mutex"),Cr.prototype.R=null,Cr.prototype.L=null,Cr.prototype.toString=function(){return"Mutex:B"+this.c+"T"+this.b+(this.a?"*":"")},Rr.prototype.logger=Xe("ydn.db.tr.Thread"),Rr.prototype.type=function(){return this.K.Ba()},Rr.prototype.l=function(){return this.K},Rr.prototype.I=function(){return"B"+this.N+"T"+this.f};var Ar="single";function Dr(t){if(!t)throw new kr("No active transaction");if(h(t.abort))t.abort();else{if(!h(t.executeSql))throw new an;t.executeSql("ABORT",[],null,(function(){return!0}))}}function Br(t,e,n,r,i,o){Rr.call(this,t,e,n,r,i,o),this.c=[],this.h=[],this.i=null,this.b=new Cr(e),this.m=o||0,this.u=!1}function Lr(t,e,n){if("multi"==t.g)t:if(t=t.b,!t.R||!t.mode||n!=t.mode&&(t.mode!=_n||n!=Fn)||e.length>t.R.length)e=!1;else{for(n=0;n<e.length;n++)if(-1==t.R.indexOf(e[n])){e=!1;break t}e=!0}else if("repeat"==t.g)t:if(t=t.b,t.R&&t.mode&&n==t.mode&&t.R.length==e.length){for(n=0;n<e.length;n++)if(-1==t.R.indexOf(e[n])){e=!1;break t}e=!0}else e=!1;else e="all"==t.g;return e}function Mr(t){var e=0<t.c.length?t.c[0].R:null,n=0<t.c.length?t.c[0].mode:null;return null!=e&&null!=n&&Lr(t,e,n)}function Fr(t,e){Br.call(this,t,e)}function _r(t,e,n){this.f=t,this.b=e,this.a=n,this.c=null}function Ur(t){return t.c||(t.c=t.f.u()),t.c}function Kr(t,e){var n=a(e)?e:c(e)?e.name:void 0;if(!a(n))throw new on("store name "+n+" must be a string, but "+typeof n);var r=Fi(t.b,n);if(r){if(t.b.a()&&c(e)&&(o=qi(r,o=di(e))))throw new an(o)}else{if(!t.b.a())throw new on('store name "'+n+'" not found.');r=di(c(e)?e:{name:n}),rn(t.logger,"Adding object store: "+n);var i=r,o=t.l(),s=i instanceof gi?i:di(i),u=(i=i.name,Fi(o.a,i));if(0==qi(s,u).length)Pt(!1);else{if(u=u?"update":"add",!(o.a instanceof Ki))throw new Ji("Cannot "+u+" store: "+i+". Not auto schema generation mode.");$i(o.a,s),o.b?(o.b.close(),o.b=null,eo(o)):Pt(!1)}}if(!r)throw new Er(n);return r}function $r(t,e,n){_r.call(this,t,e,n)}function Wr(t,e,n){_r.call(this,t,e,n)}function Hr(t,e,r,i,o){var s=[],a=r.a,u=lr(r),l=u+" "+e+"ByIterator "+i;0<o&&(l+=" limit "+o),rn(t.logger,l);for(var h=Ur(t),c=[],f=i.stores(),p=0;p<f.length;p++)c[p]=h.b(a,u,f[p]);var g=i.load(c);g.Y=function(t){Yn(g),sr(r,t,!0)};var d=0,v=!1;g.G=function(i){v||(nn(t.logger,l+" starting"),v=!0),null!=i?(g.T(),d++,1==e?s.push(i):2==e?s.push(g.T()):3==e?s.push([i,g.T()]):6!=e&&s.push(g.Ca()),5==e?(Yn(g),sr(r,s[0])):6==e||!n(o)||d<o?g.ra():(rn(t.logger,"success:"+l+" yields "+s.length+" records"),Yn(g),sr(r,s))):(rn(t.logger,"success:"+l+" yields "+s.length+" records"),Yn(g),sr(r,5==e?s[0]:6==e?d:s))}}function Vr(t,e){this.type=t,this.b=this.target=e,this.ec=!0}k(Br,Rr),(t=Br.prototype).logger=Xe("ydn.db.tr.Serial"),t.abort=function(){rn(this.logger,this+": aborting"),Dr(this.i)},t.pa=function(t,e,r,i){var o=a(e)?[e]:e;if(!s(o))throw new on("store names must be an array");if(0==o.length)throw new on("number of store names must more than 0");for(var u=0;u<o.length;u++){if(!a(o[u]))throw new on("store name at "+u+" must be string but found "+o[u]+" of type "+typeof o[u]);if(this.Y&&!(0<=H(this.Y,o[u])))throw new on('store name "'+u+o[u]+'" in scope of '+this)}var l=n(r)?r:Fn,c=this;if(this.b.a||!ro(this.l())&&this.u)!function(t,e,n,r,i){nn(t.logger,"push tx queue["+t.c.length+"]"),t.c.push({ab:e,R:n,mode:r,L:i})}(this,t,e,l,i);else{var f=this.I();if(i&&this.h.push(i),this.m&&this.f>=this.m)throw new ln("Exceed maximum number of transactions of "+this.m);this.u=!0,this.l().transaction((function(n){var r=c.b;for(r.a=n,r.f=!1,r.R=e,r.mode=l,r.b++,r.L=null,f=c.I(),en(c.logger,f+" BEGIN "+Ri(e)+" "+l),t(c),t=null;Mr(c);)(n=c.c.shift()).L&&c.h.push(n.L),nn(c.logger,"pop tx queue"+(c.c.length+1)+" reusing T"+c.f),n.ab()}),o,l,(function(t,e){en(c.logger,f+" "+t);var n=c.b;for(n.a?(n.a=null,n.R=null,n.mode=null,h(n.L)&&n.L(t,e),n.L=null):tn(n.logger,n+" has no TX to be unlocked for "+t),n=0;n<c.h.length;n++)(0,c.h[n])(t,e);c.h.length=0,(n=c.c.shift())&&c.pa(n.ab,n.R,n.mode,n.L),c.a=0}))}},t.I=function(){var t=this.b;return"B"+t.c+"T"+t.b},t.request=function(t,e,n,r){function i(t,e){or(o),r&&r(t,e)}var o=new rr(t);t=n||Fn;var s=this;return jr(this.b)&&Lr(this,e,t)?(e=this.b.a,this.a++,ir(o,e,this.I()+"R"+this.a),this.h.push(i)):s.pa((function(){var t=s.b.a;s.a++,ir(o,t,s.I()+"R"+s.a)}),e,t,i),o},t.Da=function(t,e,n,r,i){r=r||Fn;var o,s=this;if(jr(s.b)&&Lr(this,n,r)){var a=s.b.a;s.a++,o=s.I()+"R"+s.a,rn(s.logger,o+" BEGIN"),e(a,o,(function(e,n){s.i=a,n?(rn(s.logger,o+" ERROR"),t.o(e)):(rn(s.logger,o+" SUCCESS"),t.callback(e)),s.i=null})),rn(s.logger,o+" END"),e=null}else s.pa((function(){var n=s.b.a;s.a++,o=s.I()+"R"+s.a,rn(s.logger,o+" BEGIN"),e(n,o,(function(e,r){s.i=n,r?(rn(s.logger,o+" ERROR"),t.o(e)):(rn(s.logger,o+" SUCCESS"),t.callback(e)),s.i=null})),rn(s.logger,o+" END"),e=null}),n,r,i)},t.getName=function(){return this.l().getName()},t.toString=function(){return"Serial:"+this.I()+(this.i?"*":"")},k(Fr,Br),Fr.prototype.logger=Xe("ydn.db.tr.AtomicSerial"),Fr.prototype.request=function(t,e,n){var r,i,o,s=Fr.B.request.call(this,t,e,n,(function(t,e){if(or(s),r)"complete"!=t&&(o=!0,i=e),r(i,o);else{var n=new Ir;sr(s,n,!0)}}));return ar(s,(function(t,e,n){o=e,i=t,r=n})),s},Fr.prototype.Da=function(t,e,n,r,i){var o,s,a=new Nt;qt(a,(function(t){s=!1,o=t}),(function(t){s=!0,o=t})),Fr.B.Da.call(this,a,e,n,r,(function(e,n){if("complete"!=e)t.o(n);else if(!0===s)t.o(o);else if(!1===s)t.callback(o);else{var r=new Ir;t.o(r)}i&&(i(e,n),i=void 0)}))},Fr.prototype.toString=function(){return"Atomic"+Fr.B.toString.call(this)},(t=_r.prototype).logger=Xe("ydn.db.tr.DbOperator"),t.Oc=function(){return this.a.f},t.abort=function(){this.a.abort()},t.l=function(){return this.f},t.toString=function(){return"TxStorage:"+this.l().getName()},k($r,_r),(t=$r.prototype).logger=Xe("ydn.db.crud.DbOperator"),t.count=function(t,e,r,i){var s,l,h,f;if(null!=t)if(o(t)){if(n(r)||n(e))throw new on("too many arguments.");l=t;for(var p=0;p<l.length;p++)if(!_i(this.b,l[p]))throw new on('store name "'+l[p]+'" at '+p+" not found.");rn(this.logger,"countStores: "+Ri(l)),ur(s=this.a.request("count",l),(function(){Ur(this).Ya(s,l)}),this)}else{if(!a(t))throw new on("Invalid store name or store names.");if(!(p=Fi(this.b,t)))throw new on('store name "'+t+'" not found.');if(n(i)&&!u(i))throw new on('unique value "'+i+'" must be boolean, but found '+typeof i+".");if(l=[t],a(e))if(h=e,c(r)){var g=Sn(r);if(g)throw new on("invalid key range: "+ji(r)+" "+g);f=kn(r)}else{if(null!=r)throw new on("invalid key range: "+ji(r)+" of type "+typeof r);f=null}else{if(!c(e)&&null!=e)throw new on('invalid second argument for count "'+ji(r)+'" of type '+typeof e);if(c(e)){if(g=Sn(e))throw new on("invalid key range: "+ji(e)+" "+g);f=kn(e)}else{if(null!=e)throw new on("key range must be  an object but found "+ji(e)+" of type "+typeof e);f=null}}rn(this.logger,"countKeyRange: "+t+" "+(h||"")+Ri(f)),Pi(p,s=this.a.request("count",l),arguments),ur(s,(function(){Ur(this).Fa(s,l[0],f,h,!!i)}),this)}else tn(this.logger,"count method requires store name(s)"),p=Mi(this.b),ar(s=this.a.request("count",p),(function(t,e,n){if(e)n(t,!0);else{for(var r=e=0;r<t.length;r++)e+=t[r];n(e,!1)}}),this),ur(s,(function(){Ur(this).Ya(s,l)}),this);return s},t.get=function(t,e){var r,i=this;if(t instanceof qr){var o=t,s=o.s;if(!(l=Fi(this.b,s))){if(this.b.a())return ro(this.l())?hr("get",void 0):(r=new rr("get"),this.l().ib((function(){qt(i.get(t,e),(function(t){r.callback(t)}),(function(t){r.o(t)}))})),r);throw new on("Store: "+s+" not found.")}var u=o.id;rn(this.logger,"getByKey: "+s+":"+u),Pi(l,r=this.a.request("get:key",[s]),arguments,void 0,this),ur(r,(function(){Ur(this).bb(r,s,u)}),this)}else{if(!a(t)||!n(e))throw new on("get require valid input arguments.");var l,h=t;if(!(l=Fi(this.b,h))){if(this.b.a())return ro(this.l())?hr("get",void 0):(r=new rr("get"),this.l().ib((function(){qt(i.get(t,e),(function(t){r.callback(t)}),(function(t){r.o(t)}))})),r);throw new on('Store name "'+h+'" not found.')}var c=e;rn(this.logger,"getById: "+h+":"+c),Pi(l,r=this.a.request("get",[h]),arguments,void 0,this),ur(r,(function(){Ur(this).bb(r,h,c)}),this)}return r},t.rc=function(t,e,r,i,o){var s,a,h,f=Fi(this.b,t),p=null;if(c(e)){var g=Sn(e);if(g)throw new on("invalid key range: "+e+" "+g);p=kn(e)}else if(null!=e)throw new on('expect key range object, but found "'+ji(e)+'" of type '+typeof e);if(n(r)){if(!l(r))throw new on("limit must be a number, but "+r+" is "+typeof r);s=r}else s=100;if(n(i)){if(!l(i))throw new on("offset must be a number, but "+i+" is "+typeof i);a=i}else a=0;if(n(o)){if(!u(o))throw new on("reverse must be a boolean, but "+o+" is "+typeof o);h=o}rn(this.logger,"keysByKeyRange: "+t);var d=this.a.request("keys",[t]);return Pi(f,d,arguments),ur(d,(function(){Ur(this).$(d,2,t,null,p,s,a,h,!1)}),this),d},t.Ja=function(t,e,r,i,o,s,a){var h,c,f,p,g,d=Sn(r);if(d)throw new on("invalid key range: "+r+" "+d);if(d=Fi(this.b,t),h=kn(r),l(i))c=i;else{if(n(i))throw new on("limit must be a number");c=100}if(l(o))f=o;else{if(n(o))throw new on("offset must be a number");f=0}if(n(s)){if(!u(s))throw new on("reverse must be a boolean");p=s}if(n(a)){if(!u(a))throw new on("unique must be a boolean");g=a}rn(this.logger,"keysByIndex: "+t);var v=this.a.request("keys:iter:index",[t]);return Pi(d,v,arguments),ur(v,(function(){Ur(this).$(v,2,t,e,h,c,f,p,g)}),this),v},t.keys=function(t,e,n,r,i,o,s){var u=Fi(this.b,t);if(!a(t))throw new on("store name must be a string, but "+t+" of type "+typeof t+" is not.");if(!this.b.a()){if(!u)throw new on('store name "'+t+'" not found.');if(a(e)&&!wi(u,e))throw new on('index "'+e+'" not found in store "'+t+'".')}return this.b.a()&&!u?hr("keys",[]):a(e)?this.Ja(t,e,n,r,i,o,s):this.rc(t,e,n,r,i)},t.values=function(t,e,r,i,s,u,l){var h,c=this;if(a(t)){var f=t;if(!(g=Fi(this.b,f))){if(this.b.a())return ro(this.l())?hr("values",[]):(h=new rr("values"),this.l().ib((function(){qt(c.values(t,e,r,i,s,u),(function(t){h.callback(t)}),(function(t){h.o(t)}))})),h);throw new Er(f)}if(o(e)){if(n(r)||n(i))throw new on("too many input arguments");var p=e;rn(this.logger,"listByIds: "+f+" "+p.length+" ids"),Pi(g,h=this.a.request("values:array",[f]),arguments,void 0,this),ur(h,(function(){Ur(this).Eb(h,f,p)}),this)}else h=a(e)?this.Ma(f,e,r,i,s,u,l):this.yc(f,e,r,i,s)}else{if(!o(t))throw new on("first argument "+t+" is invalid.");if(!(t[0]instanceof qr))throw new on("first argumentmust be array of ydn.db.Key, but "+t[0]+" of "+typeof t[0]+" found.");for(var g=[],d=t,v=0;v<d.length;v++){var y=d[v].s;if(!_i(this.b,y)){if(this.b.a())return(g=[])[d.length-1]=void 0,hr("get",g);throw new on("Store: "+y+" not found.")}0<=H(g,y)||g.push(y)}rn(this.logger,"listByKeys: "+Ri(g)+" "+d.length+" keys"),ur(h=this.a.request("values:keys",g),(function(){Ur(this).Fb(h,d)}),this)}return h},t.yc=function(t,e,r,i,o){var s,a,h,f=Fi(this.b,t),p=null;if(c(e)){var g=Sn(e);if(g)throw new on("invalid key range: "+e+" "+g);p=kn(e)}else if(null!=e)throw new on('expect key range object, but found "'+ji(e)+'" of type '+typeof e);if(n(r)){if(!l(r))throw new on("limit must be a number, but "+r+" is "+typeof r);s=r}else s=100;if(n(i)){if(!l(i))throw new on("offset must be a number, but "+i+" is "+typeof i);a=i}else a=0;if(n(o)){if(!u(o))throw new on("reverse must be a boolean, but "+o+" is "+typeof o);h=o}rn(this.logger,(p?"listByKeyRange: ":"listByStore: ")+t);var d=this.a.request("values",[t]);return Pi(f,d,arguments),ur(d,(function(){Ur(this).$(d,4,t,null,p,s,a,h,!1)}),this),d},t.Ma=function(t,e,r,i,o,s,a){var h,c,f,p,g=Fi(this.b,t);if(!Si(g,e))throw new on('index "'+e+'" not found in store "'+t+'"');var d=Sn(r);if(d)throw new on("invalid key range: "+r+" "+d);var v=kn(r);if(n(i)){if(!l(i))throw new on("limit must be a number.");h=i}else h=100;if(n(o)){if(!l(o))throw new on("offset must be a number.");c=o}else c=0;if(u(s))f=s;else if(n(s))throw new on("reverse must be a boolean, but "+s);if(n(a)){if(!u(a))throw new on("unique must be a boolean");p=a}rn(this.logger,"listByIndexKeyRange: "+t+":"+e);var y=this.a.request("values:iter:index",[t]);return Pi(g,y,arguments),ur(y,(function(){Ur(this).$(y,4,t,e,v,h,c,f,p)}),this),y},t.add=function(t,e,r){if(o(e))return this.Ta(t,e,r);var i,s=Kr(this,t),u=s.getName();if(a(s.keyPath)&&n(r))throw new on("key must not be provided while the store uses in-line key.");if(!s.keyPath&&!s.b&&!n(r))throw new on("out-of-line key must be provided for store: "+u);if(o(e)){for(rn(this.logger,"addObjects: "+u+" "+e.length+" objects"),t=0;t<e.length;t++)Ti(s,e[t]);ur(i=this.a.request("add:array",[u],_n),(function(){Ur(this).P(i,!1,!1,u,e,r)}),this),s.aa&&i.H((function(t){t=new ni(Jr,this.l(),u,t,e),this.l().J(t)}),this)}else{if(!c(e))throw new on("record must be an object or array list of objects, but "+e+" of type "+typeof e+" found.");t="store: "+u+" key: "+Ni(s,e,r),rn(this.logger,"addObject: "+t),Ti(s,e),ur(i=this.a.request("add",[u],_n),(function(){Ur(this).P(i,!1,!0,u,[e],[r])}),this),s.aa&&i.H((function(t){t=new ei(Jr,this.l(),s.getName(),t,e),this.l().J(t)}),this)}return i},t.Ta=function(t,e,r){var i,s=Kr(this,t),u=s.getName();if(a(s.keyPath)&&n(r))throw new on("key must not be provided while the store uses in-line key.");if(!s.keyPath&&!s.b&&!n(r))throw new on("out-of-line key must be provided for store: "+u);if(!o(e))throw new on("record must be an array list of objects, but "+e+" of type "+typeof e+" found.");for(rn(this.logger,"addObjects: "+u+" "+e.length+" objects"),t=0;t<e.length;t++)Ti(s,e[t]);return ur(i=this.a.request("add:array",[u],_n),(function(){Ur(this).P(i,!1,!1,u,e,r)}),this),s.aa&&i.H((function(t){t=new ni(Jr,this.l(),s.getName(),t,e),this.l().J(t)}),this),i},t.put=function(t,r,i){var s,u=this;if(t instanceof qr){var l=(g=t).s;if(!(d=Fi(this.b,l)))throw new on('store "'+l+'" not found.');if(d.keyPath){var h=Ni(d,r);if(null!=h){if(0!=cr(h,g.id))throw new on("Inline key must be "+g+" but "+h+" found.")}else Oi(d,r,g.id);return this.put(l,r)}return this.put(l,r,g.id)}if(o(t)){if(n(i))throw new on("too many arguments");var f=t;if(!n(r))throw new on("record values required");for(var p=r,g=[],d=(l=0,f.length);l<d;l++){if(h=f[l].s,-1==H(g,h)&&g.push(h),!(v=Fi(this.b,h)))throw new on('store "'+h+'" not found.');v.keyPath&&Oi(v,p[l],f[l].id)}for(rn(this.logger,"putByKeys: to "+Ri(g)+" "+p.length+" objects"),l=0;l<p.length;l++)Ti(v,p[l]);s=this.a.request("put:keys",g,_n),Pi(v,s,arguments),ur(s,(function(){Ur(u).Gb(s,p,f)}),this)}else{if(!a(t)&&!c(t))throw new on("the first argument of put must be store name, store schema or array of keys.");var v,y=(v=Kr(this,t)).getName();if(v.keyPath&&n(i))throw new on("key must not be provided while the store uses in-line key.");if(!v.keyPath&&!v.b&&!n(i))throw new on("out-of-line key must be provided for store: "+y);if(o(r)){var b=r,m=i;for(rn(this.logger,"putObjects: "+y+" "+b.length+" objects"),l=0;l<b.length;l++)Ti(v,b[l]);s=this.a.request("put:array",[y],_n),Pi(v,s,arguments),ur(s,(function(){Ur(this).P(s,!0,!1,y,b,m)}),this),v.aa&&s.H((function(t){t=new ni(zr,this.l(),y,t,b),this.l().J(t)}),this)}else{if(!c(r))throw new on("put record value must be Object or array of Objects");var w=r,k=i;if(rn(this.logger,"putObject: "+y+" "+(n(k)?k:"(without-key)")),n(e.Blob)&&w instanceof Blob&&v.sa&&!v.keyPath&&0==v.a.length&&me)s=new rr("put"),(g=new FileReader).onload=function(t){var e=t.target.result,n=u.a.request("put",[y],_n);Pi(v,n,[y,w,k]),ur(n,(function(){Ur(u).P(n,!0,!0,y,[e],[k])}),this),qt(n,(function(t){s.callback(t)}),(function(t){s.o(t)}))},g.onerror=function(t){s.o(t)},g.onabort=function(t){s.o(t)},g.readAsDataURL(w);else{Ti(v,w),s=this.a.request("put",[y],_n);var S=[y,w,k];Pi(v,s,S),ur(s,(function(){var t=n(k)?[S[2]]:void 0;Ur(u).P(s,!0,!0,y,[S[1]],t)}),this)}v.aa&&s.H((function(t){t=new ei(zr,this.l(),y,t,w),this.l().J(t)}),this)}}return s},t.kb=function(t,e,r){var i,o=Kr(this,t),s=o.getName();if(o.keyPath&&n(r))throw new on("key must not be provided while the store uses in-line key.");if(!o.keyPath&&!o.b&&!n(r))throw new on("out-of-line key must be provided for store: "+s);var a=e,u=r;rn(this.logger,"putObjects: "+s+" "+a.length+" objects");for(var l=0;l<a.length;l++)Ti(o,a[l]);return Pi(o,i=this.a.request("put:array",[s],_n),arguments),ur(i,(function(){Ur(this).P(i,!0,!1,s,a,u)}),this),o.aa&&i.H((function(t){t=new ni(zr,this.l(),s,t,a),this.l().J(t)}),this),i},t.clear=function(t,e,r){if(n(r))throw new on("too many input arguments");var i;if(a(t)){if(!(r=Fi(this.b,t)))throw new on('store name "'+t+'" not found.');if(c(e)){var s=kn(e);if(null===s)throw new on("clear method requires a valid non-null KeyRange object.");rn(this.logger,"clearByKeyRange: "+t+":"+Ri(s)),Pi(r,i=this.a.request("clear",[t],_n),[t,s]),ur(i,(function(){Ur(this).vb(i,t,s)}),this)}else{if(n(e))throw new on("clear method requires a valid KeyRange object as second argument, but found "+e+" of type "+typeof e);rn(this.logger,"clearByStore: "+t),ur(i=this.a.request("clear",[t],_n),(function(){Ur(this).Wa(i,[t])}),this)}}else{if(!(!n(t)||o(t)&&a(t[0])))throw new on('first argument "'+t+'" is invalid.');var u=t||Mi(this.b);rn(this.logger,"clearByStores: "+Ri(u)),ur(i=this.a.request("clear",u,_n),(function(){Ur(this).Wa(i,u)}),this)}return i},t.sb=function(t,e,r){var u;if(a(t)){if(!(d=Fi(this.b,t)))throw new on('store name "'+t+'" not found.');if(n(r)){if(!a(e))throw new on('index name "'+e+'" must be a string, but '+typeof e+" found.");var h=wi(d,e);if(!h)throw new on("index: "+e+" not found in "+t);if(!c(r)&&null!==r)throw new on("key range "+r+' is invalid type "'+typeof r+'".');var f=kn(r);rn(this.logger,"removeByIndexKeyRange: "+t+":"+h.getName()+" "+t),ur(u=this.a.request("rm:iter:index",[t],_n),(function(){Ur(this).Hb(u,t,h.getName(),f)}),this)}else if(a(e)||l(e)||s(e)||e instanceof Date){rn(this.logger,"removeById: "+t+":"+e),u=this.a.request("rm",[t],_n);var p=[t,e];Pi(d,u,p),ur(u,(function(){Ur(this).lb(u,t,p[1])}),this),d.aa&&u.H((function(n){n=1==n?e:void 0,n=new ei(Yr,this.l(),t,n,void 0),this.l().J(n)}),this)}else{if(!c(e))throw new on('Invalid key or key range "'+e+'" of type '+typeof e);f=kn(e),rn(this.logger,"removeByKeyRange: "+t+":"+Ri(f)),Pi(d,u=this.a.request("rm:iter",[t],_n),[t,f]),ur(u,(function(){Ur(this).mb(u,t,f)}),this),d.aa&&u.H((function(e){var n=[];n.length=e,e=new ni(Yr,this.l(),t,n,void 0),this.l().J(e)}),this)}}else if(t instanceof qr){var g=t.s,d=Fi(this.b,g);u=this.a.request("rm",[g],_n);var v=[g,t.id];Pi(d,u,v),ur(u,(function(){Ur(this).lb(u,g,v[1])}),this)}else{if(!o(t))throw new on('first argument requires store name, key (ydn.db.Key) or list of keys (array) , but "'+ji(t)+'" ('+i(t)+") found.");r=[],d=0;for(var y=t.length;d<y;d++){if(!(t[d]instanceof qr))throw new on("key list element at "+d+" of "+y+' must be yn.db.Key, but "'+ji(t[d])+'" ('+i(t[d])+") is not ydn.db.Key.");var b=t[d].s;-1==H(r,b)&&r.push(b)}if(1>r.length)throw new on('at least one valid key required in key list "'+ji(t)+'"');ur(u=this.a.request("rm:keys",r,_n),(function(){Ur(this).Ib(u,t)}),this)}return u},t.toString=function(){return"DbOperator:"+this.l().getName()},k(Wr,$r),(t=Wr.prototype).logger=Xe("ydn.db.core.DbOperator"),t.get=function(t,e){if(t instanceof Xn){var r=t.b,i=Fi(this.b,r);if(!i)throw new on('store "'+r+'" not found.');var o=t.c;if(n(o)&&!Si(i,o))throw new on('index "'+o+'" not found in store "'+r+'".');rn(this.logger,"getByIterator:"+t);var s=this.a.request("get:iter",[r]);return ur(s,(function(){Hr(this,5,s,t,1)}),this),s}return Wr.B.get.call(this,t,e)},t.Ka=function(t,e){var r=100;if(l(e)){if(1>(r=e))throw new on("limit must be a positive value, but "+e)}else if(n(e))throw new on("limit must be a number,  but "+e);rn(this.logger,"keysOf:"+t);var i=this.a.request("keys:iter",[t.b]);return ur(i,(function(){t.u?Hr(this,1,i,t,r):Hr(this,2,i,t,r)}),this),i},t.keys=function(t,e,n,r,i,o,s){return t instanceof Xn?this.Ka(t,e):Wr.B.keys.call(this,t,e,n,r,i,o,s)},t.Ga=function(t){rn(this.logger,"countIterator:"+t);var e=this.a.request("count",[t.b]);return ur(e,(function(){Hr(this,6,e,t)}),this),e},t.count=function(t,e,r,i){if(t instanceof Xn){if(n(e)||n(r))throw new on("too many arguments.");return this.Ga(t)}return Wr.B.count.call(this,t,e,r,i)},t.Na=function(t,e){var r;if(l(e)){if(1>(r=e))throw new on("limit must be a positive value, but "+r)}else if(n(e))throw new on("limit must be a number, but "+e);rn(this.logger,"listByIterator:"+t);var i=this.a.request("values:iter",[t.b]);return ur(i,(function(){t.f?Hr(this,2,i,t,r):Hr(this,4,i,t,r)}),this),i},t.values=function(t,e,n,r,i,o){return t instanceof Xn?this.Na(t,e):Wr.B.values.call(this,t,e,n,r,i,o)},t.Nb=function(t,e,r){if(!o(e))throw new on("iterators argument must be an array, but "+e+" of type "+typeof e+" found");for(var i=0;i<e.length;i++)if(!(e[i]instanceof Xn))throw new on("Iterator at "+i+" must be cursor range iterator.");r=r||Fn;var s=[];for(i=0;i<e.length;i++)for(var a=e[i].stores(),u=0;u<a.length;u++)0<=H(s,a[u])||s.push(a[u]);rn(this.logger,this+": scan for "+e.length+" iterators on "+s);var l=this;return i=this.a.request("scan",s),this.a.Da(i,(function(r,i,s){function a(){for(var t=0,n=0;n<e.length;n++){var o=e[n],s=[Ur(l).b(r,i,o.b)];(o=o.load(s)).Y=u,o.G=y(h,t),m[n]=o,d[t]=n,t++}p=e.length}function u(t){for(var e=0;e<m.length;e++)Yn(m[e]);X(m),rn(l.logger,f+" error"),s(t,!0)}function h(r,i){if(g)throw new Gi;var a=++w===p,u=d[r],h=e[u],y=(u=(y=m[u]).T(),y.Ca());if(v[r]=i,b[r]=h.u?h.f?u:y:h.f?i:y,a){var k;if(a=[],h=[],u=[],y=[],o(k=t instanceof yr?t.c(v,b):t(v,b)))for(var S=0;S<k.length;S++)!0===k[S]?u[S]=1:!1===k[S]?y[S]=!0:h[S]=k[S];else if(null===k)a=[];else if(n(k)){if(!c(k))throw new ln("scan callback output");for(S in a=["advance","continue","continuePrimary","restart"],k)if(!(0<=H(a,S)))throw new ln('Unknown attribute "'+S+'" in cursor advancement object');a=k.continuePrimary||[],h=k.continue||[],u=k.advance||[],y=k.restart||[]}else for(a=[],S=0;S<e.length;S++)n(d[S])&&(u[S]=1);for(S=w=k=0;S<e.length;S++)null!=a[S]||n(h[S])||null!=y[S]||null!=u[S]||w++;for(S=0;S<e.length;S++)if(null!=a[S]||n(h[S])||null!=y[S]||null!=u[S]){if(!n(E=d[S]))throw new Yi(S+" is not an iterator.");var E=e[E],x=m[S];if(null==v[S]){var N=S+"/"+e.length;if(null!=u[S])throw new zi(x+" "+N+" must not advance "+u[S]+" steps");if(n(h[S]))throw new zi(x+" "+N+" must not continue to key "+h[S]);if(null!=a[S])throw new zi(x+" "+N+" must not continue to primary key "+a[S])}if(v[S]=void 0,b[S]=void 0,null!=y[S])zn(x);else if(n(h[S]))x.ra(h[S]);else if(null!=a[S])x.Sa(a[S]);else{if(null==u[S])throw new Gi(E+": has no action");x.advance(1)}k++}if(0==k){for(k=0;k<m.length;k++)Yn(m[k]);g=!0,X(m),rn(l.logger,"success "+f),s(void 0)}}}var f=i+" "+l+" scanning";nn(l.logger,f);var p,g=!1,d=[],v=[],b=[],m=[],w=0;t instanceof yr&&t.h(r,e,(function(){a()}))||a()}),s,r),i},t.open=function(t,e,n,r){if(!(e instanceof Xn))throw new on("Second argument must be cursor range iterator.");for(var i=e.stores(),o=0;o<i.length;o++)if(!Fi(this.b,i[o]))throw new on('Store "'+i[o]+'" not found.');n=n||Fn;var s=this,a=this.a.request("open",e.stores(),n);return rn(this.logger,"open:"+n+" "+e),ur(a,(function(n){var i=lr(a);rn(s.logger,i+" iterating "+e);for(var o=e.stores(),u=[],l=0;l<o.length;l++)u[l]=Ur(s).b(n,i,o[l]);var h=e.load(u);h.Y=function(t){sr(a,t,!0)},h.G=function(e){null!=e?!0===(e=t.call(r,h))?zn(h):c(e)?!0===e.restart?zn(h,e.continue,e.continuePrimary):null!=e.continue?h.ra(e.continue):null!=e.continuePrimary?h.Sa(e.continuePrimary):(Yn(h),sr(a,void 0)):null===e?(Yn(h),sr(a,void 0)):null!=e?h.ra(e):h.advance(1):(Yn(h),sr(a,void 0))}}),this),a},Vr.prototype.preventDefault=function(){this.ec=!1};var Gr,Jr="created",Yr="deleted",zr="updated";function Xr(t,e){Vr.call(this,t,e)}function Qr(t,e,n,r,i){Vr.call(this,t,e),this.version=n,this.ic=r,this.bc=i}function Zr(t,e,n){Vr.call(this,n||"error",t),this.error=e}function ti(t,e){Zr.call(this,t,e,"fail")}function ei(t,e,n,r,i){Vr.call(this,t,e),this.s=n,this.key=r,this.value=i}function ni(t,e,n,r,i){Vr.call(this,t,e),this.s=n,this.keys=r,this.values=i}k(Xr,Vr),Xr.prototype.a=function(){return this.s},k(Qr,Xr),(t=Qr.prototype).name="ReadyEvent",t.version=NaN,t.ic=NaN,t.bc=null,t.Nc=function(){return this.version},t.oc=function(){return this.ic},t.nc=function(){return this.bc},k(Zr,Xr),Zr.prototype.toString=function(){return this.name+":"+(this.error?this.error:"")},Zr.prototype.name="ErrorEvent",Zr.prototype.error=null,Zr.prototype.c=function(){return this.error},k(ti,Zr),ti.prototype.name="FailEvent",k(ei,Xr),ei.prototype.name="RecordEvent",ei.prototype.c=function(){return this.key},ei.prototype.f=function(){return this.value},k(ni,Xr),ni.prototype.name="StoreEvent",ni.prototype.na=function(){return this.keys},ni.prototype.cb=function(){return this.values},Gr=!1;var ri=$;ri&&(-1!=ri.indexOf("Firefox")||-1!=ri.indexOf("Camino")||-1!=ri.indexOf("iPad")||-1!=ri.indexOf("iPhone")||-1!=ri.indexOf("iPod")||-1!=ri.indexOf("Chrome")||-1!=ri.indexOf("Android")||-1!=ri.indexOf("Safari")&&(Gr=!0));var ii=Gr;function oi(t,e,r,i,u,l){if(n(u)||(u=o(t)?t.join(", "):t),null!=t&&!a(t)&&!s(t))throw new on("index keyPath for "+u+" must be a string or array, but "+t+" is "+typeof t);if(o(t)&&Object.freeze&&Object.freeze(t),!n(t)&&n(u)&&(t=u),this.keyPath=t,this.h=s(this.keyPath),this.b=u,this.type=fi(e),n(e)){if(!n(this.type))throw new on("type invalid in index: "+this.b);if(o(this.keyPath))throw new on('composite key for store "'+this.b+'" must not specified type')}this.unique=!!r,this.multiEntry=!!i,this.i=a(this.type)?this.type:ui,this.f=a(u)?u:o(t)?this.keyPath.join(","):t,this.c=F(this.f),this.a=this.h?null:this.keyPath.split("."),this.g=l||null}function si(t,e){if(null!=e){if(s(t.keyPath)){for(var n=[],r=0,i=t.keyPath.length;r<i;r++){var o=In(e,t.keyPath[r]);n[r]=o}return n}return In(e,t.keyPath)}}function ai(t,e,n){for(var r=0;r<t.a.length;r++)r==t.a.length-1?e[t.a[r]]=n:c(e[t.a[r]])||(e[t.a[r]]={})}var ui="TEXT";function li(t,e){return"DATE"!=e?null!=e?t:Pn(t):t instanceof Date?+t:void 0}function hi(t,e){return"DATE"==e?new Date(t):n(e)?t:Cn(t)}var ci=["BLOB","DATE","INTEGER","NUMERIC",ui];function fi(t){if(a(t))return t=H(ci,t),ci[t]}function pi(t,e){return null!=t||null!=e?null!=t?null!=e?s(t)&&s(e)?tt(t,e)?null:"expect: "+t+", but: "+e:Xi(t,e)?null:"expect: "+t+", but: "+e:"keyPath: "+t+" no longer defined":"newly define "+e:null}function gi(t,e,r,i,l,h,c,f){if(!a(t))throw new on("store name must be a string");if(this.c=t,this.keyPath=n(e)?e:null,this.i=s(this.keyPath),null!==this.keyPath&&!a(this.keyPath)&&!this.i)throw new on("keyPath must be a string or array");if(null!=r&&!u(r))throw new on('invalid autoIncrement value in store "'+t+'"');var p;if(this.b=!!r,null!=i){if(!n(p=fi(i)))throw new on('type "'+i+'" for primary key in store "'+this.c+'" is invalid.');if(this.i)throw new on('composite key for store "'+this.c+'" must not specified type')}for(this.type=null!=p?p:this.b?"INTEGER":void 0,this.h=a(this.keyPath)?this.keyPath.split("."):[],this.a=l||[],t=[],e=0;e<this.a.length;e++){if(r=this.a[e].getName(),0<=t.indexOf(r))throw new on('index "'+r+'" already defined in store: '+this.c);t.push(r)}if(this.aa=!!h,this.sa=!!c,this.u=a(this.type)?this.type:ui,this.g=o(this.keyPath)?this.keyPath.join(","):a(this.keyPath)?this.keyPath:"_ROWID_",this.f=F(this.g),this.m=!!f){if(this.keyPath)throw new on('encrypted store "'+this.c+'" must not use inline key');if(this.b)throw new on('encrypted store "'+this.c+'" must not use key generator')}this.j=[]}function di(t){var e,r="name keyPath autoIncrement type indexes dispatchEvents fixed Sync encrypted".split(" ");for(e in t)if(t.hasOwnProperty(e)&&-1==H(r,e))throw new on('Unknown attribute "'+e+'"');if(r=[],o(e=t.indexes||[]))for(var i=0;i<e.length;i++){var s;s=e[i];var a="name unique type keyPath multiEntry generator".split(" "),u=void 0;for(u in s)if(s.hasOwnProperty(u)&&-1==H(a,u))throw new on("Unknown field: "+u+" in "+Ri(s));n((s=new oi(s.keyPath,s.type,s.unique,s.multiEntry,s.name,s.generator)).keyPath)&&s.keyPath===t.keyPath||r.push(s)}return new gi(t.name,t.keyPath,t.autoIncrement,"undefined"===t.type||"null"===t.type?void 0:t.type,r,t.dispatchEvents,t.fixed,t.encrypted)}function vi(t,e,n,r,i,o,s){return t=yi(t,e,n,r,i,o,s),e="",0!=n&&(e+="SELECT "+t.select),e+=" FROM "+t.V,t.v&&(e+=" WHERE "+t.v),t.group&&(e+=" GROUP BY "+t.group),t.X&&(e+=" ORDER BY "+t.X),e}function yi(t,e,n,r,i,o,s){var u={select:"",V:"",v:"",group:"",X:""},l=t.g,h=t.f,c=null;r!==l&&a(r)&&(c=wi(t,r));var f=!!c,p=r||l,g=F(p),d=f?c.type:t.type,v=f&&c.multiEntry;return u.V=Ei(t),6===n?u.select="COUNT("+h+")":3===n||1===n||2===n?(u.select=h,null!=r&&r!=l&&(u.select+=", "+g)):u.select="*",r=s?"DISTINCT ":"",l=[],v?(v=F("ydn.db.me:"+t.getName()+":"+c.getName()),u.select=6===n?"COUNT("+r+v+"."+g+")":3===n||1===n||2===n?"DISTINCT "+Ei(t)+"."+h+", "+v+"."+g+" AS "+p:"DISTINCT "+Ei(t)+".*, "+v+"."+g+" AS "+p,u.V=v+" INNER JOIN "+Ei(t)+" USING ("+h+")",null!=i&&(xn(v+"."+g,d,i,l,e),0<l.length&&(u.v=u.v?u.v+" AND "+l.join(" AND "):l.join(" AND ")))):null!=i&&(xn(g,d,i,l,e),0<l.length&&(u.v=u.v?u.v+" AND "+l.join(" AND "):l.join(" AND "))),f&&!c.unique&&s&&(u.group=g),t=o?"DESC":"ASC",u.X=g+" "+t,f&&(u.X+=", "+h+" "+t),u}function bi(t,e,n,r,i,o,s,a,u){var l,h,c,f;return null!=i?(l=i.lower,h=i.upper,c=i.lowerOpen,f=i.upperOpen,o?null!=h?-1==(i=cr(a,h))?(h=a,f=u):0==i&&(f=u||f):(h=a,f=u):null!=l?1==(i=cr(a,l))?(l=a,c=u):0==i&&(c=u||c):(l=a,c=u)):o?(h=a,f=u):(l=a,c=u),i=new pn(l,h,!!c,!!f),e="SELECT "+(e=yi(t,n,e,(r=r?wi(t,r):null)?r.f:t.g,i,o,s)).select+" FROM "+e.V+(e.v?" WHERE "+e.v:"")+(e.group?" GROUP BY "+e.group:"")+" ORDER BY "+e.X,r&&(e+=", "+t.f+(o?"DESC":"ASC")),e}function mi(t,e,n,r,i,o,s,a,u,l){var h=wi(t,r),c=h.f;r=h.c;var f=t.f,p=u?" <":" >";return p=s?p+" ":p+"= ",s=li(o,h.type),a=li(a,t.type),h="",i?((t=yi(t,n,e,c,i,u,l)).v+=" AND ",h=r+p+"?",n.push(s)):(h=(t=yi(t,n,e,c,i=u?yn(o,!0):bn(o,!0),u,l)).v,t.v=""),t.v+="("+h+" OR ("+r+" = ? AND "+f+p+"?))",n.push(s),n.push(a),"SELECT "+t.select+" FROM "+t.V+" WHERE "+t.v+(t.group?" GROUP BY "+t.group:"")+" ORDER BY "+t.X}function wi(t,e){return Y(t.a,(function(t){return t.getName()==e}))}function ki(t,e){for(var n=0;n<t.a.length;n++)if(!pi(t.a[n].keyPath,e))return t.a[n];return null}function Si(t,e){return e===t.keyPath||J(t.a,(function(t){return t.getName()==e}))}function Ei(t){return F(t.c)}function xi(t,e){if(!e)return t;var r=t.b,i=o(t.keyPath)?Z(t.keyPath):t.keyPath,s=t.type,u=G(t.a,(function(t){return t.clone()}));n(e.type)||"TEXT"!=s||(s=void 0),o(e.keyPath)&&a(i)&&i==e.keyPath.join(",")&&(i=Z(e.keyPath));for(var l=0,h=e.a.length;l<h;l++)if(e.a[l].h)for(var c=e.a[l].getName(),f=u.length-1;0<=f;f--)if(0<=c.indexOf(u[f].getName())){u[f]=e.a[l].clone();break}for(l=0;l<u.length;l++)(h=wi(e,u[l].getName()))&&(u[l]=u[l].hint(h));return new gi(e.c,i,r,s,u)}function Ni(t,e,n){if(e){if(!t.keyPath&&null!=n)return n;if(t.i){n=[];for(var r=0;r<t.keyPath.length;r++)n.push(In(e,t.keyPath[r]));return n}if(t.keyPath)return ot(e,t.h)}}function Oi(t,e,r){for(var i=0;i<t.h.length;i++){var o=t.h[i];if(i==t.h.length-1){e[o]=r;break}n(e[o])||(e[o]={}),e=e[o]}}function Ii(t,e,r){var i=[],o=[];r=n(r)?r:Ni(t,e),n(r)&&(o.push(t.f),i.push(li(r,t.type)));for(var s=0;s<t.a.length;s++){var u=t.a[s];if(!u.multiEntry&&u.getName()!==t.keyPath&&"_default_"!=u.getName()){var l=si(u,e);null!=l&&(i.push(li(l,u.type)),o.push(u.c))}}for(t.sa?t.sa&&!t.keyPath&&0==t.a.length&&(a(e)&&-1==e.indexOf(";base64,")?i.push(e):i.push(Ri(e)),o.push("_default_")):(i.push(Ri(e)),o.push("_default_")),t=[],s=i.length-1;0<=s;s--)t[s]="?";return{Vb:o,fc:t,values:i,key:r}}function qi(t,e){if(!e)return"missing store: "+t.c;if(t.c!=e.c)return"store name, expect: "+t.c+", but: "+e.c;var r=pi(t.keyPath,e.keyPath);if(r)return"keyPath, "+r;if(n(t.b)&&n(e.b)&&t.b!=e.b)return"autoIncrement, expect:  "+t.b+", but: "+e.b;if(t.a.length!=e.a.length)return"indexes length, expect:  "+t.a.length+", but: "+e.a.length;if(n(t.type)&&n(e.type)&&(s(t.type)?!tt(t.type,e.type):t.type!=e.type))return"data type, expect:  "+t.type+", but: "+e.type;for(r=0;r<t.a.length;r++){var i,o=wi(e,t.a[r].getName());if(i=t.a[r],o)if(i.b!=o.b)i="name, expect: "+i.b+", but: "+o.b;else{var a=pi(i.keyPath,o.keyPath);i=a?"keyPath, "+a:null!=i.unique&&null!=o.unique&&i.unique!=o.unique?"unique, expect: "+i.unique+", but: "+o.unique:null!=i.multiEntry&&null!=o.multiEntry&&i.multiEntry!=o.multiEntry?"multiEntry, expect: "+i.multiEntry+", but: "+o.multiEntry:n(i.type)&&n(o.type)&&(s(i.type)?!tt(i.type,o.type):i.type!=o.type)?"data type, expect: "+i.type+", but: "+o.type:""}else i="no index for "+i.b;if(0<i.length)return'index "'+t.a[r].getName()+'" '+i}return""}function Ti(t,e){if(e)for(var n=0;n<t.a.length;n++){var r=t.a[n],i=e;if(r.g){var s=r.g(i),a=typeof s;if("string"==a||"number"==a||s instanceof Date||o(s)){for(a=0;a<r.a.length-1;a++)c(i[r.a[a]])||(i[r.a[a]]={});i[r.a[r.a.length-1]]=s}}}}function Pi(t,e,n,r,i){for(var o=0;o<t.j.length;o++)r!==o&&t.j[o].call(i,e,n)}function Ci(t){return!a(t)||O(t)?{}:JSON.parse(t)}function ji(t){var e;try{e=Ri(t)}catch(t){e=""}return e?e.substr(0,70)+(70<e.length?"...":""):""}function Ri(t){return JSON.stringify(t,void 0,void 0)}function Ai(t,e){if(!t||O(t))throw new on("store_name must be provided for primary full text index");if(!e||O(e))throw new on("index_name must be provided for primary full text index");this.s=t}function Di(t,e,n){if(this.name=t,this.a=e,this.b=n||"",-1==["","en","fr"].indexOf(this.b))throw new on('Unsupported lang "'+n+" for full text search index "+t)}function Bi(t){var e,n=["name","sources","lang"];for(e in t)if(t.hasOwnProperty(e)&&-1==H(n,e))throw new on("Unknown field: "+e+" in "+Ri(t));if(!o(t.sources))throw new on("indexes require for full text search index "+t.name+", but "+t.sources+" of type "+typeof t.sources+" found.");return n=t.sources.map((function(t){var e,n=["storeName","keyPath","weight"];for(e in t)if(t.hasOwnProperty(e)&&-1==H(n,e))throw new on("Unknown field: "+e+" in "+ji(t));return new Ai(t.storeName,t.keyPath)})),new Di(t.name,n,t.lang)}function Li(t,e){var r,i,s=e;if(c(t)){for(var u in r=["version","stores","fullTextCatalogs"],i=t)if(i.hasOwnProperty(u)&&-1==H(r,u))throw new on("Unknown field: "+u+" in schema.");r=i.version,s=[];var h=i.stores||[];if(!o(h))throw new on("stores must be array");for(u=0;u<h.length;u++){var f=di(h[u]);if(-1!=z(s,(function(t){return t.name==f.getName()})))throw new on('duplicate store name "'+f.getName()+'".');s.push(f)}}else a(t)?r=0==t.length?void 0:parseFloat(t):l(t)&&(r=t);if(n(r)){if(!l(r)||0>r)throw new on("Invalid version: "+r+" ("+t+")");isNaN(r)&&(r=void 0)}if(n(e)&&(!o(e)||0<e.length&&!(e[0]instanceof gi)))throw new on("stores");if(this.version=r,this.b=!n(this.version),this.stores=s||[],r=[],i&&i.fullTextCatalogs)for(u=0;u<i.fullTextCatalogs.length;u++)s=Bi(i.fullTextCatalogs[u]),r[u]=s,Fi(this,s.getName())||(h=[new oi("k",ui),new oi("v",ui)],s=new gi(s.getName(),"id",!1,void 0,h,!1,!1,!1),this.stores.push(s));this.c=r}function Mi(t){return G(t.stores,(function(t){return t.getName()}))}function Fi(t,e){return Y(t.stores,(function(t){return t.getName()==e}))}function _i(t,e){return J(t.stores,(function(t){return t.getName()==e}))}function Ui(t,e,n,r){if(!e||t.stores.length!=e.stores.length)return"Number of store: "+t.stores.length+" vs "+e.stores.length;for(var i=0;i<t.stores.length;i++){var o=Fi(e,t.stores[i].getName());if(!o)return'missing object store "'+t.stores[i].getName()+'"';if(n&&(o=xi(o,t.stores[i])),r)for(var s=o,a=t.stores[i],u=0;u<a.a.length;u++){var l=a.a[u];Si(s,l.getName())||"BLOB"!=l.type||(l=new oi(l.keyPath,l.type,l.unique,l.multiEntry,l.getName()),s.a.push(l))}if(0<(o=qi(t.stores[i],o)).length)return'store: "'+t.stores[i].getName()+'" '+o}return""}function Ki(t,e){Li.call(this,t,e)}function $i(t,e){t.stores.push(e)}function Wi(t){Error.captureStackTrace?Error.captureStackTrace(this,Wi):this.stack=Error().stack||"",t&&(this.message=String(t)),this.name="ydn.error.ArgumentException"}function Hi(t){Error.captureStackTrace?Error.captureStackTrace(this,Hi):this.stack=Error().stack||"",t&&(this.message=String(t)),this.name="ydn.error.NotSupportedException"}function Vi(t){Error.captureStackTrace?Error.captureStackTrace(this,Vi):this.stack=Error().stack||"",t&&(this.message=String(t)),this.name="ydn.error.NotImplementedException"}function Gi(t){Error.captureStackTrace?Error.captureStackTrace(this,Gi):this.stack=Error().stack||"",t&&(this.message=String(t)),this.name="ydn.error.InternalError"}function Ji(t){Error.captureStackTrace?Error.captureStackTrace(this,Ji):this.stack=Error().stack||"",t&&(this.message=String(t)),this.name="ydn.error.ConstraintError"}function Yi(t){Error.captureStackTrace?Error.captureStackTrace(this,Yi):this.stack=Error().stack||"",t&&(this.message=String(t)),this.name="ydn.error.InvalidOperationException"}function zi(t){Error.captureStackTrace?Error.captureStackTrace(this,zi):this.stack=Error().stack||"",t&&(this.message=String(t)),this.name="ydn.error.InvalidOperationError"}function Xi(t,e){var n;if(n=n||{},null!=t&&null!=e){if(s(t)&&s(e)){if(t.length!=e.length)return!1;for(var r=0;r<t.length;r++)if(-1==z(e,(function(e){return Xi(e,t[r])})))return!1;return!0}if(s(t))return 1==t.length&&Xi(t[0],e);if(s(e))return 1==e.length&&Xi(e[0],t);if(c(t)&&c(t)){for(var i in t)if(t.hasOwnProperty(i)&&!n[i]){var o=Xi(t[i],e[i]);if(!o)return!1}for(i in e)if(e.hasOwnProperty(i)&&!n[i]&&!(o=Xi(t[i],e[i])))return!1;return!0}return t===e}return!1}function Qi(t){if(t)for(var e in t)if(t.hasOwnProperty(e))return t[e]}function Zi(t,e,r){r=r||{};var s,a,u="autoSchema connectionTimeout size mechanisms policy isSerial Encryption".split(" ");for(s in r)if(r.hasOwnProperty(s)&&-1==H(u,s))throw new on('Unknown attribute "'+s+'" in options.');if(r.mechanisms){if(!o(r.mechanisms))throw new on("mechanisms attribute must be an array but "+i(r.mechanisms)+" found.");for(s=0;s<r.mechanisms.length;s++)if(!(0<=H(to,r.mechanisms[s])))throw new on('Invalid mechanism "'+r.mechanisms[s]+'"')}if(this.G=r.mechanisms||(ii?function(t,e,n){return 2>=arguments.length?W.slice.call(t,e):W.slice.call(t,e,n)}(to,1):to),this.j=r.size,this.K=n(r.connectionTimeout)?r.connectionTimeout:3e3,this.b=null,this.f=[],this.hb=!1,e instanceof Li)a=e;else if(c(e))for(a=r.autoSchema||!n(e.stores)?new Ki(e):new Li(e),r=e.stores?e.stores.length:0,s=0;s<r;s++)u=Fi(a,e.stores[s].name),e.stores[s].Sync&&tn(this.logger,"Synchronization option for "+u.getName()+" ignored.");else a=new Ki;for(this.a=a,s=0;s<this.a.count();s++)if((this.a.stores[s]||null).m)throw Error("encryption option must be defined");n(t)&&this.C(t),this.h=null,this.g=new Nt}(t=oi.prototype).getName=function(){return this.b},t.toJSON=function(){return{name:this.b,keyPath:this.keyPath,type:this.type,unique:this.unique,multiEntry:this.multiEntry}},t.clone=function(){return new oi(o(this.keyPath)?Z(this.keyPath):this.keyPath,this.type,this.unique,this.multiEntry,this.b,this.g)},t.hint=function(t){if(!t)return this;var e=o(this.keyPath)?Z(this.keyPath):this.keyPath,r=this.type;return n(t.type)||"TEXT"!=r||(r=void 0),new oi(e,r,this.unique,this.multiEntry,t.b)},t.toString=function(){var t=this.multiEntry?"MultiEntry":"";return this.a&&1<this.a.length&&(t+="Compound"),t+"Index:"+this.b},(t=gi.prototype).aa=!1,t.sa=!1,t.toJSON=function(){for(var t=[],e=0;e<this.a.length;e++)t.push(this.a[e].toJSON());return{name:this.c,keyPath:this.keyPath,autoIncrement:this.b,type:this.type,indexes:t}},t.clone=function(){return di(this.toJSON())},t.index=function(t){return this.a[t]||null},t.getName=function(){return this.c},t.toString=function(){return"Store:"+this.c+"["+this.a.length+"index]"},Di.prototype.getName=function(){return this.name},Di.prototype.count=function(){return this.a.length},Di.prototype.index=function(t){return this.a[t]},Li.prototype.toJSON=function(){var t=G(this.stores,(function(t){return t.toJSON()})),e={};return e.stores=t,n(this.version)&&(e.version=this.version),e},Li.prototype.b=!1,Li.prototype.a=function(){return!1},Li.prototype.count=function(){return this.stores.length},k(Ki,Li),Ki.prototype.a=function(){return!0},k(Wi,Error),k(Wi,Error),Hi.prototype.name="ydn.error.NotSupportedException",k(Vi,Error),k(Gi,Error),Gi.prototype.name="ydn.InternalError",k(Ji,Error),Ji.prototype.name="ydn.error.ConstraintError",k(Wi,Error),k(zi,Error),Zi.prototype.logger=Xe("ydn.db.con.Storage"),Zi.prototype.N=function(t){if(n(t)){var e=function(e){t(e.toJSON()),t=void 0};if(this.b)this.b.S(e);else{var r=this;this.transaction((function(t){r.b.S(e,t)}),null,Fn)}}return this.a?this.a.toJSON():null},Zi.prototype.C=function(t){if(this.b)throw new ln("Already connected with "+this.i);this.i=t,eo(this)},Zi.prototype.getName=function(){return this.i};var to="indexeddb sqlite websql localstorage sessionstorage userdata memory".split(" ");function eo(t){function e(e,i){e?(nn(t.logger,t+": ready."),t.Zb=NaN,r.Ra=function(e){t.J(new Zr(t,e))},r.qb=function(e){t.J(new ti(t,e)),t.b=null},r.jb=function(e){t.J(e)},setTimeout((function(){no(t,i),io(t)}),10),n.callback(i)):(tn(t.logger,t+": database connection fail "+i.name),setTimeout((function(){if(no(t,new ti(t,i)),t.f){var e=t.logger;for(e&&e.log(Fe,"Purging "+t.f.length+" transactions request.",void 0);e=t.f.shift();)e.L&&e.L("error",i)}}),10),n.o(i))}for(var n=new Nt,r=null,i=t.G,o=0;o<i.length;o++){var s=i[o].toLowerCase();if(r=t.xb(s)){r=t.xb(s);break}}null===r?(i=new Ji("No storage mechanism found."),e(!1,new ti(t,i))):qt(r.connect(t.i,t.a),(function(t){this.b=r,e(!0,new Qr("ready",this,parseFloat(r.ob()),parseFloat(t),null))}),(function(t){tn(this.logger,this+": opening fail"),e(!1,t)}),t)}function no(t,e){setTimeout((function(){t.a.b&&t.g.c||(e instanceof Zr?t.g.o(e.error):t.g.callback(),t.J(e))}),4)}function ro(t){return!!t.b&&t.b.pb()}function io(t){var e=t.f.shift();e&&(nn(t.logger,"pop tx queue["+(t.f.length+1)+"]"),t.transaction(e.ab,e.uc,e.mode,e.L)),t.Zb=m()}function oo(t,e,n,r){this.f=t,this.g=e,this.a=Z(n),this.b=r,this.c=[]}function so(t,e,n){if(!t.f)throw new hn("tx committed on ParallelTxExecutor");n&&t.c.push(n),e(t.f)}function ao(t,e,n,r,i,o){Rr.call(this,t,e,n,r,i,o),this.c=this.b=null}function uo(t,e){ao.call(this,t,e,Ar)}function lo(t,e,r){Zi.call(this,t,e,r),this.wa=0,t=!0,e=Ar,r&&(n(r.isSerial)&&(t=!!r.isSerial),r.policy&&(e=r.policy)),r=ho(this,e,t),this.m=ho(this,"atomic",!1),this.c=this.va(r,this.m)}function ho(t,e,n,r,i,o){if(n){if("multi"==e||"repeat"==e||"all"==e||e==Ar)return new Br(t,t.wa++,e,r,i,o);if("atomic"==e)return new Fr(t,t.wa++);throw new on('Invalid requestType "'+e+'"')}if("multi"==e||"repeat"==e||"all"==e||e==Ar)return new ao(t,t.wa++,e,r,i,o);if("atomic"==e)return new uo(t,t.wa++);throw new on('Invalid requestType "'+e+'"')}function co(t,e,n){for(lo.call(this,t,e,n),t=this.a,e=0;e<t.c.length;e++){var r=Fi(t,(n=t.c[e]).getName());if(!r)throw new on('full text index store "'+n.getName()+'" required.');if(!Si(r,"k"))throw new on('full text index store "'+r.getName()+'" must have "keyword" index');if(!Si(r,"v"))throw new on('full text index store "'+r.getName()+'" must have "keyword" index');if("id"!=r.keyPath)throw new on('full text index store "'+r.getName()+'" must use "id" as key path.');for(r=0;r<n.count();r++){var i=n.index(r),o=Fi(t,i.s);if(!o)throw new on('full text source store "'+i.s+'" does not exist for full text index "'+n.getName()+'"');tn(this.logger,"Full text indexer option for "+o.getName()+" ignored.")}}}function fo(t,e,n){co.call(this,t,e,n)}function po(t,e,n,r){Vn.call(this,t,e,n,r),this.h=null}function go(t,e){this.a=e}function vo(t,e){this.a=e}function yo(){this.a=!1}function bo(t,e,n,r){Vn.call(this,t,e,n,r),this.j=this.c=this.a=void 0,this.i=this.h=null,this.m=new yo,this.nb=this.la=null}function mo(t){setTimeout((function(){t.m.state()?(t.m.a=!1,t.W(t.a,t.c,t.j),mo(t)):(t.i(),t.i=null)}),4)}function wo(t,e){if(t.h=e){var n=e.value;if(t.w)if(t.reverse||null==t.w.upper)t.reverse&&null!=t.w.lower&&(-1==(r=cr(n.key,t.w.lower))||0==r&&t.w.lowerOpen)&&(t.h=null);else{var r=cr(n.key,t.w.upper);(1==r||0==r&&t.w.upperOpen)&&(t.h=null)}if(t.h){if(t.unique&&null!=t.a&&null!=n.key&&0==cr(t.a,n.key))return;t.a=n.key,t.c=t.g?n.a:t.a,4==t.u&&(t.Ia?t.j=t.c:t.j=Ho(t.nb,t.c))}}return t.h||(t.a=void 0,t.c=void 0,t.j=void 0),t.m.a=!0}function ko(t,e,r){return t=["ydn.db",t],n(e)&&(t.push(e),n(r)&&(t.push(r),n(void 0)&&t.push(Pn(void 0)))),t.join("^|")}function So(t,e){this.key=t,this.a=e}function Eo(t,e){var n=cr(t.key,e.key);return 0===n?null!=t.a?null!=e.a?cr(t.a,e.a):1:null!=e.a?-1:0:n}function xo(t){this.U=t||No}function No(t,e){return String(t)<String(e)?-1:String(t)>String(e)?1:0}function Oo(t,e){Io(t,(function(t){var n=null,r=this.U(t.value,e);return 0<r?n=t.left:0>r?n=t.right:function(t,e){if(null!=e.left||null!=e.right){var n,r=null;null!=e.left?(Io(t,(function(t){return t.count--,t.parent}),n=jo(t,e.left)),n!=e.left&&((n.parent.right=n.left)&&(n.left.parent=n.parent),n.left=e.left,n.left.parent=n,r=n.parent),n.parent=e.parent,n.right=e.right,n.right&&(n.right.parent=n),e==t.ba&&(t.ba=n)):(Io(t,(function(t){return t.count--,t.parent}),n=Co(t,e.right)),n!=e.right&&((n.parent.left=n.right)&&(n.right.parent=n.parent),n.right=e.right,n.right.parent=n,r=n.parent),n.parent=e.parent,n.left=e.left,n.left&&(n.left.parent=n),e==t.ca&&(t.ca=n)),n.count=e.count,Do(e)?e.parent.left=n:Ao(e)?e.parent.right=n:t.D=n,qo(t,r||n)}else Io(t,(function(t){return t.count--,t.parent}),e.parent),Do(e)?(e.parent.left=null,e==t.ca&&(t.ca=e.parent),qo(t,e.parent)):Ao(e)?(e.parent.right=null,e==t.ba&&(t.ba=e.parent),qo(t,e.parent)):t.clear()}(this,t),n}))}function Io(t,e,n){for(n=n||t.D;n&&null!=n;)n=e.call(t,n)}function qo(t,e){Io(t,(function(t){var e=t.left?t.left.height:0,n=t.right?t.right.height:0;return 1<e-n?(t.left.right&&(!t.left.left||t.left.left.height<t.left.right.height)&&To(this,t.left),Po(this,t)):1<n-e&&(t.right.left&&(!t.right.right||t.right.right.height<t.right.left.height)&&Po(this,t.right),To(this,t)),e=t.left?t.left.height:0,n=t.right?t.right.height:0,t.height=Math.max(e,n)+1,t.parent}),e)}function To(t,e){Do(e)?(e.parent.left=e.right,e.right.parent=e.parent):Ao(e)?(e.parent.right=e.right,e.right.parent=e.parent):(t.D=e.right,t.D.parent=null);var n=e.right;e.right=e.right.left,null!=e.right&&(e.right.parent=e),n.left=e,e.parent=n,n.count=e.count,e.count-=(n.right?n.right.count:0)+1}function Po(t,e){Do(e)?(e.parent.left=e.left,e.left.parent=e.parent):Ao(e)?(e.parent.right=e.left,e.left.parent=e.parent):(t.D=e.left,t.D.parent=null);var n=e.left;e.left=e.left.right,null!=e.left&&(e.left.parent=e),n.right=e,e.parent=n,n.count=e.count,e.count-=(n.left?n.left.count:0)+1}function Co(t,e){if(!e)return t.ca;var n=e;return Io(t,(function(t){var e=null;return t.left&&(e=n=t.left),e}),e),n}function jo(t,e){if(!e)return t.ba;var n=e;return Io(t,(function(t){var e=null;return t.right&&(e=n=t.right),e}),e),n}function Ro(t,e){this.value=t,this.parent=e||null,this.count=1}function Ao(t){return!!t.parent&&t.parent.right==t}function Do(t){return!!t.parent&&t.parent.left==t}function Bo(t){this.U=t||No}function Lo(t,e,n){if(t.D){var r;if(n instanceof Ro)r=n;else if(n){if(Io(t,(function(t){var e=null;return 0<this.U(t.value,n)?(e=t.left,r=t):0>this.U(t.value,n)?e=t.right:r=t,e})),!r)return}else r=Co(t);t=r;for(var i=r.left?r.left:r;null!=t;)if(null!=t.left&&t.left!=i&&t.right!=i)t=t.left;else{if(t.right!=i&&e(t))return;var o=t;t=null!=t.right&&t.right!=i?t.right:t.parent,i=o}e(null)}}function Mo(t,e,n){if(t.D){var r;if(n instanceof Ro)r=n;else if(n){if(Io(t,v((function(t){var e=null;return 0<this.U(t.value,n)?e=t.left:(0>this.U(t.value,n)&&(e=t.right),r=t),e}),t)),!r)return}else r=jo(t);t=r;for(var i=r.right?r.right:r;null!=t;)if(null!=t.right&&t.right!=i&&t.left!=i)t=t.right;else{if(t.left!=i&&e(t))return;var o=t;t=null!=t.left&&t.left!=i?t.left:t.parent,i=o}e(null)}}function Fo(t,e,n){this.g=t,this.storage=e,this.b=n,this.a={},t=this.b.keyPath,this.c=o(t)?t.join(","):t||"_ROWID_",this.a[this.c]=null,this.f=ko(this.g,this.b.getName(),this.c)+"^|"}function _o(t,e){var n=e||t.c;if(!t.a[n]){t.a[n]=new Bo(Eo);for(var r=t.storage.length,i=0;i<r;i++){var s=t.storage.key(i);if(null!==s&&0==s.lastIndexOf(t.f,0)){var a=Cn(s.substr(t.f.length));if(n==t.c)t.a[n].add(new So(a));else{var u=t.storage.getItem(s);if(null!==u)if(u=si(s=wi(t.b,n),u=Ci(u)),s.multiEntry){if(o(u))for(s=0;s<u.length;s++)t.a[n].add(new So(u[s],a))}else t.a[n].add(new So(u,a))}}}}return t.a[n]}function Uo(t,e,n){for(var r in t.a){var i=t.a[r];i&&(r==t.c?Oo(i,new So(e)):Oo(i,new So(e,In(n,wi(t.b,r).keyPath))))}}function Ko(t){for(var e in t.a){var n=t.a[e];n&&n.clear()}t.a={}}function $o(t,e,n,r){if(null==e&&(t.b.keyPath&&(e=Ni(t.b,n)),t.b.b&&null==e)){e=t.f+Pn(void 0);var i=Ci(t.storage.getItem(e));i.key_count||(i.key_count=0),i.key_count++,t.storage.setItem(e,Ri(i)),e=i.key_count}if(r&&(r=null!==t.storage.getItem(t.f+Pn(e))),r)return null;for(var o in t.storage.setItem(t.f+Pn(e),Ri(n)),r=e,t.a)if(i=t.a[o])if(o==t.c)i.add(new So(r));else{var s;null!=(s=In(n,(s=wi(t.b,o)).keyPath))&&i.add(new So(r,s))}return e}function Wo(t,e){var n=t.f+Pn(e),r=t.storage.getItem(n);return null===r?0:(t.storage.removeItem(n),Uo(t,e,n=Ci(r)),1)}function Ho(t,e){var n=void 0;if(null!==(r=t.storage.getItem(t.f+Pn(e)))){n=Ci(r);for(var r=0,i=t.b.a.length;r<i;r++){var o=t.b.index(r);if("DATE"==o.type){var s=si(o,n);s&&ai(o,n,new Date(s))}}}return n}function Vo(t,e,n){t=_o(t,e=e||t.c);var r=null,i=null,o=0,s=!1,a=!1;return null!=n&&(null!=n.lower&&(r=new So(n.lower)),null!=n.upper&&(i=new So(n.upper)),s=n.lowerOpen,a=n.upperOpen),Lo(t,(function(t){if(null!=t&&(t=t.value,!s||null==r||0!=cr(t.key,r.key))){if(null!=i&&(1===(t=cr(t.key,i.key))||0===t&&a))return!0;o++}}),r),o}function Go(t,e){var n=_o(t,t.c),r=null,i=null,o=0,s=[],a=[],u=!1,l=!1;if(null!=e&&(null!=e.lower&&(r=new So(e.lower)),null!=e.upper&&(i=new So(e.upper)),u=e.lowerOpen,l=e.upperOpen),Lo(n,(function(e){if(null!=e&&(e=e.value,!u||null==r||0!=Eo(e,r))){if(null!=i&&(1===(n=Eo(e,i))||0===n&&l))return!0;var n=t.f+Pn(e.key),h=t.storage.getItem(n);null!==h&&(t.storage.removeItem(n),o++,10>s.length&&(s.push(e.key),a.push(Ci(h))))}}),r),10>s.length)for(n=0;n<s.length;n++)Uo(t,s[n],a[n]);else Ko(t);return o}function Jo(t,e,r,i,o,s,a,u,l){function h(r){if(r&&!(++y<a)){var i=r.value;if(o){if(m&&null!=v&&0==(r=p?Eo(i,v):cr(i.key,v.key)))return;if(null!=d&&(-1==(r=p?Eo(i,d):cr(i.key,d.key))||0==r&&b))return l&&(l[0]=void 0,l[1]=void 0),!0}else{if(b&&null!=d&&0==(r=p?Eo(i,d):cr(i.key,d.key)))return;if(null!=v&&(1==(r=p?Eo(i,v):cr(i.key,v.key))||0==r&&m))return l&&(l[0]=void 0,l[1]=void 0),!0}if(r=i.key,!u||!g||null==c||0!=cr(c,r)){if(i=g?i.a:r,2==e)f.push(i);else if(1==e)f.push(r);else if(3==e)f.push([r,i]);else if(4==e){var h=Ho(t,i);f.push(h)}else f.push([r,i,Ho(t,i)]);l&&(l[0]=r,l[1]=i)}if(c=r,n(s)&&f.length>=s)return!0}}var c,f=[],p=!!l&&null!=l[0],g=(r=r||t.c)!=t.c;r=_o(t,r);var d=null,v=null;n(a)||(a=0);var y=-1,b=!1,m=!1;if(null!=i&&(null!=i.lower&&(d=g&&o?new So(i.lower,"￿"):new So(i.lower)),null!=i.upper&&(v=g&&!o?new So(i.upper,"￿"):new So(i.upper)),b=!!i.lowerOpen,m=!!i.upperOpen),p){o?m=!0:b=!0,i=l[0];var w=n(l[1])?l[1]:"￿";o?v=g?new So(i,w):new So(i):d=g?new So(i,w):new So(i)}return o?Mo(r,h,v):Lo(r,h,d),f}function Yo(){this.clear()}function zo(t){this.h=t||new Yo,this.g={}}function Xo(t,e){var n=Fi(t.a,e);if(!n)throw new hn('store name "'+e+'" not found.');return t.g[e]||(t.g[e]=new Fo(t.f,t.c,n)),t.g[e]}function Qo(t,e){this.b=t,this.a=e}function Zo(t,e){this.a=e}function ts(t,e,n,r){var i=e.a.l((function(t){for(var o,s=[],a=n,u=0;u<r.length;u++){var l=r[u];l instanceof qr&&(l=(a=l).id,a=a.s),o&&o.getName()==a||(o=Xo(t,a)),l=Ho(o,l),s[u]=l}sr(e,s,!1),i(),i=null}),t)}function es(t,e){this.a=e}function ns(t,e,n,r){Vn.call(this,t,e,n,r),this.K=null,this.h=this.i=void 0}function rs(t,e){if(t.i=void 0,t.h=void 0,t.m=void 0,n(e))if(c(e)){var r=hi(e[t.b.g],t.b.type);if(t.h=r,t.g){var i=wi(t.b,t.O);t.i=hi(e[t.O],i.type)}else t.i=r;t.m=t.Ia?r:ss(e,t.b)}else t.m=e}function is(t,e,n,r,i,o){var s=!r;r=[],t.g&&null!=o&&null!=n?n=mi(t.b,t.u,r,t.K.getName(),t.w,n,s,o,t.reverse,t.unique):null!=n?(o=t.K?t.K.getName():null,n=bi(t.b,t.u,r,o,t.w,t.reverse,t.unique,n,s)):(n=vi(t.b,r,t.u,t.g?t.K.f:t.b.g,t.w,t.reverse,t.unique),t.g&&(n+=", "+t.b.f+" ASC")),n+=" LIMIT 1",0<i&&(n+=" OFFSET "+i),nn(t.logger,t+": continue:  SQL: "+n+" : "+Ri(r)),t.f.executeSql(n,r,(function(n,r){0<r.rows.length?rs(t,r.rows.item(0)):rs(t),e.call(t,t.i,t.h,t.m),e=null}),(function(n,r){return tn(t.logger,"get error: "+r.message),Gn(t,r),rs(t),e.call(t,t.h,t.i,t.m),e=null,!1}))}function os(t,e){this.a=e}function ss(t,e){if(e.sa&&!e.keyPath&&0==e.a.length&&t._default_){if(-1==(i=t._default_).indexOf(";base64,"))return Ci(i);'"'==i.charAt(0)&&'"'==i.charAt(i.length-1)&&(i=i.substr(1,i.length-2));for(var r,i=(r=i.split(";base64,"))[0].split(":")[1],o=(r=window.atob(r[1])).length,s=new Uint8Array(o),a=0;a<o;++a)s[a]=r.charCodeAt(a);return new Blob([s.buffer],{type:i})}for(i=t._default_?Ci(t._default_):{},null!=e.keyPath&&null!=(r=hi(t[e.keyPath],e.type))&&Oi(e,i,r),r=0;r<e.a.length;r++)"_default_"==(s=(o=e.index(r)).f)||o.h||o.multiEntry||"DATE"!=o.type&&!e.sa||n(s=hi(t[s],o.type))&&ai(o,i,s);return i}function as(t,e,r,i,o){function s(n){n="DELETE FROM  "+F(n="ydn.db.me:"+u.getName()+":"+n.getName())+c,nn(t.logger,lr(e)+NaN+n),a.executeSql(n,h)}var a=e.a,u=Fi(t.a,r);r="DELETE FROM "+Ei(u);var l=[],h=[],c="";null!=o&&(n(i)?xn((i=wi(u,i)).c,i.type,o,h,l):xn(u.f,u.type,o,h,l),c=" WHERE "+h.join(" AND ")),r+=c;var f=lr(e)+" SQL: "+r+" PARAMS: "+l;for(nn(t.logger,f),a.executeSql(r,l,(function(n,r){nn(t.logger,"success "+f),sr(e,r.rowsAffected)}),(function(n,r){return tn(t.logger,"error: "+f+r.message),sr(e,r,!0),!1})),o=0,i=u.a.length;o<i;o++)(r=u.index(o)).multiEntry&&s(r)}function us(t,e){this.a=e}function ls(t){if(!a(t))throw new Wi;this.M=t,this.f=_n,this.a=[],hs(this,t),this.Oa=""}function hs(t,e){if(2==(r=e.split(/\sFROM\s/i)).length){var n=r[1];if(3==(r=r[0].match(/\s*?(SELECT|INSERT|UPDATE|DELETE)\s+(.*)/i)).length){if(t.g=r[1].toUpperCase(),"SELECT"==t.g)t.f=Fn;else if("INSERT"==t.g)t.f=_n;else if("UPDATE"==t.g)t.f=_n;else{if("DELETE"!=t.g)return;t.f=_n}var r,i=(r=r[2].trim()).match(/^(MIN|MAX|COUNT|AVG|SUM)/i);i?(t.c=i[0].toUpperCase(),r=r.replace(/^(MIN|MAX|COUNT|AVG|SUM)/i,"").trim()):t.c=void 0,"("==r.charAt(0)&&(")"==r.charAt(r.length-1)?r=r.substring(1,r.length-1):new Or("missing closing parentheses")),t.m=r,0<(r=n.search(/(ORDER BY|LIMIT|OFFSET)/i))?(t.b=n.substring(r),n=n.substring(0,r)):t.b="",0<(r=n.search(/WHERE/i))?(t.h=n.substring(r+6).trim(),n=n.substring(0,r)):t.h="",t.a=n.trim().split(",").map((function(t){return t=B(t,'"'),(t=B(t,"'")).trim()}))}}}function cs(t,e){if(e){for(var n=0;n<e.length;n++)t.M=t.M.replace("?",e[n]);hs(t,t.M)}if(t.i=function(t){function e(t){return z(n,(function(e){return e.ma==t}))}var n=[],r=/(.+?)(<=|>=|=|>|<)(.+)/i;if(0<t.h.length)for(var i=t.h.split("AND"),o=0;o<i.length;o++){var s=i[o],a=r.exec(s);if(!a)return t.Oa='Invalid clause "'+s+'"',null;var u=B(u=a[1].trim(),'"');if(!(0<(u=B(u,"'")).length))return t.Oa='Invalid clause "'+s+'"',null;var l=a[3].trim();if(l=0==l.lastIndexOf('"',0)?B(l,'"'):0==l.lastIndexOf("'",0)?B(l,"'"):parseFloat(l),a=new Mn(u,a[2],l),0<=(u=e(u))){if(n[u]=n[u].ka(a),!n[u])return t.Oa='where clause "'+s+'" conflict',null}else n.push(a)}return n}(t),!t.i)return t.Oa;n=t.b.length;var r=/OFFSET\s+(\d+)/i.exec(t.b);return r&&(t.ac=parseInt(r[1],10),n=t.b.search(/OFFSET/i)),(r=/LIMIT\s+(\d+)/i.exec(t.b))&&(t.$b=parseInt(r[1],10),(r=t.b.search(/LIMIT/i))<n&&(n=r)),(n=/ORDER BY\s+(.+)/i.exec(t.b.substr(0,n)))?((r=(n=n[1].trim()).match(/(ASC|DESC)/i))?(t.Kb="DESC"==r[0].toUpperCase(),n=n.replace(/\s+(ASC|DESC)/i,"")):t.Kb=!1,t.j=B(B(n,'"'),"'")):t.j=void 0,""}function fs(t){return"*"==t.m?null:(t=t.m.split(",")).map((function(t){return B(t.trim(),'"')}))}function ps(t,e){this.a=e,this.c=t}function gs(t,e){ps.call(this,t,e)}function ds(t,e){this.a=e}function vs(t,e){this.b=e,this.f=t,this.a=fs(e)}function ys(t,e){if(t.a){if(1==t.a.length)return c(e)?ot(e,t.a[0]):void 0;for(var n={},r=0;r<t.a.length;r++)n[t.a[r]]=ot(e,t.a[r]);return n}return ss(e,t.f)}function bs(t,e){vs.call(this,t,e)}function ms(t,e){this.a=e}function ws(t,e){this.a=e}function ks(t,e,n){_r.call(this,t,e,n)}function Ss(t,e,n){co.call(this,t,e,n)}function Es(t,e){n(t)&&5242880<t&&Qe(this.logger,Me,"storage size request ignored, use Quota Management API instead"),this.A=null,this.La=e||NaN}function xs(t,e,n,r){function i(){var t={autoIncrement:!!r.b};return null!=r.keyPath&&(t.keyPath=r.keyPath),e.createObjectStore(r.getName(),t)}if(Qe(t.logger,$e,"Creating Object Store for "+r.getName()+" keyPath: "+r.keyPath),e.objectStoreNames.contains(r.getName())){n=n.objectStore(r.getName()),pi(r.keyPath||"",n.keyPath||"")?(e.deleteObjectStore(r.getName()),Qe(t.logger,Me,"store: "+r.getName()+" deleted due to keyPath change."),n=i()):u(n.autoIncrement)&&u(r.b)&&n.autoIncrement!=r.b&&(e.deleteObjectStore(r.getName()),Qe(t.logger,Me,"store: "+r.getName()+" deleted due to autoIncrement change."),n=i());for(var o=n.indexNames,s=0;s<r.a.length;s++){var a=r.index(s);!o.contains(a.getName())&&a.g&&(n.clear(),Qe(t.logger,Me,"store: "+r.getName()+" cleared since generator index need re-indexing."))}var l=0,h=0,c=0;for(s=0;s<r.a.length;s++){a=r.index(s);var f=!1;if(o.contains(a.getName())){var p=null!=(d=n.index(a.getName())).unique&&null!=a.unique&&d.unique!=a.unique,g=null!=d.multiEntry&&null!=a.multiEntry&&d.multiEntry!=a.multiEntry,d=null!=d.keyPath&&null!=a.keyPath&&!!pi(d.keyPath,a.keyPath);(p||g||d)&&(n.deleteIndex(a.getName()),f=!0,l--,c++)}else"BLOB"!=a.type&&(f=!0);f&&(a.unique||a.multiEntry?(f={unique:a.unique,multiEntry:a.multiEntry},n.createIndex(a.getName(),a.keyPath,f)):n.createIndex(a.getName(),a.keyPath),l++)}for(s=0;s<o.length;s++)Si(r,o[s])||(n.deleteIndex(o[s]),h++);Qe(t.logger,$e,"Updated store: "+n.name+", "+l+" index created, "+h+" index deleted, "+c+" modified.")}else{for(n=i(),s=0;s<r.a.length;s++)"BLOB"==(a=r.index(s)).type?Qe(t.logger,Fe,"Index "+a+" of blob data type ignored."):(nn(t.logger,"Creating index: "+a+" for "+r.getName()),a.unique||a.multiEntry?(f={unique:a.unique,multiEntry:a.multiEntry},n.createIndex(a.getName(),a.keyPath,f)):n.createIndex(a.getName(),a.keyPath));rn(t.logger,"Created store: "+n)}}function Ns(t){zo.call(this,t),this.b=NaN}function Os(){Ns.call(this,this)}function Is(){Ns.call(this,this)}function qs(t,e){this.a=n(t)?t:4194304,this.b=e||"websql"}function Ts(t,e,n,r,i){function o(t){e.executeSql(t,[],(function(){++s==a.length&&(r(!0),r=null)}),(function(e,i){throw++s==a.length&&(r(!1),r=null),new xr(i,"SQLError creating table: "+n.getName()+" "+i.message+' for executing "'+t)}))}var s=0,a=function(t){var e=t.u,n="CREATE TABLE IF NOT EXISTS "+Ei(t)+" (",r=t.f;n=n+(r+" ")+e+" PRIMARY KEY ",t.b&&(n+=" AUTOINCREMENT "),t.sa&&(t.keyPath||0!=t.a.length)||(n+=" ,_default_ BLOB");for(var i=[],o=[r],s=0,a=t.a.length;s<a;s++){var u="";if((h=t.index(s)).multiEntry){u="ydn.db.me:"+t.getName()+":"+h.getName();var l=h.unique?" UNIQUE ":"",h="CREATE TABLE IF NOT EXISTS "+F(u)+" ("+r+" "+e+", "+h.c+" "+h.i+l+")";i.push(h)}else h.unique&&(u=" UNIQUE "),l=h.c,-1==o.indexOf(l)&&(n+=", "+l+" "+h.i+u,o.push(l))}return i.unshift(n+")"),i}(n),u="Create";if(i){if(0==(i=qi(n,i)).length)return nn(t.logger,"same table "+n.getName()+" exists."),r(!0),void(r=null);u="Modify",tn(t.logger,"table: "+n.getName()+" has changed by "+i+" ALTER TABLE cannot run in WebSql, dropping old table."),a.unshift("DROP TABLE IF EXISTS "+F(n.getName()))}for(nn(t.logger,u+" table: "+n.getName()+": "+a.join(";")),t=0;t<a.length;t++)o(a[t])}function Ps(t,e){if($n.call(this),this.f=e,this.b=[],t>this.f)throw Error("[goog.structs.SimplePool] Initial cannot be greater than max");for(var n=0;n<t;n++)this.b.push(this.a())}function Cs(){this.a=[],this.c=new ge,this.f=new ge,this.h=1,this.g=new Ps(0,4e3),this.g.a=function(){return new Rs},this.i=new Ps(0,50),this.i.a=function(){return new js};var t=this;this.b=new Ps(0,2e3),this.b.a=function(){return String(t.h++)},this.b.c=function(){}}function js(){this.time=this.count=0}function Rs(){}function As(t,e,n){var r=[];return-1==e?r.push("    "):r.push(Ds(t.b-e)),r.push(" ",Bs(t.b-0)),0==t.a?r.push(" Start        "):1==t.a?(r.push(" Done "),r.push(Ds(t.g-t.startTime)," ms ")):r.push(" Comment      "),r.push(n,t),0<t.f&&r.push("[VarAlloc ",t.f,"] "),r.join("")}function Ds(t){var e="";return 1e3>(t=Math.round(t))&&(e=" "),100>t&&(e="  "),10>t&&(e="   "),e+t}function Bs(t){return t=Math.round(t),String(100+t/1e3%60).substring(1,3)+"."+String(1e3+t%1e3).substring(1,4)}(t=Zi.prototype).xb=function(){return null},t.Ba=function(){if(this.b)return this.b.Aa()},t.ib=function(t,e){this.g.ia().Rb(t,e)},t.close=function(){this.b&&(this.b.close(),this.b=null,nn(this.logger,this+" closed"))},t.Kc=function(){return this.b?this.b.Mb():null},t.Zb=NaN,t.hb=!1,t.transaction=function(t,e,r,i){var o=e;if(a(e))o=[e];else if(null!=e){if(!s(e))throw new on("store names must be an array");if(0==e.length)throw new on("number of store names must more than 0");for(var u=0;u<e.length;u++)if(!a(e[u]))throw new on("store name at "+u+" must be string but found "+typeof e[u])}else o=null;if(this.b&&this.b.pb()&&!this.hb){var l=this,c=n(r)?r:Fn;c==Un&&(this.hb=!0),this.b.$a((function(e){t(e),t=null}),o,c,(function(t,e){h(i)&&(i(t,e),i=void 0),c==Un&&(l.hb=!1),io(l)}))}else!function(t,e,n,r,i){nn(t.logger,"push tx queue["+t.f.length+"]"),t.f.push({ab:e,uc:n,mode:r,L:i}),100<t.f.length&&0==t.f.length%100&&tn(t.logger,"Transaction queue stack size is "+t.f.length+". It is too large, possibility due to incorrect usage.")}(this,t,o,r,i)},t.J=function(){},t.toString=function(){return"Storage:"+this.b},oo.prototype.f=null,oo.prototype.toString=function(){return"ParallelTxExecutor: txNo:"+this.g+" mode:"+this.b+" scopes:"+Ri(this.a)},k(ao,Rr),(t=ao.prototype).logger=Xe("ydn.db.tr.Parallel"),t.abort=function(){rn(this.logger,this+": aborting"),Dr(this.c)},t.jc=function(t,e){var n;if("multi"==this.g)t:if(n=this.b,!n.a||!n.b||e!=n.b&&(n.b!=_n||e!=Fn)||t.length>n.a.length)n=!1;else{for(var r=0;r<t.length;r++)if(-1==n.a.indexOf(t[r])){n=!1;break t}n=!0}else if("repeat"==this.g)t:if(n=this.b,n.a&&n.b&&e==n.b&&n.a.length==t.length){for(r=0;r<t.length;r++)if(-1==n.a.indexOf(t[r])){n=!1;break t}n=!0}else n=!1;else n="all"==this.g;return n},t.pa=function(t,e,r,i){var o;this.G&&(e=this.G),this.C&&(r=this.C);var s,a=n(r)?r:Fn,u=this;if(this.b&&this.b.f&&this.jc(e,a))so(this.b,t,i);else{if(this.j&&this.f>=this.j)throw new ln("Exceed maximum number of transactions of "+this.j);this.l().transaction((function(n){u.f++,s=new oo(n,u.f,e,a),o=u.I(),en(u.logger,o+" BEGIN "+Ri(e)+" "+a),u.b=s,so(u.b,t,i)}),e,a,(function(t,e){if(en(u.logger,o+" "+t),s){for(var n=s,r=0;r<n.c.length;r++)n.c[r](t,e);n.c.length=0,n.f=null,n.a=null,n.c=null}u.a=0}))}},t.request=function(t,e,n,r){var i=new rr(t),o=this;return this.pa((function(t){o.a++,ir(i,t,o.I()+"R"+o.a)}),e,n||Fn,(function(t,e){or(i),r&&r(t,e)})),i},t.Da=function(t,e,n,r,i){var o,s=this;this.pa((function(n){s.a++,o=s.I()+"R"+s.a,rn(s.logger,o+" BEGIN"),e(n,o,(function(e,r){s.c=n,o=s.I()+"R"+s.a,r?(rn(s.logger,o+" ERROR"),t.o(e)):(rn(s.logger,o+" SUCCESS"),t.callback(e)),s.c=null})),e=null,rn(s.logger,o+" END")}),n,r,i)},t.toString=function(){return"Parallel:"+this.g+":"+this.I()+(this.c?"*":"")},k(uo,ao),(t=uo.prototype).logger=Xe("ydn.db.tr.AtomicParallel"),t.jc=function(){return!1},t.request=function(t,e,n){var r,i,o,s=this,a=uo.B.request.call(this,t,e,n,(function(t,e){if(or(a),rn(s.logger,"transaction "+t),r)"complete"!=t&&(o=!0,i=e),r(i,o);else{var n=new Ir;sr(a,n,!0)}}));return ar(a,(function(t,e,n){o=e,i=t,r=n})),a},t.Da=function(t,e,n,r,i){var o,s,a=new Nt;qt(a,(function(t){s=!1,o=t}),(function(t){s=!0,o=t})),uo.B.Da.call(this,a,e,n,r,(function(e,n){if("complete"!=e)t.o(n);else if(!0===s)t.o(o);else if(!1===s)t.callback(o);else{var r=new Ir;t.o(r)}i&&(i(e,n),i=void 0)}))},t.toString=function(){return"Atomic"+uo.B.toString.call(this)},k(lo,Zi),(t=lo.prototype).wa=0,t.kc=function(t,e,n,r,i,o){var s;return"readonly"==r?s=Fn:"readwrite"==r&&(s=_n),t=ho(this,t=t||Ar,e,n,s,i),this.va(t,o?null:this.m)},t.va=function(t){return new _r(this,this.a,t)},t.tc=function(t,e,n){if(3<arguments.length)throw new on("too many input arguments, run accept not more than 3 input arguments, but "+arguments.length+" found.");this.wa++;var r=e||Mi(this.a),i=Fn;if(n)if("readwrite"==n)i=_n;else if("readonly"!=n)throw new on('Invalid transaction mode "'+n+'"');var o=ho(this,"all",!1,r,i,1),s=this.va(o,this.m),a=new rr("run"),u=this;return o.pa((function(e){nn(u.logger,"executing run in transaction on "+o),ir(a,e,o.I()+"R0"),t(s)}),r,i,(function(t){or(a),sr(a,o.f,"complete"!==t)})),a},t.Pc=function(){return this.c?this.c.a.f:NaN},k(co,lo),(t=co.prototype).va=function(t){return new $r(this,this.a,t)},t.add=function(t,e,n){return this.c.add(t,e,n)},t.Ta=function(t,e,n){return this.c.Ta(t,e,n)},t.count=function(t,e,n,r){return this.c.count(t,e,n,r)},t.get=function(t,e){return this.c.get(t,e)},t.keys=function(t,e,n,r,i,o,s){return this.c.keys(t,e,n,r,i,o,s)},t.Ja=function(t,e,n,r,i,o,s){return this.c.Ja(t,e,n,r,i,o,s)},t.values=function(t,e,n,r,i,o){return this.c.values(t,e,n,r,i,o)},t.Ma=function(t,e,n,r,i,o){return this.c.Ma(t,e,n,r,i,o)},t.put=function(t,e,n){return this.c.put(t,e,n)},t.kb=function(t,e,n){return this.c.kb(t,e,n)},t.clear=function(t,e,n){return this.c.clear(t,e,n)},t.sb=function(t,e,n){return this.c.sb(t,e,n)},t.toString=function(){var t="Storage:"+this.getName();return ro(this)&&(t+=" ["+this.Ba()+"]"),t},k(fo,co),(t=fo.prototype).va=function(t){return new Wr(this,this.a,t)},t.open=function(t,e,n,r){return this.c.open(t,e,n,r)},t.Ga=function(t){return this.c.Ga(t)},t.Na=function(t,e){return this.c.Na(t,e)},t.Ka=function(t,e){return this.c.Ka(t,e)},t.Lc=function(t,e){return this.c.Nb(t,e)},k(po,Vn),(t=po.prototype).logger=Xe("ydn.db.core.req.IDBCursor"),t.Za=function(t){(t=t.target.result)?this.W(t.key,t.primaryKey,t.value):this.W()},t.openCursor=function(t,e){function r(t,e,n){p.h=o,p.h.onsuccess=v(p.Za,p),p.W(t,p.g?e:void 0,n),o=null}var i=this+" opening ";null!=t&&(i+="{"+t,i=null!=e?i+";"+e+"}":i+"}"),nn(this.logger,i);var o,s=this.w,u=(i=this.f.objectStore(this.s),a(this.O)?i.index(this.O):null);if(n(t)){var l=!u||!n(e),h=s?s.lower:void 0,c=s?s.upper:void 0,f=!!s&&!!s.lowerOpen;s=!!s&&!!s.upperOpen,s=gn(this.reverse?new pn(h,t,f,l):new pn(t,c,l,s))}o=this.Ia?u?null!=this.Z?u.openKeyCursor(s,this.Z):null!=s?u.openKeyCursor(s):u.openKeyCursor():null!=this.Z?i.openCursor(s,this.Z):null!=s?i.openCursor(s):i.openCursor():u?null!=this.Z?u.openCursor(s,this.Z):null!=s?u.openCursor(s):u.openCursor():null!=this.Z?i.openCursor(s,this.Z):null!=s?i.openCursor(s):i.openCursor();var p=this;o.onerror=function(t){var e=o.error;t.preventDefault(),Gn(p,e)},null!=t?o.onsuccess=function(n){if(n=n.target.result){var i=Kn.cmp(n.key,t),o=p.reverse?-1:1;i==o?r(n.key,n.primaryKey,n.value):i==-o?n.continue(t):null!=e&&Kn.cmp(n.primaryKey,e)==o?r(n.key,n.primaryKey,n.value):n.continue()}else r()}:(p.h=o,p.h.onsuccess=v(p.Za,p))},t.fb=function(){return!!this.h},t.update=function(t){var e=this.h.result;if(e){var n=new Nt;return(t=e.update(t)).onsuccess=function(t){n.callback(t.target.result)},t.onerror=function(t){t.preventDefault(),n.o(t)},n}throw new Sr("cursor gone")},t.clear=function(){if(t=this.h.result){var t,e=new Nt;return(t=t.delete()).onsuccess=function(){e.callback(1)},t.onerror=function(t){t.preventDefault(),e.o(t)},e}throw new Sr("cursor gone")},t.advance=function(t){var e=this.h.result;1==t?e.continue():e.advance(t)},t.Sa=function(t){var e=this.h.result,n=Kn.cmp(t,e.primaryKey);if(n!=(this.reverse?-1:1))throw new hn('continuing primary key "'+t+'" must '+(this.reverse?"lower":"higher")+' than current primary key "'+e.primaryKey+'"');var r=this;this.h.onsuccess=function(i){(e=i.target.result)?0==(n=Kn.cmp(e.primaryKey,t))||1==n&&!r.reverse||-1==n&&r.reverse?(r.h.onsuccess=v(r.Za,r),r.W(e.key,r.g?e.primaryKey:void 0,e.value)):e.continue():(r.h.onsuccess=v(r.Za,r),r.W())},e.continue()},t.ra=function(t){var e=this.h.result;null!=t?e.continue(t):e.continue()},t.fa=function(){po.B.fa.call(this),this.h=null},t.toString=function(){return"IDB"+po.B.toString.call(this)},k(go,Pr),(t=go.prototype).logger=Xe("ydn.db.crud.req.IndexedDb"),t.Ya=function(t,e){var n=[];0==e.length?sr(t,[]):function r(i){var o=t.a.objectStore(e[i]).count();o.onsuccess=function(o){n[i]=o.target.result,++i==e.length?sr(t,n):r(i)},o.onerror=function(e){e.preventDefault(),sr(t,o.error,!0)}}(0)},t.P=function(t,e,n,r,i,o){function s(p){null==i[p]&&(nn(h.logger,"empty object at "+p+" of "+i.length),++u==i.length?sr(t,a,l):(d=p+10)<i.length&&s(d));var g,d=i[p];(g=o&&null!=o[p]?e?f.put(d,o[p]):f.add(d,o[p]):e?f.put(d):f.add(d)).onsuccess=function(e){u++,a[p]=e.target.result,u==i.length?sr(t,n?a[0]:a,l):(e=p+10)<i.length&&s(e)},g.onerror=function(e){u++;var o=g.error;nn(h.logger,lr(t)+c+' request to "'+r+'" cause '+o.name+' for object "'+ji(i[p])+'" at index '+p+" of "+i.length+" objects."),a[p]=o,l=!0,e.preventDefault(),u==i.length?sr(t,n?a[0]:a,l):(e=p+10)<i.length&&s(e)}}var a=[],u=0,l=!1,h=this,c=e?"put":"add",f=t.a.objectStore(r);if(nn(this.logger,lr(t)+" "+c+" "+i.length+' objects to store "'+r+'"'),0<i.length)for(var p=0;10>p&&p<i.length;p++)s(p);else sr(t,[])},t.Gb=function(t,e,n){function r(u){var l,h=n[u],c=h.s,f=t.a.objectStore(c);(l=null===f.keyPath?f.put(e[u],h.id):f.put(e[u])).onsuccess=function(n){o++,i[u]=n.target.result,o==e.length?sr(t,i,s):(n=u+10)<e.length&&r(n)},l.onerror=function(n){o++,tn(a.logger,"request result "+n.name+' error when put keys to "'+c+'" for object "'+ji(e[u])+'" at index '+u+" of "+e.length+" objects."),i[u]=l.error,s=!0,n.preventDefault(),o==e.length?sr(t,i,s):(n=u+10)<e.length&&r(n)}}var i=[],o=0,s=!1,a=this;if(nn(this.logger,lr(t)+" putByKeys: of "+e.length+" objects"),0<e.length)for(var u=0;10>u&&u<e.length;u++)r(u);else sr(t,i,s)},t.lb=function(t,e,n){var r=t.a.objectStore(e);nn(this.logger,lr(t)+" clearById: "+e+" "+n);var i=r.openCursor(On.only(n));i.onsuccess=function(e){if(e=e.target.result){var n=e.delete();n.onsuccess=function(){sr(t,1)},n.onerror=function(){sr(t,n.error,!0)}}else sr(t,0)},i.onerror=function(e){e.preventDefault(),sr(t,i.error,!0)}},t.Ib=function(t,e){var n,r,i=0;nn(this.logger,lr(t)+" removeByKeys: "+e.length+" keys");var o=[];!function s(a){if(++a>=e.length)0<o.length?sr(t,o,!0):sr(t,i);else{e[a].s!=n&&(n=e[a].s,r=t.a.objectStore(n));var u=r.delete(e[a].id);u.onsuccess=function(){i++,s(a)},u.onerror=function(t){t.preventDefault(),o[a]=u.error,s(a)}}}(-1)},t.mb=function(t,e,n){var r=t.a.objectStore(e),i=r.count(n);nn(this.logger,lr(t)+" clearByKeyRange: "+e+" "+n),i.onsuccess=function(e){var i=e.target.result,o=r.delete(n);o.onsuccess=function(){sr(t,i)},o.onerror=function(){sr(t,o.error,!0)}},i.onerror=function(e){e.preventDefault(),sr(t,i.error,!0)}},t.vb=function(t,e,n){var r=t.a.objectStore(e);nn(this.logger,lr(t)+" "+e+" "+n);var i=r.delete(n);i.onsuccess=function(){sr(t,void 0)},i.onerror=function(e){e.preventDefault(),sr(t,i.error,!0)}},t.Hb=function(t,e,n,r){var i=t.a.objectStore(e).index(n);nn(this.logger,lr(t)+" clearByIndexKeyRange: "+e+":"+n+" "+r);var o=[],s=i.openCursor(r),a=0;s.onsuccess=function(e){var n=e.target.result;if(n){var r=n.delete();r.onsuccess=function(){a++,n.continue()},r.onerror=function(t){o.push(r.error),t.preventDefault(),n.continue()}}else 0<o.length?sr(t,o,!0):sr(t,a)},s.onerror=function(e){e.preventDefault(),sr(t,s.error,!0)}},t.Wa=function(t,e){var n=e.length,r=0;nn(this.logger,lr(t)+" clearByStores: "+e);for(var i=0;i<n;i++){var o=t.a.objectStore(e[i]).clear();o.onsuccess=function(){++r==n&&sr(t,r)},o.onerror=function(e){r++,e.preventDefault(),r==n&&sr(t,o.error,!0)}}},t.bb=function(t,e,n){var r=this;nn(this.logger,lr(t)+e+":"+n);var i=t.a.objectStore(e),o=i.get(n);o.onsuccess=function(e){nn(r.logger,lr(t)+" record "+n+(null!=e.target.result?" ":" not ")+" exists.");var o=e.target.result;if(!i.keyPath&&0==i.indexNames.length&&me&&a(o)&&0<=o.indexOf(";base64,")){'"'==o.charAt(0)&&'"'==o.charAt(o.length-1)&&(o=o.substr(1,o.length-2)),e=(o=o.split(";base64,"))[0].split(":")[1];for(var s=(o=window.atob(o[1])).length,u=new Uint8Array(s),l=0;l<s;++l)u[l]=o.charCodeAt(l);sr(t,new Blob([u.buffer],{type:e}))}else sr(t,e.target.result)},o.onerror=function(e){e.preventDefault(),sr(t,o.error,!0)}},t.Eb=function(t,e,n){function r(e){if(null==n[e])if(o++,i[e]=void 0,o==a)sr(t,i);else{var u=e+10;u<a&&r(u)}var l;(l=s.get(n[e])).onsuccess=function(n){o++,i[e]=n.target.result,o==a?sr(t,i):(n=e+10)<a&&r(n)},l.onerror=function(e){o++,e.preventDefault(),sr(t,l.error,!0)}}var i=[];i.length=n.length;var o=0,s=t.a.objectStore(e),a=n.length;if(nn(this.logger,lr(t)+" "+e+":"+a+" ids"),0<a)for(e=0;10>e&&e<a;e++)r(e);else sr(t,[])},t.Fb=function(t,e){function n(o){var s=e[o],a=t.a.objectStore(s.s).get(s.id);a.onsuccess=function(s){i++,r[o]=s.target.result,i==e.length?sr(t,r):(s=o+10)<e.length&&n(s)},a.onerror=function(e){i++,e.preventDefault(),sr(t,a.error,!0)}}var r=[];r.length=e.length;var i=0;if(nn(this.logger,lr(t)+" "+e.length+" ids"),0<e.length)for(var o=0;10>o&&o<e.length;o++)n(o);else sr(t,[])},t.Fa=function(t,e,n,r,i){if(r&&i)throw new ln("unique count not available in IndexedDB");var o;i=t.a.objectStore(e),e=lr(t)+" "+e+(r?":"+r:"")+(n?":"+Ri(n):""),nn(this.logger,e),null!=r?(r=i.index(r),o=null!=n?r.count(n):r.count()):o=null!=n?i.count(n):i.count(),o.onsuccess=function(e){sr(t,e.target.result)},o.onerror=function(e){e.preventDefault(),sr(t,o.error,!0)}},t.$=function(t,e,r,i,o,s,a,u,l,h){var c,f=[],p=t.a.objectStore(r),g=u?l?"prevunique":"prev":l?"nextunique":"next";if(r=lr(t)+" "+e+" "+r+(i?":"+i:"")+(o?Ri(o):""),u&&(r+=" reverse"),l&&(r+=" unique"),h&&n(h[0])){l=!i||!n(h[1]);var d=h[0],v=o?o.lower:void 0,y=o?o.upper:void 0,b=!!o&&!!o.lowerOpen;o=!!o&&!!o.upperOpen,o=gn(u?new pn(v,d,b,l):new pn(d,y,l,o)),r+=" starting from "+Ri(h[0]),n(h[1])&&(r+=", "+Ri(h[1]))}nn(this.logger,r),c=1==e||2==e||3==e?i?p.index(i).openKeyCursor(o,g):p.openCursor(o,g):i?p.index(i).openCursor(o,g):p.openCursor(o,g);var m=!1;c.onsuccess=function(r){if(r=r.target.result){if(!m){if(0<a)return m=!0,void r.advance(a);if(h&&i&&n(h[0]))if(n(h[1])){var o=Kn.cmp(r.key,h[0]),l=u?-1:1;if(0==o){if(0==(o=Kn.cmp(r.primaryKey,h[1])))return m=!0,void r.continue();if(o!=l)return void r.continue();m=!0}else m=!0}else m=!0;else m=!0}1==e?f.push(r.key):2==e?f.push(r.primaryKey):3==e?(l={},i&&(l[i]=r.key),p.keyPath?l[p.keyPath]=r.primaryKey:l._ROWID_=r.primaryKey,f.push(l)):4==e?f.push(r.value):f.push([r.key,r.primaryKey,r.value]),f.length<s?r.continue():(h&&(h[0]=Tr(r.key),h[1]=Tr(r.primaryKey)),sr(t,f))}else h&&(h[0]=void 0,h[1]=void 0),sr(t,f)},c.onerror=function(e){e.preventDefault(),sr(t,c.error,!0)}},k(vo,go),vo.prototype.logger=Xe("ydn.db.core.req.IndexedDb"),vo.prototype.b=function(t,e,n,r){return new po(t,e,n=Fi(this.a,n),r)},yo.prototype.a=!1,yo.prototype.state=function(){return this.a},k(bo,Vn),(t=bo.prototype).logger=Xe("ydn.db.core.req.SimpleCursor"),t.fb=function(){return!!this.f},t.update=function(t){return $o(this.nb,this.T(),t),Pt()},t.advance=function(t){function e(e){if(r++,!e||r>=t)return wo(n,e)}var n=this,r=this.h?-1:0;this.reverse?Mo(this.la,e,this.h):Lo(this.la,e,this.h)},t.ra=function(t){if(null!=t){var e=this,n=new So(t),r=function(n){if(e.h=n,!n)return wo(e,n);var r=cr(n.value.key,t);if(e.reverse){if(1!=r)return wo(e,n)}else if(-1!=r)return wo(e,n)};this.reverse?Mo(this.la,r,n):Lo(this.la,r,n)}else this.advance(1)},t.openCursor=function(t,e){var n=null;if(this.w)if(this.reverse){var r=this.g?"￿":void 0;null!=this.w.upper&&(n=new So(this.w.upper,r))}else null!=this.w.lower&&(n=new So(this.w.lower));null!=t&&(n=this.g?new So(t,e):new So(t)),this.i=this.f.l((function(e){function r(e){var r=e.value,i=r.key;if(e&&null!=i)if(null!=t){if(0==Eo(n,r))return}else if(this.w&&(!this.reverse&&this.w.lowerOpen&&null!=this.w.lower&&0==(r=cr(i,this.w.lower))||this.reverse&&this.w.upperOpen&&null!=this.w.upper&&0==(r=cr(i,this.w.upper))))return;return wo(this,e)}this.nb=Xo(e,this.s),this.la=_o(this.nb,this.O),this.reverse?Mo(this.la,v(r,this),n):Lo(this.la,v(r,this),n),mo(this)}),this)},t.clear=function(){throw new un},t.Sa=function(){throw new un},t.toString=function(){return"Simple"+bo.B.toString.call(this)},So.prototype.toString=function(){return"ydn.db.con.simple.Node("+this.key+(null!=this.a?", "+this.a+")":")")},(t=xo.prototype).D=null,t.U=null,t.ca=null,t.ba=null,t.add=function(t){if(null==this.D)return this.ba=this.ca=this.D=new Ro(t),!0;var e=null;return Io(this,(function(n){var r=null,i=this.U(n.value,t);return 0<i?(r=n.left,null==n.left&&(e=new Ro(t,n),n.left=e,n==this.ca&&(this.ca=e))):0>i&&(r=n.right,null==n.right&&(e=new Ro(t,n),n.right=e,n==this.ba&&(this.ba=e))),r})),e&&(Io(this,(function(t){return t.count++,t.parent}),e.parent),qo(this,e.parent)),!!e},t.clear=function(){this.ba=this.ca=this.D=null},t.contains=function(t){var e=!1;return Io(this,(function(n){var r=null,i=this.U(n.value,t);return 0<i?r=n.left:0>i?r=n.right:e=!0,r})),e},t.indexOf=function(t){var e=-1,n=0;return Io(this,(function(r){var i=this.U(r.value,t);return 0<i?r.left:(r.left&&(n+=r.left.count),0>i?(n++,r.right):(e=n,null))})),e},t.zb=function(){return this.D?this.D.count:0},t.cb=function(){var t=[];return function(t,e){if(t.D){var n,r=n=Co(t);for(n=n.left?n.left:n;null!=r;)if(null!=r.left&&r.left!=n&&r.right!=n)r=r.left;else{if(r.right!=n&&e(r.value))break;var i=r;r=null!=r.right&&r.right!=n?r.right:r.parent,n=i}}}(this,(function(e){t.push(e)})),t},Ro.prototype.left=null,Ro.prototype.right=null,Ro.prototype.height=1,k(Bo,xo),Fo.prototype.clear=function(){Ko(this),Go(this)},Fo.prototype.getName=function(){return this.b.getName()},Fo.prototype.na=function(t,e,n,r,i){return Jo(this,2,t,e,n,r,i)},Fo.prototype.toString=function(){return"ydn.db.con.simple.Store:"+this.g+":"+this.b.getName()},(t=Yo.prototype).wb=function(){return this},t.setItem=function(t,e){n(this.a[t])||(this.keys.push(t.toString()),this.length=this.keys.length),this.a[t]=e},t.getItem=function(t){return n(this.a[t])?this.a[t]:null},t.removeItem=function(t){delete this.a[t],Q(this.keys,t.toString()),this.length=this.keys.length},t.length=0,t.key=function(t){return n(t=this.keys[t])?this.a[t]:null},t.clear=function(){this.a={},this.keys=[],this.length=0},zo.prototype.S=function(t){var e=this;setTimeout((function(){var n=ko(e.f);n=new Li(n=e.c.getItem(n)),t(n)}),10)},Qo.prototype.l=function(t,e){var n=this.b;setTimeout((function(){t.call(e,n)}),4);var r=this;return function(){r.a("complete",null),r.a=null,r.b=null}},k(Zo,Pr),(t=Zo.prototype).logger=Xe("ydn.db.crud.req.SimpleStore"),t.Gb=function(t,e,n){this.P(t,!0,!1,null,e,n)},t.P=function(t,e,n,r,i,o){nn(this.logger,lr(t)+" "+(e?"put":"add")+"Object"+(n?"":"s "+i.length+" objects"));var s=t.a.l((function(a){var u;if(n)null!=(a=$o(u=Xo(a,r),a=o?o[0]:void 0,i[0],!e))?sr(t,a):(u=new br(u=ji(a)),sr(t,u,!0));else{for(var l=r,h=[],c=!1,f=o||{},p=0;p<i.length;p++){var g;r?g=f[p]:(g=(l=o[p]).id,l=l.s),u&&u.getName()==l||(u=Xo(a,l)),null!=(g=$o(u,g,i[p],!e))?h.push(g):(c=!0,h.push(new br))}sr(t,h,c)}s(),s=null}),this)},t.bb=function(t,e,n){var r=t.a.l((function(i){i=Ho(Xo(i,e),n),sr(t,i),r(),r=null}),this)},t.Eb=function(t,e,n){ts(this,t,e,n)},t.Fb=function(t,e){ts(this,t,null,e)},t.lb=function(t,e,n){var r=lr(t)+" removeById "+e+" "+n;nn(this.logger,r);var i=this,o=t.a.l((function(s){s=Wo(Xo(s,e),n),rn(i.logger,"success "+r+(0==s?" [not found]":"")),sr(t,s),o(),o=null}),this)},t.Ib=function(t,e){nn(this.logger,lr(t)+" removeByKeys "+e.length+" keys");var n,r=0,i=t.a.l((function(o){for(var s=0;s<e.length;s++){var a=e[s].s,u=e[s].id;n&&n.getName()==a||(n=Xo(o,a)),r+=Wo(n,u)}sr(t,r),i(),i=null}),this)},t.vb=function(t,e,n){this.mb(t,e,n)},t.mb=function(t,e,n){var r=lr(t)+" removeByKeyRange "+(n?Ri(n):"");nn(this.logger,r);var i=this,o=t.a.l((function(s){s=Go(Xo(s,e),n),rn(i.logger,r+" deleted "+s+" records."),sr(t,s),o(),o=null}),this)},t.Hb=function(t,e,n,r){var i=lr(t)+" removeByIndexKeyRange "+(r?Ri(r):"");nn(this.logger,i);var o=t.a.l((function(i){for(var s=(i=Xo(i,e)).na(n,r),a=s.length,u=0;u<a;u++)Wo(i,s[u]);sr(t,a),o(),o=null}),this)},t.Wa=function(t,e){var n=lr(t)+" clearByStores";nn(this.logger,n);var r=t.a.l((function(i){for(var o=0;o<e.length;o++)Xo(i,e[o]).clear();rn(this.logger,"success "+n),sr(t,e.length),r(),r=null}),this)},t.Ya=function(t,e){var n=t.a.l((function(r){for(var i=[],o=0;o<e.length;o++){var s=Xo(r,e[o]);i.push(Vo(s))}sr(t,i),n(),n=null}),this)},t.Fa=function(t,e,n,r){var i=lr(t)+" count"+(null!=r?"Index":"")+(null!=n?"KeyRange":"Store");nn(this.logger,i);var o=t.a.l((function(s){s=Vo(Xo(s,e),r,n),rn(this.logger,"success "+i),sr(t,s),o(),o=null}),this)},t.$=function(t,e,n,r,i,o,s,a,u,l){var h=lr(t)+" "+n+" "+(i?ji(i):"");nn(this.logger,h);var c=t.a.l((function(f){f=Jo(Xo(f,n),e,r,i,a,o,s,u,l),rn(this.logger,h+" "+f.length+" records found."),sr(t,f),c(),c=null}),this)},k(es,Zo),es.prototype.b=function(t,e,n,r){return new bo(t,e,n=Fi(this.a,n),r)},k(ns,Vn),(t=ns.prototype).logger=Xe("ydn.db.core.req.WebsqlCursor"),t.T=function(){return this.h},t.Ob=function(t,e,n,r,i){ns.B.Ob.call(this,t,e,n,r,i),this.K=a(e)?wi(this.b,e):null},t.Ca=function(){return this.m},t.fb=function(){return!!this.f},t.update=function(t){if(!this.fb())throw new Sr;var e=new Nt,n=this.T();t=Ii(this.b,t,n);var r="REPLACE INTO "+Ei(this.b)+" ("+t.Vb.join(", ")+") VALUES ("+t.fc.join(", ")+")";return nn(this.logger,this+': update "'+r+'" : '+Ri(t.values)),this.f.executeSql(r,t.values,(function(){e.callback(n)}),(function(t,n){return e.o(n),!1})),e},t.advance=function(t){var e=this.i,n=this.h,r=!0;null==this.i||this.g&&null==this.h||(--t,r=!1),is(this,(function(t,r,i){var o=null!=e&&null!=t&&0==cr(e,t);if(this.g){var s=null!=r&&null!=n&&0==cr(r,n);if(o&&s)throw new hn("current: "+e+";"+n+" next: "+t+";"+r)}else if(o)throw new hn("current: "+e+" next: "+t);this.W(t,r,i)}),this.i,r,t,this.h)},t.ra=function(t){null!=t?is(this,this.W,t,!0):this.advance(1)},t.openCursor=function(t,e){is(this,this.W,t,!1,0,e)},t.clear=function(){if(!this.fb())throw new Sr;var t=new Nt,e=this.b.g,n=(e="DELETE FROM "+Ei(this.b)+" WHERE "+e+" = ?",[this.T()]);return nn(this.logger,this+': clear "'+e+'" : '+Ri(n)),this.f.executeSql(e,n,(function(e,n){t.callback(n.rowsAffected)}),(function(e,n){return t.o(n),!1})),t},t.Sa=function(t){var e=cr(t,this.h);if(0==e||1==e&&this.reverse||-1==e&&!this.reverse)throw new zi(this+" to continuePrimaryKey  from "+this.h+" to "+t+" on "+this.Z+" direction is wrong");!function(t,e,n){wi(t.b,t.O);var r=[],i=t.O,o=t.w,s=t.i;if(null!=o){var a=o.lower,u=o.upper,l=o.lowerOpen,h=o.upperOpen;t.reverse?u=null!=u&&-1==cr(u,s)?u:s:a=null!=a&&1==cr(a,s)?a:s,o=null!=a&&null!=u?vn(a,u,!!l,!!h):null!=a?On.lowerBound(a,!!l):On.upperBound(u,!!h)}else o=t.reverse?On.upperBound(s):On.lowerBound(s);i=yi(t.b,r,t.u,i,o,t.reverse,t.unique),n=t.reverse?On.upperBound(n,!1):On.lowerBound(n,!1),n=yi(t.b,r,t.u,t.b.g,n,t.reverse,t.unique),i.v=i.v?i.v+" AND "+n.v:n.v,n="SELECT "+i.select+" FROM "+i.V+(i.v?" WHERE "+i.v:"")+(i.group?" GROUP BY "+i.group:"")+" ORDER BY "+i.X,n+=" LIMIT 1",nn(t.logger,t+": continuePrimary:  SQL: "+n+" : "+Ri(r)),t.f.executeSql(n,r,(function(n,r){0<r.rows.length?rs(t,r.rows.item(0)):rs(t),e.call(t,t.i,t.h,t.m),e=null}),(function(n,r){return tn(t.logger,"get error: "+r.message),Gn(t,r),rs(t),e.call(t,t.h,t.i,t.m),e=null,!1}))}(this,this.W,t)},t.toString=function(){return"WebSql"+ns.B.toString.call(this)},k(os,Pr),(t=os.prototype).logger=Xe("ydn.db.crud.req.WebSql"),t.P=function(t,e,r,i,o,s){function a(e,i){if(null==o[e])if(nn(h.logger,"empty object at "+e+" of "+o.length),++f==o.length)rn(h.logger,p+" success "+p),sr(t,c,g);else{var d=e+2;d<o.length&&a(d,i)}var v;v=n(s)?Ii(u,o[e],s[e]):Ii(u,o[e]),d=l+Ei(u)+" ("+v.Vb.join(", ")+") VALUES ("+v.fc.join(", ")+");",nn(h.logger,lr(t)+" SQL: "+d+" PARAMS: "+v.values+" REQ: "+e+" of "+o.length),i.executeSql(d,v.values,(function(s,p){function d(e,n){var r="ydn.db.me:"+u.getName()+":"+e.getName(),o=(r=l+F(r)+" ("+u.f+", "+e.c+") VALUES (?, ?)",[li(y,u.type),li(n,e.type)]);nn(h.logger,lr(t)+" multiEntry "+r+" "+o),i.executeSql(r,o,(function(){}),(function(t,e){return tn(h.logger,"multiEntry index insert error: "+e.message),!1}))}f++;var y=n(v.key)?v.key:p.insertId;1>p.rowsAffected&&(g=!0,y=new br(y+" no-op"));for(var b=0,m=u.a.length;b<m;b++){var w=u.index(b);if(w.multiEntry)for(var k=In(o[e],w.keyPath),S=(k?k.length:0)||0,E=0;E<S;E++)d(w,k[E])}r?sr(t,y):(c[e]=y,f==o.length?sr(t,c,g):(b=e+2)<o.length&&a(b,s))}),(function(n,i){if(f++,g=!0,6==i.code?i.name="ConstraintError":tn(h.logger,"error: "+i.message+" "+p),r)sr(t,i,!0);else if(c[e]=i,f==o.length)nn(h.logger,"success "+p),sr(t,c,g);else{var s=e+2;s<o.length&&a(s,n)}return!1}))}e=!e;var u=Fi(this.a,i),l=e?"INSERT INTO ":"INSERT OR REPLACE INTO ";i=t.a;var h=this,c=[],f=0,p=lr(t)+" inserting "+o.length+" objects.",g=!1;if(0<o.length)for(e=0;2>e&&e<o.length;e++)a(e,i);else rn(this.logger,"success"),sr(t,[])},t.Gb=function(t,e,n){if(0==n.length)sr(t,[]);else{for(var r=[],i=0,o=0,s=this,a=function(a,u){var l=[];nn(s.logger,"put "+u.length+" objects to "+a);for(var h=function(t){return!!t.keyPath}(Fi(s.a,a)),c=h?void 0:[],f=0;f<u.length;f++)l.push(e[u[f]]),h||c.push(n[u[f]].id);h=function(t){var e=new rr(t.C);return t.N++,ir(e,t.a,t.ya+"C"+t.N),e}(t),qt(h,(function(e){for(var n=0;n<u.length;n++)r[u[n]]=e[n];++i==o&&sr(t,r)}),(function(){++i==o&&sr(t,r,!0)})),s.P(h,!1,!1,a,l,c)},u="",l=[],h=[],c=0;c<n.length;c++){var f=n[c].s,p=n[c].id;f!=u?(o++,0<l.length&&a(u,l),l=[c],h=[p],u=f):(l.push(c),h.push(p))}0<l.length&&a(u,l)}},t.bb=function(t,e,n){var r=t.a,i=Fi(this.a,e),o=this;e=i.f,n=[li(n,i.type)],e="SELECT * FROM "+Ei(i)+" WHERE "+e+" = ?";var s=lr(t)+" SQL: "+e+" PARAMS: "+n;nn(this.logger,s),r.executeSql(e,n,(function(e,n){if(0<n.rows.length){var r=n.rows.item(0);null!=r?(r=ss(r,i),sr(t,r)):(rn(o.logger,"success no result: "+s),sr(t,void 0))}else rn(o.logger,"success no result: "+s),sr(t,void 0)}),(function(e,n){return tn(o.logger,"error: "+s+" "+n.message),sr(t,n,!0),!1}))},t.Eb=function(t,e,n){function r(e,i){var l=u.f,h=[li(n[e],u.type)],c="SELECT * FROM "+Ei(u)+" WHERE "+l+" = ?";nn(o.logger,"SQL: "+c+" PARAMS: "+h),i.executeSql(c,h,(function(i,o){if(a++,0<o.rows.length){var l=o.rows.item(0);null!=l&&(s[e]=ss(l,u))}else s[e]=void 0;a==n.length?sr(t,s):(l=e+10)<n.length&&r(l,i)}),(function(i,u){if(a++,tn(o.logger,"error: "+c+" "+u.message),a==n.length)sr(t,s);else{var l=e+10;l<n.length&&r(l,i)}return!1}))}var i=t.a,o=this,s=[],a=0,u=Fi(this.a,e);if(0<n.length)for(e=0;10>e&&e<n.length;e++)r(e,i);else rn(o.logger,"success"),sr(t,[])},t.Fb=function(t,e){function n(r,u){var l=e[r],h=Fi(i.a,l.s),c=function(t){return o(t.id)?t.id.join("^|"):t.id instanceof Date?+t.id:t.id}(l),f=(l=h.f,c=[li(c,h.type)],"SELECT * FROM "+Ei(h)+" WHERE "+l+" = ?");nn(i.logger,"SQL: "+f+" PARAMS: "+c),u.executeSql(f,c,(function(o,u){if(a++,0<u.rows.length){var l=u.rows.item(0);null!=l&&(s[r]=ss(l,h))}else s[r]=void 0;a==e.length?(nn(i.logger,"success "+f),sr(t,s)):(l=r+10)<e.length&&n(l,o)}),(function(e,n){return sr(t,n,!0),!1}))}var r=t.a,i=this,s=[],a=0;if(0<e.length)for(var u=0;10>u&&u<e.length;u++)n(u,r);else nn(this.logger,"success"),sr(t,[])},t.Wa=function(t,e){var n=t.a,r=this;0<e.length?function n(i,o){function s(t){t="DELETE FROM  "+F(t="ydn.db.me:"+a.getName()+":"+t.getName()),nn(r.logger,"SQL: "+t),o.executeSql(t,[])}var a=Fi(r.a,e[i]),u="DELETE FROM  "+Ei(a);nn(r.logger,"SQL: "+u+" PARAMS: []"),o.executeSql(u,[],(function(o){i==e.length-1?(nn(r.logger,"success "+u),sr(t,e.length)):n(i+1,o)}),(function(e,n){return sr(t,n,!0),!1}));for(var l=0,h=a.a.length;l<h;l++){var c=a.index(l);c.multiEntry&&s(c)}}(0,n):(nn(this.logger,"success"),sr(t,0))},t.Ib=function(t,e){var n=t.a,r=this,i=0,o=!1;nn(this.logger,lr(t)+" removeByKeys: "+e.length+" keys"),function s(a){if(a>=e.length)sr(t,i,o);else{var u=Fi(r.a,e[a].s),l=li(e[a].id,u.type),h=" WHERE "+u.f+" = ?",c="DELETE FROM "+Ei(u)+h,f=lr(t)+" SQL: "+c+" PARAMS: "+[l];n.executeSql(c,[l],(function(){i++,s(a)}),(function(t,e){return tn(r.logger,"error: "+f+e.message),o=!0,s(a),!1})),a++,c=function(e){e="DELETE FROM  "+F(e="ydn.db.me:"+u.getName()+":"+e.getName())+h,nn(r.logger,lr(t)+NaN+e),n.executeSql(e,[l])};for(var p=0,g=u.a.length;p<g;p++){var d=u.index(p);d.multiEntry&&c(d)}}}(0)},t.lb=function(t,e,n){function r(e){e="DELETE FROM  "+F(e="ydn.db.me:"+o.getName()+":"+e.getName())+u,nn(a.logger,lr(t)+NaN+e),i.executeSql(e,[s])}var i=t.a,o=Fi(this.a,e),s=li(n,o.type),a=this,u=" WHERE "+o.f+" = ?";for(e="DELETE FROM "+Ei(o)+u,nn(this.logger,lr(t)+" SQL: "+e+" PARAMS: "+[s]),i.executeSql(e,[s],(function(e,n){sr(t,n.rowsAffected)}),(function(e,n){return sr(t,n,!0),!1})),e=0,n=o.a.length;e<n;e++){var l=o.index(e);l.multiEntry&&r(l)}},t.vb=function(t,e,n){as(this,t,e,void 0,n)},t.mb=function(t,e,n){as(this,t,e,void 0,n)},t.Hb=function(t,e,n,r){as(this,t,e,n,r)},t.Ya=function(t,e){var n=t.a,r=this,i=[];0==e.length?(nn(this.logger,"success"),sr(t,0)):function o(s){var a="SELECT COUNT(*) FROM "+F(e[s]);nn(r.logger,"SQL: "+a+" PARAMS: []"),n.executeSql(a,[],(function(n,r){var a=r.rows.item(0);i[s]=parseInt(a["COUNT(*)"],10),++s==e.length?sr(t,i):o(s)}),(function(e,n){return sr(t,n,!0),!1}))}(0)},t.Fa=function(t,e,n,r,i){var o=[];e=vi(Fi(this.a,e),o,6,r,n,!1,i),nn(this.logger,lr(t)+" SQL: "+e+" PARAMS: "+o),t.a.executeSql(e,o,(function(e,n){var r=n.rows.item(0);sr(t,Qi(r))}),(function(e,n){return sr(t,n,!0),!1}))},t.$=function(t,e,r,i,o,s,a,u,h,c){var f=this,p=[],g=Fi(this.a,r),d=g.g,v=g.type,y=v,b=null!=i&&i!==d?wi(g,i):null,m=i||d;if(b&&(y=b.type),r=[],c&&n(c[0])){var w=c[0];b&&n(c[1])?(i=c[1],o=mi(g,e,r,b.getName(),o,w,!0,i,u,h)):o=bi(g,e,r,i,o,u,h,w,!0)}else o=vi(g,r,e,m,o,u,h);l(s)&&(o+=" LIMIT "+s),l(a)&&(o+=" OFFSET "+a);var k=t+" SQL: "+o+" ;params= "+Ri(r);nn(this.logger,k),t.a.executeSql(o,r,(function(n,r){for(var i,o=r.rows.length,s=0;s<o;s++)i=r.rows.item(s),2==e?p[s]=hi(i[d],v):1==e?p[s]=hi(i[m],y):3==e?p[s]=[hi(i[m],y),hi(i[d],v)]:null!=i&&(p[s]=ss(i,g));rn(f.logger,"success "+t),c&&i&&(c[0]=hi(i[m],y),c[1]=hi(i[d],v)),sr(t,p)}),(function(e,n){return tn(f.logger,"error: "+k+n.message),sr(t,n,!0),!1}))},k(us,os),us.prototype.logger=Xe("ydn.db.core.req.WebSql"),us.prototype.b=function(t,e,n,r){return new ns(t,e,n=Fi(this.a,n),r)},fo.prototype.u=function(){var t=this.Ba();if("indexeddb"==t)return new vo(0,this.a);if("websql"==t||"sqlite"==t)return new us(0,this.a);if("memory"==t||"localstorage"==t||"userdata"==t||"sessionstorage"==t)return new es(0,this.a);throw new hn("No executor for "+t)},(t=ls.prototype).M="",t.$b=NaN,t.ac=NaN,t.Kb=!1,t.Oa="",t.toJSON=function(){return{sql:this.M}},t.toString=function(){return"query:"+this.M},ps.prototype.logger=Xe("ydn.db.sql.req.nosql.Node"),ps.prototype.toJSON=function(){return{sql:this.a}},ps.prototype.toString=function(){return"idb.Node:"},ps.prototype.b=function(t,e){var r=Z(this.a.a)[0],i=this.a.i,o=this.a.$b,s=(o=isNaN(o)?100:o,this.a.ac),a=(s=isNaN(s)?0:s,this.a.j),u=fs(this.a),l=null,h=this.a.Kb;if(0==i.length)l=null;else{if(1!=i.length)throw new an("too many conditions.");l=kn(i[0].a)}null===u||ar(t,(function(t,e,n){var r=t;e||(r=t.map((function(t){var e=u.length;if(1==e)return In(t,u[0]);for(var n={},r=0;r<e;r++)n[u[r]]=In(t,u[r]);return n}))),n(r,e)})),i=0<i.length?i[0].ma:void 0;var c=lr(t)+" executing on"+r;i&&(c+=":"+i),c+=" "+En(l),rn(this.logger,c),a&&a!=this.c.keyPath?e.$(t,4,r,a,l,o,s,h,!1):n(i)&&i!=this.c.keyPath?e.$(t,4,r,i,l,o,s,h,!1):e.$(t,4,r,null,l,o,s,h,!1)},k(gs,ps),gs.prototype.b=function(t,e){var r,i=Z(this.a.a)[0],o=null;if(0==(a=this.a.i).length)o=null;else{if(1!=a.length)throw new an("too many conditions.");o=kn(a[0].a)}var s=this.a.c,a=0<a.length?a[0].ma:void 0,u=lr(t)+" executing "+s+" on "+i;if(a&&(u+=":"+a),u+=" "+En(o),rn(this.logger,u),"COUNT"==s)o?e.Fa(t,i,o,a,!1):e.Fa(t,i,null,void 0,!1);else{var l,h;if(!(u=fs(this.a))||0==u.length)throw new zi("field name require for reduce operation: "+s);if(u=u[0],"MIN"==s)l=function(t){return function(e,r){var i=e[t];return n(r)&&r<i?r:i}}(u);else if("MAX"==s)l=function(t){return function(e,r){var i=e[t];return n(r)&&r>i?r:i}}(u);else if("AVG"==s)r=0,l=function(t){return function(e,r,i){return n(r)||(r=0),(r*i+e[t])/(i+1)}}(u);else{if("SUM"!=s)throw new Hi(s);r=0,l=function(t){return function(e,n){return n+e[t]}}(u)}h=n(a)?new er(i,a,o):new tr(i,o),i=e.b(t.a,lr(t),i,4);var c=h.load([i]);c.Y=function(e){sr(t,e,!0)};var f=0;c.G=function(e){null!=e?(e=h.f?c.T():c.Ca(),r=l(e,r,f),c.advance(1),f++):sr(t,r)}}},k(ds,vo),ds.prototype.logger=Xe("ydn.db.sql.req.IndexedDb"),ds.prototype.executeSql=function(t,e,n){if(n=cs(e,n))throw new Or(n);if(1!=(n=Z(e.a)).length)throw new Hi(e.M);var r=Fi(this.a,n[0]);if(!r)throw new Er(n[0]);var i=fs(e);if(i)for(var o=0;o<i.length;o++)if(!Si(r,i[o]))throw new Er('Index "'+i[o]+'" not found in '+n[0]);(e.c?new gs(r,e):new ps(r,e)).b(t,this)},vs.prototype.logger=Xe("ydn.db.sql.req.websql.Node"),vs.prototype.toJSON=function(){return{sql:this.b.M}},vs.prototype.toString=function(){return"websql.Node:"},vs.prototype.c=function(t,e,n){var r=this,i=[];e.executeSql(this.b.M,n,(function(e,n){for(var o=n.rows.length,s=0;s<o;s++){var a=n.rows.item(s);if(c(a))var u=ys(r,a);i.push(u)}t(i)}),(function(e,n){return tn(r.logger,"Sqlite error: "+n.message),t(n,!0),!0}))},k(bs,vs),bs.prototype.c=function(t,e,n){var r=this;e.executeSql(this.b.M,n,(function(e,n){var r=n.rows.length;if(1==r)r=Qi(n.rows.item(0)),t(r);else{if(0!=r)throw new wr;t(void 0)}}),(function(e,n){return tn(r.logger,"Sqlite error: "+n.message),t(n,!0),!0}))},k(ms,us),ms.prototype.logger=Xe("ydn.db.sql.req.WebSql"),ms.prototype.executeSql=function(t,e,n){var r=Z(e.a);if(1!=r.length)throw new Hi(e.M);var i=Fi(this.a,r[0]);if(!i)throw new Er(r[0]);var o=fs(e);if(o)for(var s=0;s<o.length;s++)if(!Si(i,o[s]))throw new Er('Index "'+o[s]+'" not found in '+r[0]);(e.c?new bs(i,e):new vs(i,e)).c((function(e,n){sr(t,e,n)}),t.a,n)},k(ws,es),ws.prototype.logger=Xe("ydn.db.sql.req.SimpleStore"),ws.prototype.executeSql=function(t,e,n){if(n=cs(e,n))throw new Or(n);if(1!=(n=Z(e.a)).length)throw new an(e.M);var r=Fi(this.a,n[0]);if(!r)throw new Er(n[0]);var i=fs(e);if(i)for(var o=0;o<i.length;o++)if(!Si(r,i[o]))throw new on('Index "'+i[o]+'" not found in '+n[0]);(e.c?new gs(r,e):new ps(r,e)).b(t,this)},k(ks,Wr),ks.prototype.executeSql=function(t,e){for(var n=new ls(t),r=Z(n.a),i=0;i<r.length;i++){var o=Fi(this.b,r[i]);if(!o)throw new on("store: "+o+" not exists.")}rn(this.logger,"executeSql: "+t+" params: "+e);var s=this.a.request("sql",Z(n.a),n.f);return ur(s,(function(){Ur(this).executeSql(s,n,e||[])}),this),s},k(Ss,fo),Ss.prototype.va=function(t){return new ks(this,this.a,t)},Ss.prototype.executeSql=function(t,e){return this.c.executeSql(t,e)},Ss.prototype.u=function(){var t=this.Ba();if("indexeddb"==t)return new ds(0,this.a);if("websql"==t||"sqlite"==t)return new ms(0,this.a);if("memory"==t||"localstorage"==t||"sessionstorage"==t)return new ws(0,this.a);throw new hn("No executor for "+t)},(t=Es.prototype).connect=function(t,r){function i(t,e,n){for(rn(a.logger,(n?"changing":"upgrading")+" version to "+t.version+" from "+h),n=0;n<r.stores.length;n++)xs(a,t,e,r.stores[n]);var i=(e=t.objectStoreNames).length;for(n=0;n<i;n++)_i(r,e[n])||(t.deleteObjectStore(e[n]),rn(a.logger,"store: "+e[n]+" deleted."))}function o(t,e){u.c?tn(a.logger,"database already set."):n(e)?(tn(a.logger,e?e.message:"Error received."),a.A=null,u.o(e)):(a.A=t,a.A.onabort=function(t){nn(a.logger,a+": abort"),a.Ra(t.target.error)},a.A.onerror=function(t){nn(a.logger,a+": error"),a.Ra(t.target.error)},a.A.onversionchange=function(t){if(nn(a.logger,a+" closing connection for onversionchange to: "+t.version),a.A&&(a.A.onabort=null,a.A.onblocked=null,a.A.onerror=null,a.A.onversionchange=null,a.jb(t),!t.defaultPrevented)){a.A.close(),a.A=null;var e=Error();e.name=t.type,a.qb(e)}},u.callback(parseFloat(h)))}var s,a=this,u=new Nt,h=void 0,c=r.version;return Qe(this.logger,Ke,"Opening database: "+t+" ver: "+(r.b?"auto":c)),(s=n(c)?Kn.open(t,c):Kn.open(t)).onsuccess=function(s){var u=s.target.result;if(n(h)||(h=u.version),Qe(a.logger,Ke,"Database: "+u.name+", ver: "+u.version+" opened."),r.b)a.S((function(n){if(r instanceof Ki)for(var s=0;s<n.stores.length;s++)_i(r,n.stores[s].getName())||$i(r,n.stores[s].clone());if(0<(n=Ui(r,n,!1,!0)).length){Qe(a.logger,Ke,"Schema change require for difference in "+n);var h=l(u.version)?u.version+1:1;if("IDBOpenDBRequest"in e){u.close();var c=Kn.open(t,h);c.onupgradeneeded=function(t){t=t.target.result,Qe(a.logger,Ke,"re-open for version "+t.version),i(t,c.transaction,!1)},c.onsuccess=function(t){o(t.target.result)},c.onerror=function(){Qe(a.logger,Ke,a+": fail."),o(null)}}else{var f=u.setVersion(h+"");f.a=function(t){tn(a.logger,"migrating from "+u.version+" to "+h+" failed."),o(null,t)},f.onsuccess=function(){f.transaction.oncomplete=p,i(u,f.transaction,!0)};var p=function(){var e=Kn.open(t);e.onsuccess=function(t){t=t.target.result,Qe(a.logger,Ke,a+": OK."),o(t)},e.onerror=function(){Qe(a.logger,Ke,a+": fail."),o(null)}};null!=f.transaction&&(f.transaction.oncomplete=p)}}else o(u)}),void 0,u);else if(r.version>u.version){var c=u.setVersion(r.version);c.a=function(t){tn(a.logger,"migrating from "+u.version+" to "+r.version+" failed."),o(null,t)},c.onsuccess=function(){i(u,c.transaction,!0)}}else r.version==u.version?Qe(a.logger,Ke,"database version "+u.version+" ready to go"):tn(a.logger,"connected database version "+u.version+" is higher than requested version."),a.S((function(t){0<(t=Ui(r,t,!1,!0)).length?(Qe(a.logger,Ke,t),o(null,new Ji("different schema: "+t))):o(u)}),void 0,u)},s.onupgradeneeded=function(t){t=t.target.result,h=NaN,Qe(this.logger,Ke,"upgrade needed for version "+t.version),i(t,s.transaction,!1)},s.onerror=function(e){Ze(a.logger,'open request to database "'+t+'" '+(n(r.version)?" with version "+r.version:"")+" cause error of "+s.error.name),o(null,e)},s.onblocked=function(e){Ze(a.logger,"database "+t+" "+r.version+" block, close other connections."),o(null,e)},l(this.La)&&!isNaN(this.La)&&setTimeout((function(){"done"!=s.readyState&&(Ze(a.logger,a+": database state is still "+s.readyState),o(null,new Ir("connection timeout after "+a.La)))}),this.La),u},t.La=18e4,t.qb=function(){},t.Ra=function(){},t.jb=function(){},t.Aa=function(){return"indexeddb"},t.Mb=function(){return this.A||null},t.pb=function(){return!!this.A},t.logger=Xe("ydn.db.con.IndexedDb"),t.A=null,t.ob=function(){return this.A?parseFloat(this.A.version):void 0},t.S=function(t,e,r){if(r=r||this.A,n(e)){if(null===e){if(0==r.objectStoreNames.length)return void t(new Li(r.version));throw new Gi}r=e.db}else{e=[];for(var i=r.objectStoreNames.length-1;0<=i;i--)e[i]=r.objectStoreNames[i];if(0==e.length)return void t(new Li(r.version));e=r.transaction(e,Fn)}var o=r.objectStoreNames,s=[],a=o.length;for(i=0;i<a;i++){for(var u=e.objectStore(o[i]),l=[],h=0,c=u.indexNames.length;h<c;h++){var f=u.index(u.indexNames[h]);l[h]=new oi(f.keyPath,void 0,f.unique,f.multiEntry,f.name)}s[i]=new gi(u.name,u.keyPath,u.autoIncrement,void 0,l)}t(e=new Li(r.version,s))},t.$a=function(t,e,n,r){var i=this.A;if(!e){e=[];for(var o=i.objectStoreNames.length-1;0<=o;o--)e[o]=i.objectStoreNames[o]}0==e.length?t(null):((e=i.transaction(e,n)).oncomplete=function(t){r("complete",t)},e.onabort=function(t){r("abort",t)},t(e),t=null)},t.close=function(){Qe(this.logger,$e,this+" closing connection"),this.A.close()},t.toString=function(){return"IndexedDB:"+(this.A?this.A.name+":"+this.A.version:"")},fr.push((function(t,e){if(!Kn||e&&"indexeddb"!=e)return null;var n=Kn.deleteDatabase(t),r=new rr("IDBVersionChangeEvent ");return n.onblocked=function(t){fn(r,t)},n.onerror=function(t){r.o(t)},n.onsuccess=function(t){r.callback(t)},r})),k(Ns,zo),(t=Ns.prototype).logger=Xe("ydn.db.con.SimpleStorage"),t.ob=function(){return this.b},t.connect=function(t,e){function r(t,e){setTimeout((function(){e?(rn(i.logger,i+" opening fail"),o.o(e)):(rn(i.logger,i+" version "+i.ob()+" open"),o.callback(t))}),10)}var i=this,o=new Nt;this.c=this.h.wb(t),this.f=t,this.a=e;var s=ko(this.f);this.b=NaN;var a=Ci(this.c.getItem(s));if(n(a.version)&&!l(a.version)&&(a.version=NaN),a)if(a=new Li(a),Ui(this.a,a,!1,!1))if(!this.a.b&&!isNaN(a.version)&&this.a.version>a.version)r(NaN,new mr("existing version "+a.version+" is larger than "+this.a.version));else{var u=this.a.version;for(this.b=n(u)?u:a.version+1,u=0;u<this.a.count();u++)var h=this.a.stores[u]||null;if(this.a instanceof Ki)for(u=0;u<a.count();u++)h=a.stores[u]||null,$i(this.a,h);(u=this.a.toJSON()).version=this.b||NaN,this.c.setItem(s,Ri(u)),r(a.version||NaN)}else{for(u=0;u<this.a.count();u++)h=this.a.stores[u]||null;this.b=a.version||NaN,r(this.b)}else a=e.toJSON(),this.b=1,a.version=this.b,this.c.setItem(s,Ri(a)),r(NaN);return o},t.pb=function(){return!!this.f},t.Mb=function(){return this.c||null},t.qb=function(){},t.Ra=function(){},t.jb=function(){},t.Aa=function(){return"memory"},t.close=function(){},t.$a=function(t,e,n,r){t(new Qo(this,(function(t,e){r(t,e)})))},t.toString=function(){return"SimpleStorage:"+this.Aa()+":"+this.f+":"+this.b},k(Os,Ns),Os.prototype.wb=function(){return window.localStorage},Os.prototype.Aa=function(){return"localstorage"},fr.push((function(t,e){if(!e||"localstorage"==e){var n=new Os,r=new Ki;n.connect(t,r),n.S((function(t){for(var e=0;e<t.stores.length;e++)Xo(n,t.stores[e].getName()).clear()}))}})),k(Is,Ns),Is.prototype.wb=function(){return window.sessionStorage},Is.prototype.Aa=function(){return"sessionstorage"},fr.push((function(t,e){if(!e||"sessionstorage"==e){var n=new Is,r=new Ki;n.connect(t,r),n.S((function(t){for(var e=0;e<t.stores.length;e++)Xo(n,t.stores[e].getName()).clear()}))}})),(t=qs.prototype).connect=function(t,r){function i(e,n){var r=e.version?parseInt(e.version,10):0,i=n.b?isNaN(r)?1:r+1:n.version;en(s.logger,t+": changing version from "+e.version+" to "+i);var a=!1,u=0;e.changeVersion(e.version,i+"",(function(t){s.S((function(e){a=!0;for(var r=0;r<n.count();r++){var i=(i=Fi(e,(n.stores[r]||null).getName()))?xi(i,n.stores[r]||null):null;Ts(s,t,n.stores[r]||null,(function(t){t&&u++}),i)}for(r=0;r<e.count();r++)i=e.stores[r]||null,_i(n,i.getName())||(n instanceof Ki?$i(n,i):(i="DROP TABLE "+Ei(i),rn(s.logger,i),t.executeSql(i,[],(function(){}),(function(t,e){throw e}))))}),t,e)}),(function(n){throw Ze(s.logger,"SQLError "+n+" "+n.code+"("+n.message+") while changing version from "+e.version+" to "+i+" on "+t),n}),(function(){if(a){var r=".";u!=n.stores.length&&(r=" but unexpected stores exists."),nn(s.logger,t+":"+e.version+" ready"+r),o(e)}else tn(s.logger,t+": changing version voided.")}))}function o(t,e){n(e)?(s.F=null,u.o(e)):(s.F=t,u.callback(parseFloat(a)))}var s=this,a=NaN,u=new Nt,l=null;try{"sqlite"==this.b?e.sqlitePlugin?((l=e.sqlitePlugin.openDatabase(t,"",t,this.a)).readTransaction||(l.readTransaction=l.transaction),l.changeVersion=function(t,e,n,r,i){l.transaction(n,r,i)}):(tn(this.logger,"sqlitePlugin not found."),l=null,this.rb=Error("sqlitePlugin not found.")):l=e.openDatabase(t,"",t,this.a)}catch(e){if("SECURITY_ERR"!=e.name)throw e;tn(this.logger,"SECURITY_ERR for opening "+t),l=null,this.rb=new Nr(e)}if(l){a=l.version||"";var h="database "+t+(0==a.length?"":" version "+l.version);null!=r.version&&r.version==l.version?(en(s.logger,"Existing "+h+" opened as requested."),o(l)):this.S((function(t){(t=Ui(r,t,!0,!1))?(0==a?en(s.logger,"New "+h+" created."):r.b?en(s.logger,"Existing "+h+" opened and schema change for "+t):en(s.logger,"Existing "+h+" opened and  schema change to version "+r.version+" for "+t),i(l,r)):(en(s.logger,"Existing "+h+" with same schema opened."),o(l))}),null,l)}else o(null,this.rb);return u},t.Aa=function(){return this.b},t.rb=null,t.F=null,t.Mb=function(){return this.F||null},t.logger=Xe("ydn.db.con.WebSql"),t.qb=function(){},t.Ra=function(){},t.ob=function(){return this.F?parseFloat(this.F.version):void 0},t.S=function(t,e,n){function r(e,n){if(n&&n.rows){for(var r=0;r<n.rows.length;r++){var u=n.rows.item(r);if("__WebKitDatabaseInfoTable__"!=u.name&&"sqlite_sequence"!=u.name&&"table"==u.type){var l="sql"in u?u.sql:void 0;nn(i.logger,"Parsing table schema from SQL: "+l);for(var h,c=l.substr(l.indexOf("("),l.lastIndexOf(")")).match(/(?:"[^"]*"|[^,])+/g),f=void 0,p=(l=[],!1),g=!1,d=0;d<c.length;d++){var v=c[d].match(/\w+|"[^"]+"/g),y=G(v,(function(t){return t.toUpperCase()})),b=B(v[0],'"');if(v=fi(y[1]),-1!=y.indexOf("PRIMARY")&&-1!=y.indexOf("KEY")){if(h=v,a(b)&&!O(b)&&"_ROWID_"!=b){var m=b.split(",");f=b,1<m.length&&(f=m,h=void 0)}-1!=y.indexOf("AUTOINCREMENT")&&(p=!0)}else if("_ROWID_"!=b)if("_default_"==b)g=!0;else{var w="UNIQUE"==y[2];0==b.lastIndexOf(u.tbl_name+"-",0)&&(b=b.substr(u.tbl_name.length+1)),y=new oi(b,v,w),l.push(y)}}if(0==u.name.lastIndexOf("ydn.db.me:",0)){var k=u.name.split(":");if(3<=k.length){var S=k[1];f=new oi(k[2],v,w,!0),c=z(l,(function(t){return t.getName()==k[2]})),0<=c?l[c]=f:l.push(f),c=z(s,(function(t){return t.getName()===S})),0<=c?(d=s[c],s[c]=new gi(d.getName(),d.keyPath,p,h,l,void 0,!g)):s.push(new gi(S,void 0,!1,void 0,[f])),nn(i.logger,'multi entry index "'+f.getName()+'" found in '+S+(-1==c?"*":""))}else tn(i.logger,'Invalid multiEntry store name "'+u.name+'"')}else d=z(s,(function(t){return t.getName()===u.name})),0<=d?(c=s[d].index(0),l.push(c),s[d]=new gi(u.name,f,p,h,l,void 0,!g)):(l=new gi(u.name,f,p,h,l,void 0,!g),s.push(l))}}r=new Li(o,s),t(r)}}var i=this,o=(n=n||this.F)&&n.version?parseFloat(n.version):void 0,s=(o=isNaN(o)?void 0:o,[]);e?e.executeSql("SELECT * FROM sqlite_master",[],r,(function(t,e){throw e})):n.readTransaction((function(e){i.S(t,e,n)}),(function(t){throw Ze(i.logger,"opening tx: "+t.message),t}),r)},t.pb=function(){return!!this.F},t.close=function(){this.F=null},t.$a=function(t,e,n,r){function i(t){nn(a.logger,a+": Tx "+n+" request cause error."),r("abort",t)}function o(){r("complete",{type:"complete"})}function s(e){t(e)}var a=this;null===this.F&&(t(null),r("abort",this.rb)),n==Fn?this.F.readTransaction(s,i,o):n==Un?this.F.changeVersion(this.F.version,this.F.version+1+"",s,i,o):this.F.transaction(s,i,o)},fr.push((function(t,n){if(h(e.openDatabase)&&(!n||"websql"==n)){var r=new qs,i=new Ki;rn(r.logger,"deleting websql database: "+t),i=r.connect(t,i);var o=function(){var e=r.logger;e&&e.log(Fe,"all tables in "+t+" deleted.",void 0)};i.H((function(){r.$a((function(e){e.executeSql('SELECT * FROM sqlite_master WHERE type = "table"',[],(function(n,i){if(i&&i.rows){for(var o=i.rows.length,s=0,a=0;a<o;a++){var u=i.rows.item(a);"__WebKitDatabaseInfoTable__"!=u.name&&"sqlite_sequence"!=u.name&&(s++,nn(r.logger,"deleting table: "+u.name),e.executeSql("DROP TABLE "+u.name))}rn(r.logger,s+' tables deleted from "'+t+'"')}}),(function(t,e){throw e}))}),[],_n,o)})),i.Sb((function(){tn(r.logger,"Connecting "+t+" failed.")}))}})),qs.prototype.jb=function(){},qs.prototype.toString=function(){return"WebSql:"+(this.F?":"+this.F.version:"")},lo.prototype.xb=function(t){return"indexeddb"==t&&Kn?new Es(this.j,this.K):"sqlite"==t&&e.sqlitePlugin?new qs(this.j,"sqlite"):"websql"==t&&h(e.openDatabase)?new qs(this.j):"localstorage"==t&&window.localStorage?new Os:"sessionstorage"==t&&window.sessionStorage?new Is:"memory"==t?new Ns:null},k(Ps,$n),Ps.prototype.a=function(){return{}},Ps.prototype.c=function(t){if(c(t))if(h(t.Wb))t.Wb();else for(var e in t)delete t[e]},Ps.prototype.fa=function(){Ps.B.fa.call(this);for(var t=this.b;t.length;)this.c(t.pop());delete this.b},Xe("goog.debug.Trace"),js.prototype.toString=function(){var t=[];return t.push(this.type," ",this.count," (",Math.round(10*this.time)/10," ms)"),t.join("")},Rs.prototype.toString=function(){return null==this.type?this.c:"["+this.type+"] "+this.c},Cs.prototype.toString=function(){for(var t=[],e=-1,n=[],r=0;r<this.a.length;r++){var i=this.a[r];1==i.a&&n.pop(),t.push(" ",As(i,e,n.join(""))),e=i.b,t.push("\n"),0==i.a&&n.push("|  ")}if(0!=this.c.zb()){var o=m();t.push(" Unstopped timers:\n"),function(t,e){if(s(t))try{V(t,e,void 0)}catch(t){if(t!==fe)throw t}else{t=function(t){if(t instanceof pe)return t;if("function"==typeof t.tb)return t.tb(!1);if(s(t)){var e=0,n=new pe;return n.next=function(){for(;;){if(e>=t.length)throw fe;if(e in t)return t[e++];e++}},n}throw Error("Not implemented")}(t);try{for(;;)e.call(void 0,t.next(),void 0,t)}catch(t){if(t!==fe)throw t}}}(this.c,(function(e){t.push("  ",e," (",o-e.startTime," ms, started at ",Bs(e.startTime),")\n")}))}for(e=this.f.na(),r=0;r<e.length;r++)1<(n=this.f.get(e[r])).count&&t.push(" TOTAL ",n,"\n");return t.push("Total tracers created ",0,"\n","Total comments created ",0,"\n","Overhead start: ",0," ms\n","Overhead end: ",0," ms\n","Overhead comment: ",0," ms\n"),t.join("")},new Cs;var Ls=!ye||ye&&9<=qe,Ms=ye&&!Oe("9");function Fs(t){return Fs[" "](t),t}function _s(t,e){if(Vr.call(this,t?t.type:""),this.b=this.target=null,this.clientY=this.clientX=this.Cb=this.Bb=0,this.a=this.state=null,t){this.a=t,this.type=t.type,this.target=t.target||t.srcElement,this.b=e;var n=t.relatedTarget;if(n&&be)try{Fs(n.nodeName)}catch(t){}Object.defineProperties?Object.defineProperties(this,{Bb:{configurable:!0,enumerable:!0,get:this.Xb,set:this.vc},Cb:{configurable:!0,enumerable:!0,get:this.Yb,set:this.wc}}):(this.Bb=this.Xb(),this.Cb=this.Yb()),this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.state=t.state,t.defaultPrevented&&this.preventDefault()}}!me||Oe("528"),be&&Oe("1.9b")||ye&&Oe("8")||ve&&Oe("9.5")||me&&Oe("528"),be&&!Oe("8")||ye&&Oe("9"),Fs[" "]=function(){},k(_s,Vr),(t=_s.prototype).preventDefault=function(){_s.B.preventDefault.call(this);var t=this.a;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Ms)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}},t.Xb=function(){return me||void 0!==this.a.offsetX?this.a.offsetX:this.a.layerX},t.vc=function(t){Object.defineProperties(this,{Bb:{writable:!0,enumerable:!0,configurable:!0,value:t}})},t.Yb=function(){return me||void 0!==this.a.offsetY?this.a.offsetY:this.a.layerY},t.wc=function(t){Object.defineProperties(this,{Cb:{writable:!0,enumerable:!0,configurable:!0,value:t}})};var Us="closure_listenable_"+(1e6*Math.random()|0),Ks=0;function $s(t,e,n,r,i){this.listener=t,this.a=null,this.src=e,this.type=n,this.Va=!!r,this.eb=i,this.key=++Ks,this.xa=this.Ua=!1}function Ws(t){t.xa=!0,t.listener=null,t.a=null,t.src=null,t.eb=null}function Hs(t){this.src=t,this.a={},this.b=0}function Vs(t,e){var n=e.type;n in t.a&&Q(t.a[n],e)&&(Ws(e),0==t.a[n].length&&(delete t.a[n],t.b--))}function Gs(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.xa&&o.listener==e&&o.Va==!!n&&o.eb==r)return i}return-1}Hs.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Gs(t,e,r,i);return-1<s?(e=t[s],n||(e.Ua=!1)):((e=new $s(e,this.src,o,!!r,i)).Ua=n,t.push(e)),e};var Js="closure_lm_"+(1e6*Math.random()|0),Ys={};function zs(t,e,n,r,i){if(o(e))for(var s=0;s<e.length;s++)zs(t,e[s],n,r,i);else n=aa(n),t&&t[Us]?t.ga.add(String(e),n,!1,r,i):Xs(t,e,n,!1,r,i)}function Xs(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=!!i,a=oa(t);a||(t[Js]=a=new Hs(t)),(n=a.add(e,n,r,i,o)).a||(r=function(){var t=ia,e=Ls?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.a=r,r.src=t,r.listener=n,t.addEventListener?t.addEventListener(e.toString(),r,s):t.attachEvent(ea(e.toString()),r))}function Qs(t,e,n,r,i){if(o(e))for(var s=0;s<e.length;s++)Qs(t,e[s],n,r,i);else n=aa(n),t&&t[Us]?t.ga.add(String(e),n,!0,r,i):Xs(t,e,n,!0,r,i)}function Zs(t,e,n,r,i){if(o(e))for(var s=0;s<e.length;s++)Zs(t,e[s],n,r,i);else n=aa(n),t&&t[Us]?(t=t.ga,(e=String(e).toString())in t.a&&-1<(n=Gs(s=t.a[e],n,r,i))&&(Ws(s[n]),W.splice.call(s,n,1),0==s.length&&(delete t.a[e],t.b--))):t&&(t=oa(t))&&(e=t.a[e.toString()],t=-1,e&&(t=Gs(e,n,!!r,i)),(n=-1<t?e[t]:null)&&ta(n))}function ta(t){if(!l(t)&&t&&!t.xa){var e=t.src;if(e&&e[Us])Vs(e.ga,t);else{var n=t.type,r=t.a;e.removeEventListener?e.removeEventListener(n,r,t.Va):e.detachEvent&&e.detachEvent(ea(n),r),(n=oa(e))?(Vs(n,t),0==n.b&&(n.src=null,e[Js]=null)):Ws(t)}}}function ea(t){return t in Ys?Ys[t]:Ys[t]="on"+t}function na(t,e,n,r){var i=!0;if((t=oa(t))&&(e=t.a[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var o=e[t];o&&o.Va==n&&!o.xa&&(o=ra(o,r),i=i&&!1!==o)}return i}function ra(t,e){var n=t.listener,r=t.eb||t.src;return t.Ua&&ta(t),n.call(r,e)}function ia(t,e){if(t.xa)return!0;if(!Ls){var n=e||r("window.event"),i=new _s(n,this),o=!0;if(!(0>n.keyCode||null!=n.returnValue)){t:{var s=!1;if(0==n.keyCode)try{n.keyCode=-1;break t}catch(t){s=!0}(s||null==n.returnValue)&&(n.returnValue=!0)}for(n=[],s=i.b;s;s=s.parentNode)n.push(s);s=t.type;for(var a=n.length-1;0<=a;a--){i.b=n[a];var u=na(n[a],s,!0,i);o=o&&u}for(a=0;a<n.length;a++)i.b=n[a],u=na(n[a],s,!1,i),o=o&&u}return o}return ra(t,new _s(e,this))}function oa(t){return(t=t[Js])instanceof Hs?t:null}var sa="__closure_events_fn_"+(1e9*Math.random()>>>0);function aa(t){return h(t)?t:(t[sa]||(t[sa]=function(e){return t.handleEvent(e)}),t[sa])}function ua(){$n.call(this),this.ga=new Hs(this),this.b=this,this.a=null}function la(t,e,n,r){if(!(e=t.ga.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.xa&&s.Va==n){var a=s.listener,u=s.eb||s.src;s.Ua&&Vs(t.ga,s),i=!1!==a.call(u,r)&&i}}return i&&0!=r.ec}function ha(t){return t.h||(t.h=new ua),t.h}function ca(t,e,n){co.call(this,t,e,n)}function fa(t,e){yr.call(this,t,e)}function pa(t,e){yr.call(this,t,e)}function ga(t,e){yr.call(this,t,e)}function da(t,e,n){this.db=t,this.b=e,this.type=n||0,this.c=null}function va(t,e,n,r){this.c=t,this.a=e||null,this.h=!!n,this.g=!!r,this.b=[],this.f=[]}function ya(t,e){for(var n=e.length-1;0<=n&&e[n]==t.b[t.b.length-1];n--)e=e.slice(0,n);if(t.f=e,t.a&&t.b[0]){if(t.a.lower!=t.a.upper)throw new br("Ordering no allowed with range query");t.a=mn([t.a.lower])}return null}function ba(t,e){if((0!=t.b.length||0!=t.f.length)&&ka(t)&&!ma(t))throw new br('Require index "'+t.b.concat(t.f).join(", ")+'" not found in store "'+t.c.getName()+'"');var n=new Xn(t.c.getName(),wa(t),t.a,t.h,t.g,!!e);return n.C=t.b.length,n}function ma(t){var e=t.b.concat(t.f),n=ki(t.c,e);return n||e[e.length-1]==t.c.keyPath&&(n=ki(t.c,e.slice(0,e.length-1)))?n:null}function wa(t){return(t=ma(t))?t.getName():void 0}function ka(t){return 0<t.b.length||(1==t.f.length?t.f[0]!=t.c.keyPath:1<t.f.length)}function Sa(t,e,n,r){da.call(this,t,e,n),this.a=r}function Ea(t,e,n,r){da.call(this,t,e,n),this.a=r}function xa(t){return ba(t.a,!(2==t.type||3==t.type||1==t.type))}function Na(){this.a=m()}k(ua,$n),ua.prototype[Us]=!0,ua.prototype.addEventListener=function(t,e,n,r){zs(this,t,e,n,r)},ua.prototype.removeEventListener=function(t,e,n,r){Zs(this,t,e,n,r)},ua.prototype.fa=function(){if(ua.B.fa.call(this),this.ga){var t,e=this.ga;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Ws(n[r]);delete e.a[t],e.b--}}this.a=null},lo.prototype.addEventListener=function(t,e,n,r){if("ready"==t)Qs(ha(this),t,e,n,r);else{var i="created error fail ready deleted updated versionchange".split(" "),o=function(t){if(!(0<=H(i,t)))throw new on('Invalid event type "'+t+'"')};if(s(t))for(var a=0;a<t.length;a++)o(t[a]);else o(t);zs(ha(this),t,e,n,r)}},lo.prototype.removeEventListener=function(t,e,n,r){Zs(ha(this),t,e,n,r)},lo.prototype.J=function(t){var e,n,r=ha(this),i=r.a;if(i)for(e=[];i;i=i.a)e.push(i);if(r=r.b,i=t.type||t,a(t))t=new Vr(t,r);else if(t instanceof Vr)t.target=t.target||r;else{var o=t;lt(t=new Vr(i,r),o)}if(o=!0,e)for(var s=e.length-1;0<=s;s--)o=la(n=t.b=e[s],i,!0,t)&&o;if(o=la(n=t.b=r,i,!0,t)&&o,o=la(n,i,!1,t)&&o,e)for(s=0;s<e.length;s++)o=la(n=t.b=e[s],i,!1,t)&&o},k(ca,Ss),k(fa,yr),fa.prototype.h=function(){return!1},fa.prototype.c=function(t,e){var r=[],i=!0;return function e(o){n(t[o])?(i=!1,r[o]=!0):(r[o]=!1,0<=o-1&&e(o-1))}(t.length-1),i&&(r=[]),function(t,e,r){var i,o=null!=i;if(!n(i)){o=null!=(i=r[0]);for(var s=1;o&&s<r.length;s++)null!=r[s]&&0==cr(r[s],i)||(o=!1)}return o&&(t.g++,t.a&&(t.f?t.a.push(i,void 0):t.a.push(i)),n(t.i)&&t.g>=t.i)?[]:e}(this,r,e)},k(pa,yr),pa.prototype.c=function(t,e){var n=[],r=e[0];if(null==r)return[];for(var i=!0,o=!1,s=r,a=[],u=1;u<t.length;u++)if(null!=e[u]){var l=cr(r,e[u]);a[u]=l,this.b?-1==l?i=!1:1==l&&(i=!1,o=!0,-1==cr(e[u],s)&&(s=e[u])):1==l?i=!1:-1==l&&(i=!1,o=!0,1==cr(e[u],s)&&(s=e[u]))}else i=!1,o=!0;if(i)for(o=0;o<t.length;o++)null!=e[o]&&(n[o]=!0);else if(o)for(o=0;o<t.length;o++)null!=e[o]&&(this.b?-1==cr(s,e[o])&&(n[o]=s):1==cr(s,e[o])&&(n[o]=s));else for(u=this.b?-1:1,o=1;o<t.length;o++)a[o]===u&&(n[o]=r);return i?(this.g++,this.a&&this.a.push(s),n):{continuePrimary:n}},k(ga,yr),ga.prototype.logger=Xe("ydn.db.algo.ZigzagMerge"),ga.prototype.c=function(t,e){function n(t,e){var n=t.slice(0,t.length-1);return n.push(e),n}function r(t){return t[t.length-1]}var i=[];if(0==t.length||null==t[0]||null==t[0])return[];for(var o=!0,s=0,a=r(t[s]),u=[],l=1;l<t.length;l++){if(null==t[l])return[];var h=r(t[l]),c=cr(a,h);u[l]=c,this.b?-1==c?o=!1:1==c&&(o=!1,a=h,s=1):1==c?o=!1:-1==c&&(o=!1,a=h,s=1)}if(l=this.b?-1:1,o){for(o=0;o<t.length;o++)null!=t[o]&&(i[o]=!0);return this.a&&(this.f?this.a.push(e[0],a):this.a.push(e[0])),i}if(0==s)for(o=1;o<t.length;o++)u[o]==l&&(i[o]=n(t[o],a));else for(o=0;o<t.length;o++)o!=s&&null!=t[o]&&cr(a,r(t[o]))===l&&(i[o]=n(t[o],a));return{continue:i}},w("ydn.db.algo.NestedLoop",fa),w("ydn.db.algo.ZigzagMerge",ga),w("ydn.db.algo.SortedMerge",pa),Zi.prototype.close=Zi.prototype.close,Zi.prototype.getType=Zi.prototype.Ba,Zi.prototype.getName=Zi.prototype.getName,Zi.prototype.getSchema=Zi.prototype.N,Zi.prototype.onReady=Zi.prototype.ib,Zi.prototype.setName=Zi.prototype.C,Zi.prototype.transaction=Zi.prototype.transaction,Zi.prototype.db=Zi.prototype.Kc,w("ydn.db.version","1.3.0"),w("ydn.db.cmp",cr),w("ydn.db.deleteDatabase",(function(t,e){for(var n,r=0;r<fr.length;r++){var i=fr[r](t,e);i&&(n=i)}return n||hr("IDBVersionChangeEvent ",null)})),Qr.prototype.name=Qr.prototype.name,Qr.prototype.getVersion=Qr.prototype.Nc,Qr.prototype.getOldVersion=Qr.prototype.oc,Qr.prototype.getOldSchema=Qr.prototype.nc,Zr.prototype.getError=Zr.prototype.c,rr.prototype.abort=rr.prototype.abort,rr.prototype.canAbort=rr.prototype.lc,cn.prototype.progress=cn.prototype.Tb,cn.prototype.promise=cn.prototype.zc,w("ydn.db.KeyRange",pn),pn.only=dn,pn.bound=vn,pn.upperBound=yn,pn.lowerBound=bn,fo.prototype.countOf=fo.prototype.Ga,fo.prototype.keysOf=fo.prototype.Ka,fo.prototype.open=fo.prototype.open,fo.prototype.scan=fo.prototype.Lc,fo.prototype.valuesOf=fo.prototype.Na,Wr.prototype.countOf=Wr.prototype.Ga,Wr.prototype.keysOf=Wr.prototype.Ka,Wr.prototype.open=Wr.prototype.open,Wr.prototype.scan=Wr.prototype.Nb,Wr.prototype.valuesOf=Wr.prototype.Na,Vn.prototype.getKey=Vn.prototype.Mc,Vn.prototype.getPrimaryKey=Vn.prototype.T,Vn.prototype.getValue=Vn.prototype.Ca,Vn.prototype.update=Vn.prototype.update,Vn.prototype.clear=Vn.prototype.clear,w("ydn.db.Iterator",Xn),w("ydn.db.KeyIterator",Qn),w("ydn.db.ValueIterator",tr),w("ydn.db.IndexIterator",Zn),w("ydn.db.IndexValueIterator",er),Xn.prototype.getState=Xn.prototype.pc,Xn.prototype.getKeyRange=Xn.prototype.gc,Xn.prototype.getIndexName=Xn.prototype.Ac,Xn.prototype.getStoreName=Xn.prototype.Dc,Xn.prototype.isReversed=Xn.prototype.da,Xn.prototype.isUnique=Xn.prototype.za,Xn.prototype.isKeyIterator=Xn.prototype.Ec,Xn.prototype.isIndexIterator=Xn.prototype.qc,Xn.prototype.getPrimaryKey=Xn.prototype.Cc,Xn.prototype.getKey=Xn.prototype.Bc,Xn.prototype.resume=Xn.prototype.hc,Xn.prototype.reset=Xn.prototype.Jb,Xn.prototype.reverse=Xn.prototype.reverse,Qn.where=function(t,e,n,r,i){return new Qn(t,Nn(e,n,r,i))},tr.where=function(t,e,n,r,i){return new tr(t,Nn(e,n,r,i))},Zn.where=function(t,e,n,r,i,o){return new Zn(t,e,Nn(n,r,i,o))},er.where=function(t,e,n,r,i,o){return new er(t,e,Nn(n,r,i,o))},w("ydn.db.Streamer",gr),gr.prototype.push=gr.prototype.push,gr.prototype.collect=gr.prototype.Jc,gr.prototype.setSink=gr.prototype.xc,lo.prototype.branch=lo.prototype.kc,lo.prototype.getTxNo=lo.prototype.Pc,_r.prototype.getTxNo=_r.prototype.Oc,lo.prototype.run=lo.prototype.tc,co.prototype.branch=co.prototype.kc,co.prototype.add=co.prototype.add,co.prototype.addAll=co.prototype.Ta,co.prototype.get=co.prototype.get,co.prototype.keys=co.prototype.keys,co.prototype.keysByIndex=co.prototype.Ja,co.prototype.values=co.prototype.values,co.prototype.valuesByIndex=co.prototype.Ma,co.prototype.put=co.prototype.put,co.prototype.putAll=co.prototype.kb,co.prototype.clear=co.prototype.clear,co.prototype.remove=co.prototype.sb,co.prototype.count=co.prototype.count,$r.prototype.add=$r.prototype.add,$r.prototype.addAll=$r.prototype.Ta,$r.prototype.get=$r.prototype.get,$r.prototype.keys=$r.prototype.keys,$r.prototype.keysByIndex=$r.prototype.Ja,$r.prototype.values=$r.prototype.values,$r.prototype.valuesByIndex=$r.prototype.Ma,$r.prototype.put=$r.prototype.put,$r.prototype.putAll=$r.prototype.kb,$r.prototype.clear=$r.prototype.clear,$r.prototype.remove=$r.prototype.sb,$r.prototype.count=$r.prototype.count,w("ydn.db.Key",qr),qr.prototype.id=qr.prototype.mc,qr.prototype.parent=qr.prototype.Fc,qr.prototype.storeName=qr.prototype.Gc,w("ydn.db.KeyRange",pn),pn.upperBound=yn,pn.lowerBound=bn,pn.bound=vn,pn.only=dn,pn.starts=mn,Xr.prototype.store_name=Xr.prototype.s,Xr.prototype.getStoreName=Xr.prototype.a,ei.prototype.name=ei.prototype.name,ei.prototype.getKey=ei.prototype.c,ei.prototype.getValue=ei.prototype.f,ni.prototype.name=ni.prototype.name,ni.prototype.getKeys=ni.prototype.na,ni.prototype.getValues=ni.prototype.cb,va.prototype.clone=function(){var t=new va(this.c,this.a,this.h,this.g);return t.f=this.f.slice(),t.b=this.b.slice(),t},va.prototype.reverse=function(){var t=this.clone();return t.h=!this.h,t},va.prototype.unique=function(t){var e=this.clone();return e.g=!!t,e},va.prototype.v=function(t,e,n,r,i){if(n=Nn(e,n,r,i),0<this.b.length){if(!this.a)return"cannot use where clause with existing filter";if(null!=this.a.lower&&null!=this.a.upper&&0==cr(this.a.lower,this.a.upper))t=o(this.a.lower)?this.a.lower.slice().push(e):[this.a.lower,e],r=null!=r?r:"￿",n=o(this.a.upper)?this.a.upper.slice().push(r):[this.a.upper,r],this.a=Nn(e,t,r,n);else{if(!(1==this.b.length&&this.b[0]==t||o(t)&&tt(this.b,t)))return"cannot use where clause with existing filter";this.a=this.a.ka(n)}}else this.b=o(t)?t:[t],this.a=this.a?this.a.ka(n):n;return null},k(Sa,da),Sa.prototype.open=function(){var t={push:function(){}};return t=function(t){for(var e=0;e<t.a.length;e++)if(0<t.a[e].b.length)return!0;return!1}(this)?new ga(t):new pa(t),this.db.Nb(t,function(t){for(var e=[],n=0;n<t.a.length;n++)e[n]=ba(t.a[n]);return e}(this),_n)},Sa.prototype.Ab=function(){return this.a.slice()},Sa.prototype.select=function(){throw Error("not impl")},Sa.prototype.reverse=function(){var t=this.a.map((function(t){return t.reverse()}));return new Sa(this.db,this.b,this.type,t)},k(Ea,da),(t=Ea.prototype).Hc=function(){return new Ea(this.db,this.b,this.type,this.a.clone())},t.reverse=function(){var t=this.a.reverse();return new Ea(this.db,this.b,this.type,t)},t.unique=function(t){if(!u(t))throw new on("unique value must be a boolean, but "+typeof t+" found");return t=this.a.unique(t),new Ea(this.db,this.b,this.type,t)},t.X=function(t){var e=a(t)?[t]:t;if(e=ya(t=this.a.clone(),e))throw Error(e);return new Ea(this.db,this.b,this.type,t)},t.v=function(t,e,n,r,i){if(wa(this.a)&&wa(this.a)!=t){var o=Nn(e,n,r,i);return o=new va(Fi(this.b,this.a.c.getName()),o,this.a.h,this.a.g),this.ka(new Ea(this.db,this.b,this.type,o))}if(!wa(this.a)&&!Si(Fi(this.b,this.a.c.getName()),t))throw new on('index "'+t+'" not exists in '+this.a.c.getName());if(t=(o=this.a.clone()).v(t,e,n,r,i))throw new on(t);return new Ea(this.db,this.b,this.type,o)},t.select=function(t){var e=Fi(this.b,this.a.c.getName()),r=a(t)?[t]:t,i=this.type;if(t=this.a.clone(),i=wa(this.a),1==r.length)if("_ROWID_"==(i=r[0])||i==e.keyPath)i=2;else if(i&&"*"!=i){if(!Si(e,i))throw new on('Invalid select "'+i+'", index not found in store "'+e.getName()+'"');if(e=ya(t,r))throw new on(e);i=1}else i=4;else{if(2!=r.length)throw new on("Selecting more than 2 field names is not supported, but "+r.length+" fields selected.");if(!i)throw new on("Only primary key can be selected for this query.");for(var o=0;2>o;o++){var u;if(u="_ROWID_"!=r[o]){u=e;var l=r[o];u=!(n(u.keyPath)&&(1==u.h.length?u.keyPath===l:s(l)&&tt(u.h,l)))}if(u&&r[o]!=i)throw new on('select field name must be "'+i+'", but "'+r[o]+'" found.')}i=3}return new Ea(this.db,this.b,i,t)},t.Ic=function(t){t=t||100;var e=4,n=xa(this);return this.c&&this.c[0]&&(n=n.hc(this.c[0],this.c[1])),2!=this.type&&3!=this.type&&1!=this.type||(e=this.type),t=function(t,e,n,r){var i=n.b,o=n.c||null,s=r||100;rn(t.logger,"listIter:"+e+" "+n+(r?" limit="+s:""));var a=t.a.request("values:iter:index",[i]),u="done"==n.g||n.g==nr?[]:[n.i,n.j];return ur(a,(function(){Ur(this).$(a,e,i,o,n.gc(),s,0,n.da(),n.za(),u)}),t),a.H((function(){null!=u[0]?n.Jb("rest",u[0],u[1]):n.Jb()})),a}(this.db,e,n,t),t.H((function(){"rest"==n.g&&(this.c=[n.i,n.j])}),this),t},t.Ab=function(){return[this.a.clone()]},t.sc=function(t,e){var n=xa(this);if(n.f&&(n=new Xn(n.b,n.c,n.a,n.da(),n.za(),!1,n.h)),1>arguments.length)throw new on("too few arguments");if(2==arguments.length){if(!a(t)&&o(t)){if(!o(e))throw new on("an array is expected for second argument but, "+ji(e)+" of type "+typeof e+" found");if(t.length!=e.length)throw new on("length of two input arguments must be equal but, "+t.length+" and "+e.length+" found")}}else{if(1!=arguments.length)throw new on("too many arguments");if(!c(t))throw new on("an object is expected but, "+ji(t)+" of type "+typeof t+" found")}var r=this.db.open((function(n){var i=n.Ca();if(a(t))qn(i,t,e);else if(o(t))for(var s=0;s<t.length;s++)qn(i,t[s],e[s]);else if(c(t))for(s in t)t.hasOwnProperty(s)&&(i[s]=t[s]);!function(t,e){e instanceof Nt?t.H(v(e.ia,e)):t.H((function(){return e}))}(r,n.update(i))}),n,_n,this);return r},t.open=function(t,e){return this.db.open(t,xa(this),_n,e)},t.count=function(){return ka(this.a)?this.a.g?this.db.count(ba(this.a)):this.db.count(this.a.c.getName(),wa(this.a),this.a.a):this.db.count(this.a.c.getName(),this.a.a)},t.clear=function(){return ka(this.a)?this.db.clear(this.a.c.getName(),wa(this.a),this.a.a):this.db.clear(this.a.c.getName(),this.a.a)},t.ka=function(t){return t=t.Ab().concat(this.Ab()),new Sa(this.db,this.b,this.type,t)},fo.prototype.V=function(t,e,r,i,o){if(!a(t))throw new TypeError('store name "'+t+'"');if(!_i(this.a,t))throw new on('Store "'+t+'" not found.');var s=null;if(n(e)){if(!n(r))throw new on("boundary value must be defined.");s=Nn(e,r,i,o)}else if(n(i))throw new on("second boundary must not be defined.");return t=new va(Fi(this.a,t),s),new Ea(this.c,this.a,null,t)},Wr.prototype.V=function(t,e,r,i,o){if(!a(t))throw new TypeError('store name "'+t+'"');if(!_i(this.b,t))throw new on('Store "'+t+'" not found.');var s=null;if(n(e)){if(!n(r))throw new on("boundary value must be defined.");s=Nn(e,r,i,o)}else if(n(i))throw new on("second boundary must not be defined.");return t=new va(Fi(this.b,t),s),new Ea(this,this.b,null,t)},Xe("ydn.db.query.ConjunctionCursor"),Ea.prototype.copy=Ea.prototype.Hc,Ea.prototype.count=Ea.prototype.count,Ea.prototype.list=Ea.prototype.Ic,Ea.prototype.order=Ea.prototype.X,Ea.prototype.patch=Ea.prototype.sc,Ea.prototype.reverse=Ea.prototype.reverse,Ea.prototype.unique=Ea.prototype.unique,Ea.prototype.where=Ea.prototype.v,fo.prototype.from=fo.prototype.V,Wr.prototype.from=Wr.prototype.V,Ss.prototype.executeSql=Ss.prototype.executeSql,ks.prototype.executeSql=ks.prototype.executeSql,lo.prototype.addEventListener=lo.prototype.addEventListener,lo.prototype.removeEventListener=lo.prototype.removeEventListener;var Oa=new Na;function Ia(t){this.g=t||"",this.h=Oa}function qa(t){return Ta((t=new Date(t.g)).getFullYear()-2e3)+Ta(t.getMonth()+1)+Ta(t.getDate())+" "+Ta(t.getHours())+":"+Ta(t.getMinutes())+":"+Ta(t.getSeconds())+"."+Ta(Math.floor(t.getMilliseconds()/10))}function Ta(t){return 10>t?"0"+t:String(t)}function Pa(t,e){var n=(t.g-e)/1e3,r=n.toFixed(3),i=0;if(1>n)i=2;else for(;100>n;)i++,n*=10;for(;0<i--;)r=" "+r;return r}function Ca(t){Ia.call(this,t)}function ja(t,n){var i;switch(n.f.value){case Be.value:i="dbg-sh";break;case Le.value:i="dbg-sev";break;case Me.value:i="dbg-w";break;case Fe.value:i="dbg-i";break;default:i="dbg-f"}(o=[]).push(t.g," "),t.a&&o.push("[",qa(n),"] "),o.push("[",Pa(n,t.h.get()),"s] "),o.push("[",n.b,"] ");var o=re(o.join("")),s=ce;if(t.b&&n.a){var u;s=ae("br");try{var l,h,c=n.a,f=r("window.location.href");if(a(c))l={message:c,name:"Unknown error",lineNumber:"Not available",fileName:f,stack:"Not available"};else{var p,g,d=!1;try{p=c.lineNumber||c.Rc||"Not available"}catch(t){p="Not available",d=!0}try{g=c.fileName||c.filename||c.sourceURL||e.$googDebugFname||f}catch(t){g="Not available",d=!0}l=!d&&c.lineNumber&&c.fileName&&c.stack&&c.message&&c.name?c:{message:c.message||"Not available",name:c.name||"UnknownError",lineNumber:p,fileName:g,stack:c.stack||"Not available"}}var v,y=l.fileName;null!=y||(y=""),/^https?:\/\//i.test(y)?((c=y)instanceof Ht?v=c:(c=c.oa?c.ha():String(c),c=Gt.test(c)?function(t){try{var e=encodeURI(t)}catch(t){return"about:invalid#zClosurez"}return e.replace(Jt,(function(t){return Yt[t]}))}(c):"about:invalid#zClosurez",v=Xt(c)),Ft("view-source scheme plus HTTP/HTTPS URL"),h=Xt("view-source:"+Vt(v))):h=Xt(Lt(Ft("sanitizedviewsrc"))),u=ue(re("Message: "+l.message+"\nUrl: "),ae("a",{href:h,target:"_new"},l.fileName),re("\nLine: "+l.lineNumber+"\n\nBrowser stack:\n"+l.stack+"-> [end]\n\nJS stack traversal:\n"+Te(void 0)+"-> "))}catch(t){u=re("Exception trying to expose exception! You win, we lose. "+t)}s=ue(s,u)}return i=ae("span",{class:i},ue(u=re(n.c),s)),t.c?ue(o,i,ae("br")):ue(o,i)}function Ra(t){Ia.call(this,t)}function Aa(){this.g=v(this.h,this),this.a=new Ra,this.a.a=!1,this.a.b=!1,this.b=this.a.c=!1,this.c="",this.f={}}Na.prototype.set=function(t){this.a=t},Na.prototype.get=function(){return this.a},Ia.prototype.c=!0,Ia.prototype.a=!0,Ia.prototype.b=!1,k(Ca,Ia),Ca.prototype.b=!0,Ca.prototype.f=function(t){return t?ja(this,t).ha():""},k(Ra,Ia),Ra.prototype.f=function(t){var e=[];return e.push(this.g," "),this.a&&e.push("[",qa(t),"] "),e.push("[",Pa(t,this.h.get()),"s] "),e.push("[",t.b,"] "),e.push(t.c),this.b&&(t=t.a)&&e.push("\n",t instanceof Error?t.message:t.toString()),this.c&&e.push("\n"),e.join("")},Aa.prototype.h=function(t){if(!this.f[t.b]){var e=this.a.f(t),n=Da;if(n)switch(t.f){case Be:Ba(n,"info",e);break;case Le:Ba(n,"error",e);break;case Me:Ba(n,"warn",e);break;default:Ba(n,"debug",e)}else this.c+=e}};var Da=e.console;function Ba(t,e,n){t[e]?t[e](n):t.log(n)}var La=!ye||ye&&9<=qe;!be&&!ye||ye&&ye&&9<=qe||be&&Oe("1.9.1"),ye&&Oe("9");var Ma={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function Fa(t){if(t&&"number"==typeof t.length){if(c(t))return"function"==typeof t.item||"string"==typeof t.item;if(h(t))return"function"==typeof t.item}return!1}function _a(t){this.a=t||e.document||document}function Ua(t,e){var n;n=t.a;var r=e&&"*"!=e?e.toUpperCase():"";return n.querySelectorAll&&n.querySelector&&r?n.querySelectorAll(r+""):n.getElementsByTagName(r||"*")}function Ka(t){ye&&n(t.cssText)?t.cssText=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}":t.innerHTML=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}"}function $a(t){this.g=v(this.h,this),this.b=new Ca,this.c=this.b.a=!1,this.a=t,this.f=this.a.ownerDocument||this.a.document;var e=null,n=(t=(t=this.a)?new _a(9==t.nodeType?t:t.ownerDocument||t.document):b||(b=new _a)).a;ye&&n.createStyleSheet?Ka(e=n.createStyleSheet()):((n=Ua(t,"head")[0])||(e=Ua(t,"body")[0],n=t.b("head"),e.parentNode.insertBefore(n,e)),Ka(e=t.b("style")),n.appendChild(e)),this.a.className+=" logdiv"}_a.prototype.b=function(t,e,n){var r=this.a,i=arguments,u=i[0],l=i[1];if(!La&&l&&(l.name||l.type)){if(u=["<",u],l.name&&u.push(' name="',q(l.name),'"'),l.type){u.push(' type="',q(l.type),'"');var h={};lt(h,l),delete h.type,l=h}u.push(">"),u=u.join("")}return u=r.createElement(u),l&&(a(l)?u.className=l:o(l)?u.className=l.join(" "):function(t,e){!function(t,e){for(var n in t)e.call(void 0,t[n],n,t)}(e,(function(e,n){"style"==n?t.style.cssText=e:"class"==n?t.className=e:"for"==n?t.htmlFor=e:n in Ma?t.setAttribute(Ma[n],e):0==n.lastIndexOf("aria-",0)||0==n.lastIndexOf("data-",0)?t.setAttribute(n,e):t[n]=e}))}(u,l)),2<i.length&&function(t,e,n){function r(n){n&&e.appendChild(a(n)?t.createTextNode(n):n)}for(var i=2;i<n.length;i++){var o=n[i];!s(o)||c(o)&&0<o.nodeType?r(o):V(Fa(o)?Z(o):o,r)}}(r,u,i),u},_a.prototype.contains=function(t,e){if(t.contains&&1==e.nodeType)return t==e||t.contains(e);if(void 0!==t.compareDocumentPosition)return t==e||Boolean(16&t.compareDocumentPosition(e));for(;e&&t!=e;)e=e.parentNode;return e==t},$a.prototype.h=function(t){if(t){var e=100>=this.a.scrollHeight-this.a.scrollTop-this.a.clientHeight,n=this.f.createElement("div");n.className="logmsg",t=ja(this.b,t),n.innerHTML=ee(t),this.a.appendChild(n),e&&(this.a.scrollTop=this.a.scrollHeight)}},$a.prototype.clear=function(){this.a&&(this.a.innerHTML=ee(ce))};var Wa=null,Ha=null;Xe("ydn.debug"),w("ydn.debug.log",(function(t,e,r){if(t=t||"ydn",l(e))e=new De("log",e);else if(a(e)){if(e=e.toUpperCase(),!He){He={};for(var i,o=0;i=We[o];o++)He[i.value]=i,He[i.name]=i}e=He[e]||null}else e=Ue;(o=Xe(t))?o.b=e:window.console.log("logger "+t+" not available."),n(r)?!Ha&&(1!=(t=Ha=new $a(r)).c&&(r=ze(),e=t.g,r.a||(r.a=[]),r.a.push(e),t.c=!0),t=ze())&&(t.b=Me):!Wa&&!Ha&&(1!=(t=Wa=new Aa).b&&(r=ze(),e=t.g,r.a||(r.a=[]),r.a.push(e),t.b=!0),t=ze())&&(t.b=Me)})),w("ydn.db.Storage",ca)}()}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var o=e[r]={exports:{}};return t[r](o,o.exports,n),o.exports}(()=>{"use strict";function t(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)t[r]=n[r]}return t}n(331);var e=function e(n,r){function i(e,i,o){if("undefined"!=typeof document){"number"==typeof(o=t({},r,o)).expires&&(o.expires=new Date(Date.now()+864e5*o.expires)),o.expires&&(o.expires=o.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var s="";for(var a in o)o[a]&&(s+="; "+a,!0!==o[a]&&(s+="="+o[a].split(";")[0]));return document.cookie=e+"="+n.write(i,e)+s}}return Object.create({set:i,get:function(t){if("undefined"!=typeof document&&(!arguments.length||t)){for(var e=document.cookie?document.cookie.split("; "):[],r={},i=0;i<e.length;i++){var o=e[i].split("="),s=o.slice(1).join("=");try{var a=decodeURIComponent(o[0]);if(r[a]=n.read(s,a),t===a)break}catch(t){}}return t?r[t]:r}},remove:function(e,n){i(e,"",t({},n,{expires:-1}))},withAttributes:function(n){return e(this.converter,t({},this.attributes,n))},withConverter:function(n){return e(t({},this.converter,n),this.attributes)}},{attributes:{value:Object.freeze(r)},converter:{value:Object.freeze(n)}})}({read:function(t){return'"'===t[0]&&(t=t.slice(1,-1)),t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(t){return encodeURIComponent(t).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"});function r(t,e){const n=i();return(r=function(t,e){return n[t-=463]})(t,e)}function i(){const t=["Enter the Task Name","task_name","log",".clock-toggle-inp","clone","trigger","parent","24mjaxpU","7UtbSpC","1701TmbtQz","prop","2172PTaDwd","SELECT * FROM tasks","fail","#runner","css","animate__fadeInDown","ccs","animate__fadeOutDown","background","fflow",".task-flow-count","error","./assets/templates/task.html","val","report","Error!","parseHTML","black",".clock-current-task-div","click","1171284TDoFVT","#1F2733",".task-id-","flowfocus","6Moizcz","wait","strict","45792Nwnxhb","task_description","task-name","Cool",".reset","append","remove",".add_task_btn","flow","attr","flowbreakchange","popup-default-confirm","task_id","logtime",".task-desp","889854qSfGph","length","addClass","each","get","then","<div>","find","breaktime","current_flow",".task-name",".task-container","7043608QDWtMo","when","done","text","error: ","after",".task-id-div",".show-report","set","popup-text-color",".task-card","focus","now","hasClass","cst","task-id-","put","1792820hrECvh","#taskholder","00:00:00","200","33BbHlpi","tasks","91192cOLZcw","140REFuPZ","Task Name is too much long :(","delegate"];return(i=function(){return t})()}!function(t,e){const n=r,i=t();for(;;)try{if(290640==parseInt(n(501))/1*(-parseInt(n(489))/2)+-parseInt(n(502))/3*(parseInt(n(504))/4)+parseInt(n(483))/5*(parseInt(n(528))/6)+parseInt(n(546))/7*(parseInt(n(500))/8)+-parseInt(n(531))/9*(parseInt(n(490))/10)+-parseInt(n(487))/11*(parseInt(n(524))/12)+parseInt(n(466))/13)break;i.push(i.shift())}catch(t){i.push(i.shift())}}(i),$(document).ready((function(){const t=r;let n={stores:[{name:t(488),keyPath:"task_id",autoIncrement:!0,indexes:[{name:t(494),keyPath:t(494),multiEntry:!0},{name:t(532),keyPath:t(532),multiEntry:!0},{name:t(539),keyPath:"flow",multiEntry:!0}]},{name:t(518),keyPath:t(544),autoIncrement:!1,indexes:[{name:"task_id",keyPath:t(543),multiEntry:!0},{name:"flowtime",keyPath:"flowtime",multiEntry:!0},{name:t(554),keyPath:"breaktime",multiEntry:!0},{name:t(539),keyPath:t(539)}]}]},i=new ydn.db.Storage(t(527),n);$[t(550)](t(516),(function(n){const r=t;let o=$(r(552))[r(536)]($[r(520)](n)).find(r(484));$(r(538)).click((function(){const t=r;let e=$(".task_name_inp")[t(517)](),n=e[t(547)],s="Task Description";if(n>0&&n<=15){let n=i[t(482)](t(488),{task_name:e,task_description:s,flow:0});n[t(468)]((function(n){const r=t;let i=o[r(497)]();i[r(553)](r(464))[r(517)](e).parent()[r(540)]("task_id",n),i[r(548)](r(481)+n),i[r(553)](r(545))[r(517)](s),i[r(553)](r(514))[r(540)]("current_flow",0),i[r(548)](r(509)),$(r(465))[r(536)](i)[r(529)](500).after((function(){const t=r;i[t(553)](t(473))[t(477)]()}))})),n.fail((function(e){console[t(495)](e)}))}else Swal.fire({customClass:{popup:t(475),confirmButton:t(542)},title:t(519),text:t(0==n?493:491),icon:t(515),confirmButtonText:t(534)})})),i.executeSql(r(505))[r(551)]((function(t){const n=r;$[n(467)]($[n(549)](t,(function(t,e){const r=n;let i=o[r(497)]();i.find(".task-name").val(e[r(494)])[r(499)]()[r(540)](r(543),e.task_id),i[r(548)](r(481)+e.task_id),i[r(553)](r(545))[r(517)](e[r(532)]),i[r(553)](r(514)).text(e[r(539)]).attr(r(463),parseInt(e[r(539)])+1),$(".task-container")[r(536)](i)}))).then((function(){const t=n;$(t(472))[t(549)]((function(n,r){const i=t;String(e[i(550)](i(480)))==String($(this)[i(540)](i(543)))&&($(this).css(i(512),i(521)),$(i(522))[i(469)]($(this)[i(553)](".task-name")[i(517)]()))}))}))}),(function(t){const e=r;console[e(495)](e(470),t)})),$(".task-container")[r(492)](".task-delete",r(523),(function(){const t=r;let e=$(this)[t(499)]().parent()[t(499)]()[t(499)](),n=e[t(553)](t(472))[t(540)](t(543));e[t(548)](t(511)).wait(800)[t(471)]((function(){const r=t;e[r(537)](),i[r(537)](r(488),parseInt(n))[r(506)]((function(t){console[r(495)](t)}))}))})),$(r(465)).delegate(".task-name, .task-desp","change",(function(){const t=r;let e=$(this)[t(499)]().parent(),n=parseInt(e[t(553)](t(472))[t(540)](t(543))),o=this,s=$(this)[t(517)]();i[t(550)]("tasks",n).always((function(e){const n=t;null!=e&&($(o)[n(479)](n(533))?e[n(494)]=s:e[n(532)]=s,i[n(482)]({name:n(488),keyPath:"task_id"},e)[n(506)]((function(t){console.log(t)})))}))})),$(r(465))[r(492)](r(476),r(523),(function(){const t=r;let n=$(this)[t(553)](t(464))[t(517)](),i=this;$(".task-card").each((function(){const e=t;this==i?$(this).find(e(472))[e(508)](e(512),e(521)):$(this)[e(553)](e(472))[e(508)](e(512),e(525))})),$(t(522)).text(n),e.set("cst",$(this).find(t(472))[t(540)](t(543)),{sameSite:t(530)})})),$(".stop-clock")[r(523)]((function(){const t=r;let n=parseInt(e[t(550)](t(480)));if(null!=n){let r=$(t(507))[t(469)]();if(0!=$(".task-id-"+n).length){let o=$(".task-id-"+n)[t(553)](t(514))[t(540)]("current_flow"),s=r,a=t(485);String(e[t(550)](t(510)))!=t(486)&&(a=r,s=t(485)),$(t(535))[t(498)](t(523));let u=i[t(482)](t(518),{logtime:Date[t(478)](),task_id:n,flowtime:s,breaktime:a,flow:o});String(e[t(550)](t(510)))==t(486)&&(u.done((function(r){const s=t;let a=$(s(526)+n)[s(553)](s(514));a[s(540)](s(463),parseInt(o)+1),a[s(469)](o),$.when(i[s(550)](s(488),n)[s(468)]((function(t){const e=s;null!=t&&(t.flow=o,i.put({name:e(488),keyPath:e(543)},t)[e(506)]((function(t){console.log(t)})))})))[s(468)]((function(){const t=s;e.set(t(513),200),e[t(474)](t(510),400),$(t(496))[t(503)]("checked",!1),$(document).trigger(t(541))}))})),u[t(506)]((function(e){console[t(495)](e)})))}}}))}),"text")}))})()})();